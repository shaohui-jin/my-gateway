(self["webpackChunkmy_gateway"]=self["webpackChunkmy_gateway"]||[]).push([[443],{758:function(e,t,i){"use strict";var n;i.d(t,{BV:function(){return d},C6:function(){return n},HM:function(){return l},IK:function(){return a},KH:function(){return o},U_:function(){return s},b:function(){return r},sX:function(){return u},tF:function(){return h}}),function(e){e["PRIMARY"]="primary",e["WARNING"]="warning",e["DANGER"]="danger",e["SUCCESS"]="success",e["INFO"]="info",e["GREENSEA"]="greensea",e["NEPHRITE"]="nephrite",e["BELIZEHOLE"]="belizehole",e["WISTERIA"]="wisteria",e["ASPHALT"]="asphalt",e["ORANGE"]="orange",e["PUMPKIN"]="pumpkin",e["POMEGRANATE"]="pomegranate",e["CLOUDS"]="clouds",e["ASBESTOS"]="asbestos"}(n||(n={}));const o=[{label:"PRIMARY",value:n.PRIMARY},{label:"WARNING",value:n.WARNING},{label:"DANGER",value:n.DANGER},{label:"SUCCESS",value:n.SUCCESS},{label:"INFO",value:n.INFO},{label:"GREENSEA",value:n.GREENSEA},{label:"NEPHRITE",value:n.NEPHRITE},{label:"BELIZEHOLE",value:n.BELIZEHOLE},{label:"WISTERIA",value:n.WISTERIA},{label:"ASPHALT",value:n.ASPHALT},{label:"ORANGE",value:n.ORANGE},{label:"PUMPKIN",value:n.PUMPKIN},{label:"POMEGRANATE",value:n.POMEGRANATE},{label:"CLOUDS",value:n.CLOUDS},{label:"ASBESTOS",value:n.ASBESTOS}];var a,s;(function(e){e["FULL"]="full",e["SIDE"]="side"})(a||(a={})),function(e){e["DEBUG"]="debug",e["INFO"]="info",e["WARN"]="warn",e["ERROR"]="error",e["DISABLE"]="disable"}(s||(s={}));const r=[{label:"DEBUG",value:s.DEBUG},{label:"INFO",value:s.INFO},{label:"WARN",value:s.WARN},{label:"ERROR",value:s.ERROR},{label:"DISABLE",value:s.DISABLE}];var d;(function(e){e["CANVAS"]="canvas",e["SVG"]="svg"})(d||(d={}));const l=[{label:"CANVAS",value:d.CANVAS},{label:"SVG",value:d.SVG}];var h;(function(e){e["HIDDEN"]="hidden",e["WRAP"]="wrap"})(h||(h={}));const u=[{label:"HIDDEN",value:h.HIDDEN},{label:"WRAP",value:h.WRAP}]},5766:function(e,t,i){"use strict";i.d(t,{F1:function(){return w},Bm:function(){return p},df:function(){return c},k6:function(){return _},E:function(){return z},Th:function(){return T},I:function(){return g},EG:function(){return m},S1:function(){return x},$y:function(){return h},G_:function(){return y},YM:function(){return f},Yi:function(){return b},JC:function(){return N},cP:function(){return C},ty:function(){return S}});var n=i(4870),o=i(7178),a=i(758),s=i(1945),r=i.n(s),d=i(6711),l=i.n(d);Object.defineProperty(window,"jsMind",{value:l(),configurable:!1,writable:!1});i(2321),i(1497);const h=(0,n.qj)({name:"jsMind-demo",author:"demo@163.com",version:"0.0.1"}),u=(0,n.iH)("node_tree"),c=(0,n.qj)({id:"root",topic:"jsMind",children:[{id:"easy",topic:"Easy",direction:"left",children:[{id:"easy1",topic:"Easy to show"},{id:"easy2",topic:"Easy to edit"},{id:"easy3",topic:"Easy to store"},{id:"easy4",topic:"Easy to embed"}]},{id:"open",topic:"Open Source",direction:"right",children:[{id:"open1",topic:"on GitHub","background-color":"#eee","foreground-color":"blue","leading-line-color":"#3333ff"},{id:"open2",topic:"BSD License","leading-line-color":"#ff33ff"}]},{id:"powerful",topic:"Powerful",direction:"right",children:[{id:"powerful1",topic:"Base on Javascript"},{id:"powerful2",topic:"Base on HTML5"},{id:"powerful3",topic:"Depends on you"}]},{id:"other",topic:"test node",direction:"left",children:[{id:"other1",topic:"I'm from local variable"},{id:"other2",topic:"I can do everything"}]}]}),_=(0,n.qj)({id:"root",topic:"jsMind"}),f=(0,n.qj)({container:"container",editable:!0,theme:a.C6.BELIZEHOLE,mode:a.IK.FULL,support_html:!0,log_level:a.U_.INFO,view:{engine:a.BV.SVG,hmargin:100,vmargin:50,line_width:2,line_color:"#555",draggable:!0,hide_scrollbars_when_draggable:!0,node_overflow:a.tF.HIDDEN},layout:{hspace:30,vspace:20,pspace:13},shortcut:{enable:!0,handles:{},mapping:{addchild:[45,4109],addbrother:13,editnode:113,delnode:46,toggle:32,left:37,up:38,right:39,down:40}}});let v=null;const p=(0,n.iH)("empty"),g=(0,n.iH)(!1),m=(0,n.iH)(!0),w=()=>{const e={meta:h,data:"empty"===p.value?_:c,format:u.value};r()(JSON.stringify(e)),o.z8.success("复制成功")},y=(e="empty")=>{p.value=e,m.value=!1},b=()=>{m.value=!0,x(!0),j()},x=e=>e?E():k(),E=()=>{const e=document.getElementById("app")||new HTMLElement,t=document.createElement("div");t.id=`${f.container}`,t.className="container",t.style.width="100vw",t.style.height="100vh",t.style.backgroundColor="var(--bg-color)",e.appendChild(t),g.value=!0},k=()=>{const e=document.getElementById("app")||new HTMLElement;e.removeChild(document.getElementsByClassName("container")[0]),g.value=!1},j=()=>{const e={meta:h,data:"empty"===p.value?_:c,format:u.value};v=new window.jsMind(f),v.show(e)},S=e=>v.set_theme(e),z=e=>{e?(v.enable_edit(),o.z8.success("当前思维导图状态：可操作")):(v.disable_edit(),o.z8.warning("当前思维导图状态：不可操作"))},T=e=>{e?o.z8.success("当前思维导图状态：支持节点里的HTML元素"):o.z8.warning("当前思维导图状态：不支持节点里的HTML元素")},C=e=>{o.z8.success(`当前思维导图日志级别：${e}`)},N=()=>{v.screenshot.shootDownload()}},1945:function(e,t,i){"use strict";var n=i(3545),o={"text/plain":"Text","text/html":"Url",default:"Text"},a="Copy to clipboard: #{key}, Enter";function s(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}function r(e,t){var i,r,d,l,h,u,c=!1;t||(t={}),i=t.debug||!1;try{d=n(),l=document.createRange(),h=document.getSelection(),u=document.createElement("span"),u.textContent=e,u.ariaHidden="true",u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),"undefined"===typeof n.clipboardData){i&&console.warn("unable to use e.clipboardData"),i&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var a=o[t.format]||o["default"];window.clipboardData.setData(a,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(u),l.selectNodeContents(u),h.addRange(l);var _=document.execCommand("copy");if(!_)throw new Error("copy command was unsuccessful");c=!0}catch(f){i&&console.error("unable to copy using execCommand: ",f),i&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),c=!0}catch(f){i&&console.error("unable to copy using clipboardData: ",f),i&&console.error("falling back to prompt"),r=s("message"in t?t.message:a),window.prompt(r,e)}}finally{h&&("function"==typeof h.removeRange?h.removeRange(l):h.removeAllRanges()),u&&document.body.removeChild(u),d()}return c}e.exports=r},2321:function(){
/**
 * @license BSD
 * @copyright 2014-2023 hizzgdev@163.com
 * 
 * Project Home:
 *   https://github.com/hizzgdev/jsmind/
 */
(function(e){"use strict";var t=e.document,i="jsMind",n=e[i];if(n&&"undefined"==typeof n.draggable){var o=n.util.dom,a="getSelection"in e?function(){e.getSelection().removeAllRanges()}:function(){t.selection.empty()},s={line_width:5,lookup_delay:500,lookup_interval:80};n.draggable=function(e){this.jm=e,this.e_canvas=null,this.canvas_ctx=null,this.shadow=null,this.shadow_w=0,this.shadow_h=0,this.active_node=null,this.target_node=null,this.target_direct=null,this.client_w=0,this.client_h=0,this.offset_x=0,this.offset_y=0,this.hlookup_delay=0,this.hlookup_timer=0,this.capture=!1,this.moved=!1},n.draggable.prototype={init:function(){this._create_canvas(),this._create_shadow(),this._event_bind()},resize:function(){this.jm.view.e_nodes.appendChild(this.shadow),this.e_canvas.width=this.jm.view.size.w,this.e_canvas.height=this.jm.view.size.h},_create_canvas:function(){var e=t.createElement("canvas");this.jm.view.e_panel.appendChild(e);var i=e.getContext("2d");this.e_canvas=e,this.canvas_ctx=i},_create_shadow:function(){var e=t.createElement("jmnode");e.style.visibility="hidden",e.style.zIndex="3",e.style.cursor="move",e.style.opacity="0.7",this.shadow=e},reset_shadow:function(e){var t=this.shadow.style;this.shadow.innerHTML=e.innerHTML,t.left=e.style.left,t.top=e.style.top,t.width=e.style.width,t.height=e.style.height,t.backgroundImage=e.style.backgroundImage,t.backgroundSize=e.style.backgroundSize,t.transform=e.style.transform,this.shadow_w=this.shadow.clientWidth,this.shadow_h=this.shadow.clientHeight},show_shadow:function(){this.moved||(this.shadow.style.visibility="visible")},hide_shadow:function(){this.shadow.style.visibility="hidden"},_magnet_shadow:function(e){e&&(this.canvas_ctx.lineWidth=s.line_width,this.canvas_ctx.strokeStyle="rgba(0,0,0,0.3)",this.canvas_ctx.lineCap="round",this._clear_lines(),this._canvas_lineto(e.sp.x,e.sp.y,e.np.x,e.np.y))},_clear_lines:function(){this.canvas_ctx.clearRect(0,0,this.jm.view.size.w,this.jm.view.size.h)},_canvas_lineto:function(e,t,i,n){this.canvas_ctx.beginPath(),this.canvas_ctx.moveTo(e,t),this.canvas_ctx.lineTo(i,n),this.canvas_ctx.stroke()},_lookup_close_node:function(){var e,t,i=this.jm.get_root(),o=i.get_location(),a=i.get_size(),r=o.x+a.w/2,d=this.shadow_w,l=this.shadow_h,h=this.shadow.offsetLeft,u=this.shadow.offsetTop,c=h+d/2>=r?n.direction.right:n.direction.left,_=this.jm.mind.nodes,f=null,v=this.jm.layout,p=Number.MAX_VALUE,g=0,m=null,w=null,y=null;for(var b in _){var x,E;if(f=_[b],f.isroot||f.direction==c){if(f.id==this.active_node.id)continue;if(!v.is_visible(f))continue;if(e=f.get_size(),t=f.get_location(),c==n.direction.right){if(h-t.x-e.w<=0)continue;g=Math.abs(h-t.x-e.w)+Math.abs(u+l/2-t.y-e.h/2),x={x:t.x+e.w-s.line_width,y:t.y+e.h/2},E={x:h+s.line_width,y:u+l/2}}else{if(t.x-h-d<=0)continue;g=Math.abs(h+d-t.x)+Math.abs(u+l/2-t.y-e.h/2),x={x:t.x+s.line_width,y:t.y+e.h/2},E={x:h+d-s.line_width,y:u+l/2}}g<p&&(m=f,w=x,y=E,p=g)}}var k=null;return m&&(k={node:m,direction:c,sp:y,np:w}),k},lookup_close_node:function(){var e=this._lookup_close_node();e&&(this._magnet_shadow(e),this.target_node=e.node,this.target_direct=e.direction)},_event_bind:function(){var e=this,t=this.jm.view.container;o.add_event(t,"mousedown",(function(t){var i=t||event;e.dragstart.call(e,i)})),o.add_event(t,"mousemove",(function(t){var i=t||event;e.drag.call(e,i)})),o.add_event(t,"mouseup",(function(t){var i=t||event;e.dragend.call(e,i)})),o.add_event(t,"touchstart",(function(t){var i=t||event;e.dragstart.call(e,i)})),o.add_event(t,"touchmove",(function(t){var i=t||event;e.drag.call(e,i)})),o.add_event(t,"touchend",(function(t){var i=t||event;e.dragend.call(e,i)}))},dragstart:function(t){if(this.jm.get_editable()&&!this.capture){this.active_node=null;var i=this.jm.view,n=t.target||event.srcElement;if("jmnode"==n.tagName.toLowerCase()){i.get_draggable_canvas()&&i.disable_draggable_canvas();var o=i.get_binded_nodeid(n);if(o){var a=this.jm.get_node(o);if(!a.isroot){this.reset_shadow(n),this.active_node=a,this.offset_x=(t.clientX||t.touches[0].clientX)/i.actualZoom-n.offsetLeft,this.offset_y=(t.clientY||t.touches[0].clientY)/i.actualZoom-n.offsetTop,this.client_hw=Math.floor(n.clientWidth/2),this.client_hh=Math.floor(n.clientHeight/2),0!=this.hlookup_delay&&e.clearTimeout(this.hlookup_delay),0!=this.hlookup_timer&&e.clearInterval(this.hlookup_timer);var r=this;this.hlookup_delay=e.setTimeout((function(){r.hlookup_delay=0,r.hlookup_timer=e.setInterval((function(){r.lookup_close_node.call(r)}),s.lookup_interval)}),s.lookup_delay),this.capture=!0}}}}},drag:function(e){if(this.jm.get_editable()&&this.capture){e.preventDefault(),this.show_shadow(),this.moved=!0,a();var t=this.jm.view,i=(e.clientX||e.touches[0].clientX)/t.actualZoom-this.offset_x,n=(e.clientY||e.touches[0].clientY)/t.actualZoom-this.offset_y;this.shadow.style.left=i+"px",this.shadow.style.top=n+"px",a()}},dragend:function(t){if(this.jm.get_editable()){if(this.jm.view.get_draggable_canvas()&&this.jm.view.enable_draggable_canvas(),this.capture){if(0!=this.hlookup_delay&&(e.clearTimeout(this.hlookup_delay),this.hlookup_delay=0,this._clear_lines()),0!=this.hlookup_timer&&(e.clearInterval(this.hlookup_timer),this.hlookup_timer=0,this._clear_lines()),this.moved){var i=this.active_node,n=this.target_node,o=this.target_direct;this.move_node(i,n,o)}this.hide_shadow()}this.moved=!1,this.capture=!1}},move_node:function(e,t,i){var o=this.shadow.offsetTop;if(t&&e&&!n.node.inherited(e,t)){var a=t.children,s=a.length,r=null,d=Number.MAX_VALUE,l=null,h="_last_";while(s--)if(r=a[s],r.direction==i&&r.id!=e.id){var u=r.get_location().y-o;u>0&&u<d&&(d=u,l=r,h="_first_")}l&&(h=l.id),this.jm.move_node(e.id,h,t.id,i)}this.active_node=null,this.target_node=null,this.target_direct=null},jm_event_handle:function(e,t){e===n.event_type.resize&&this.resize()}};var r=new n.plugin("draggable",(function(e){var t=new n.draggable(e);t.init(),e.add_event_listener((function(e,i){t.jm_event_handle.call(t,e,i)}))}));n.register_plugin(r)}})(window)},6711:function(e,t,i){i(7658),i(541),i(2801),function(t){"use strict";var i="jsMind",n="0.5.2",o="hizzgdev@163.com",a=function(){},s="undefined"===typeof console?{log:a,debug:a,error:a,warn:a,info:a}:console;if(e.exports||"undefined"==typeof t[i]){var r=t.document,d=function(e){return r.getElementById(e)},l=function(e){return r.createElement(e)},h=function(e,t){e.hasChildNodes()?e.firstChild.nodeValue=t:e.appendChild(r.createTextNode(t))},u=function(e,t){t instanceof HTMLElement?(e.innerHTML="",e.appendChild(t)):e.innerHTML=t},c=function(e){return!!e&&"object"===typeof e&&1===e.nodeType&&"object"===typeof e.style&&"object"===typeof e.ownerDocument};"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e});var _={container:"",editable:!1,theme:null,mode:"full",support_html:!0,view:{engine:"canvas",hmargin:100,vmargin:50,line_width:2,line_color:"#555",draggable:!1,hide_scrollbars_when_draggable:!1,node_overflow:"hidden"},layout:{hspace:30,vspace:20,pspace:13},default_event_handle:{enable_mousedown_handle:!0,enable_click_handle:!0,enable_dblclick_handle:!0,enable_mousewheel_handle:!0},shortcut:{enable:!0,handles:{},mapping:{addchild:[45,4109],addbrother:13,editnode:113,delnode:46,toggle:32,left:37,up:38,right:39,down:40}}},f=function(e){f.current=this,this.version=n;var t={};f.util.json.merge(t,_),f.util.json.merge(t,e),t.container?(this.options=t,this.initialized=!1,this.mind=null,this.event_handles=[],this.init()):s.error("the options.container should not be null or empty.")};f.direction={left:-1,center:0,right:1,of:function(e){return e&&-1!==e&&0!==e&&1!==e?"-1"===e||"0"===e||"1"===e?parseInt(e):"left"===e.toLowerCase()?this.left:"right"===e.toLowerCase()?this.right:"center"===e.toLowerCase()?this.center:void 0:e}},f.event_type={show:1,resize:2,edit:3,select:4},f.key={meta:8192,ctrl:4096,alt:2048,shift:1024},f.node=function(e,t,i,n,o,a,r,d){e?"number"==typeof t?("undefined"===typeof d&&(d=!0),this.id=e,this.index=t,this.topic=i,this.data=n||{},this.isroot=o,this.parent=a,this.direction=r,this.expanded=!!d,this.children=[],this._data={}):s.error("invalid node index"):s.error("invalid node id")},f.node.compare=function(e,t){var i=0,n=e.index,o=t.index;return i=n>=0&&o>=0?n-o:-1==n&&-1==o?0:-1==n?1:-1==o?-1:0,i},f.node.inherited=function(e,t){if(e&&t){if(e.id===t.id)return!0;if(e.isroot)return!0;var i=e.id,n=t;while(!n.isroot)if(n=n.parent,n.id===i)return!0}return!1},f.node.is_node=function(e){return!!e&&e instanceof f.node},f.node.prototype={get_location:function(){var e=this._data.view;return{x:e.abs_x,y:e.abs_y}},get_size:function(){var e=this._data.view;return{w:e.width,h:e.height}}},f.mind=function(){this.name=null,this.author=null,this.version=null,this.root=null,this.selected=null,this.nodes={}},f.mind.prototype={get_node:function(e){return e in this.nodes?this.nodes[e]:(s.warn("the node[id="+e+"] can not be found"),null)},set_root:function(e,t,i){return null==this.root?(this.root=new f.node(e,0,t,i,!0),this._put_node(this.root),this.root):(s.error("root node is already exist"),null)},add_node:function(e,t,i,n,o,a,r){if(!f.util.is_node(e))return s.error("the parent_node "+e+" is not a node."),null;var d=r||-1,l=new f.node(t,d,i,n,!1,e,e.direction,a);return e.isroot&&(l.direction=o||f.direction.right),this._put_node(l)?(e.children.push(l),this._reindex(e)):(s.error("fail, the nodeid '"+l.id+"' has been already exist."),l=null),l},insert_node_before:function(e,t,i,n,o){if(!f.util.is_node(e))return s.error("the node_before "+e+" is not a node."),null;var a=e.index-.5;return this.add_node(e.parent,t,i,n,o,!0,a)},get_node_before:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.get_node_before(t):(s.error("the node[id="+e+"] can not be found."),null)}if(e.isroot)return null;var i=e.index-2;return i>=0?e.parent.children[i]:null},insert_node_after:function(e,t,i,n,o){if(!f.util.is_node(e))return s.error("the node_after "+e+" is not a node."),null;var a=e.index+.5;return this.add_node(e.parent,t,i,n,o,!0,a)},get_node_after:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.get_node_after(t):(s.error("the node[id="+e+"] can not be found."),null)}if(e.isroot)return null;var i=e.index,n=e.parent.children;return n.length>i?e.parent.children[i]:null},move_node:function(e,t,i,n){return f.util.is_node(e)?(i||(i=e.parent.id),this._move_node(e,t,i,n)):(s.error("the parameter node "+e+" is not a node."),null)},_flow_node_direction:function(e,t){"undefined"===typeof t?t=e.direction:e.direction=t;var i=e.children.length;while(i--)this._flow_node_direction(e.children[i],t)},_move_node_internal:function(e,t){if(e&&t)if("_last_"==t)e.index=-1,this._reindex(e.parent);else if("_first_"==t)e.index=0,this._reindex(e.parent);else{var i=t?this.get_node(t):null;null!=i&&null!=i.parent&&i.parent.id==e.parent.id&&(e.index=i.index-.5,this._reindex(e.parent))}return e},_move_node:function(e,t,i,n){if(e&&i){var o=this.get_node(i);if(f.node.inherited(e,o))return s.error("can not move a node to its children"),null;if(e.parent.id!=i){var a=e.parent.children,r=a.length;while(r--)if(a[r].id==e.id){a.splice(r,1);break}e.parent=o,o.children.push(e)}e.parent.isroot?n==f.direction.left?e.direction=n:e.direction=f.direction.right:e.direction=e.parent.direction,this._move_node_internal(e,t),this._flow_node_direction(e)}return e},remove_node:function(e){if(!f.util.is_node(e))return s.error("the parameter node "+e+" is not a node."),!1;if(e.isroot)return s.error("fail, can not remove root node"),!1;null!=this.selected&&this.selected.id==e.id&&(this.selected=null);var t=e.children,i=t.length;while(i--)this.remove_node(t[i]);t.length=0;var n=e.parent.children,o=n.length;while(o--)if(n[o].id==e.id){n.splice(o,1);break}for(var a in delete this.nodes[e.id],e)delete e[a];return e=null,!0},_put_node:function(e){return e.id in this.nodes?(s.warn("the nodeid '"+e.id+"' has been already exist."),!1):(this.nodes[e.id]=e,!0)},_reindex:function(e){if(e instanceof f.node){e.children.sort(f.node.compare);for(var t=0;t<e.children.length;t++)e.children[t].index=t+1}}},f.format={node_tree:{example:{meta:{name:i,author:o,version:n},format:"node_tree",data:{id:"root",topic:"jsMind Example"}},get_mind:function(e){var t=f.format.node_tree,i=new f.mind;return i.name=e.meta.name,i.author=e.meta.author,i.version=e.meta.version,t._parse(i,e.data),i},get_data:function(e){var t=f.format.node_tree,i={};return i.meta={name:e.name,author:e.author,version:e.version},i.format="node_tree",i.data=t._buildnode(e.root),i},_parse:function(e,t){var i=f.format.node_tree,n=i._extract_data(t);if(e.set_root(t.id,t.topic,n),"children"in t)for(var o=t.children,a=0;a<o.length;a++)i._extract_subnode(e,e.root,o[a])},_extract_data:function(e){var t={};for(var i in e)"id"!=i&&"topic"!=i&&"children"!=i&&"direction"!=i&&"expanded"!=i&&(t[i]=e[i]);return t},_extract_subnode:function(e,t,i){var n=f.format.node_tree,o=n._extract_data(i),a=null;t.isroot&&(a="left"==i.direction?f.direction.left:f.direction.right);var s=e.add_node(t,i.id,i.topic,o,a,i.expanded);if(i["children"])for(var r=i.children,d=0;d<r.length;d++)n._extract_subnode(e,s,r[d])},_buildnode:function(e){var t=f.format.node_tree;if(e instanceof f.node){var i={id:e.id,topic:e.topic,expanded:e.expanded};if(e.parent&&e.parent.isroot&&(i.direction=e.direction==f.direction.left?"left":"right"),null!=e.data){var n=e.data;for(var o in n)i[o]=n[o]}var a=e.children;if(a.length>0){i.children=[];for(var s=0;s<a.length;s++)i.children.push(t._buildnode(a[s]))}return i}}},node_array:{example:{meta:{name:i,author:o,version:n},format:"node_array",data:[{id:"root",topic:"jsMind Example",isroot:!0}]},get_mind:function(e){var t=f.format.node_array,i=new f.mind;return i.name=e.meta.name,i.author=e.meta.author,i.version=e.meta.version,t._parse(i,e.data),i},get_data:function(e){var t=f.format.node_array,i={};return i.meta={name:e.name,author:e.author,version:e.version},i.format="node_array",i.data=[],t._array(e,i.data),i},_parse:function(e,t){var i=f.format.node_array,n=t.slice(0);n.reverse();var o=i._extract_root(e,n);o?i._extract_subnode(e,o,n):s.error("root node can not be found")},_extract_root:function(e,t){var i=f.format.node_array,n=t.length;while(n--)if("isroot"in t[n]&&t[n].isroot){var o=t[n],a=i._extract_data(o),s=e.set_root(o.id,o.topic,a);return t.splice(n,1),s}return null},_extract_subnode:function(e,t,i){var n=f.format.node_array,o=i.length,a=null,s=null,r=0;while(o--)if(a=i[o],a.parentid==t.id){s=n._extract_data(a);var d=null,l=a.direction;l&&(d="left"==l?f.direction.left:f.direction.right);var h=e.add_node(t,a.id,a.topic,s,d,a.expanded);i.splice(o,1),r++;var u=n._extract_subnode(e,h,i);u>0&&(o=i.length,r+=u)}return r},_extract_data:function(e){var t={};for(var i in e)"id"!=i&&"topic"!=i&&"parentid"!=i&&"isroot"!=i&&"direction"!=i&&"expanded"!=i&&(t[i]=e[i]);return t},_array:function(e,t){var i=f.format.node_array;i._array_node(e.root,t)},_array_node:function(e,t){var i=f.format.node_array;if(e instanceof f.node){var n={id:e.id,topic:e.topic,expanded:e.expanded};if(e.parent&&(n.parentid=e.parent.id),e.isroot&&(n.isroot=!0),e.parent&&e.parent.isroot&&(n.direction=e.direction==f.direction.left?"left":"right"),null!=e.data){var o=e.data;for(var a in o)n[a]=o[a]}t.push(n);for(var s=e.children.length,r=0;r<s;r++)i._array_node(e.children[r],t)}}},freemind:{example:{meta:{name:i,author:o,version:n},format:"freemind",data:'<map version="1.0.1"><node ID="root" TEXT="freemind Example"/></map>'},get_mind:function(e){var t=f.format.freemind,i=new f.mind;i.name=e.meta.name,i.author=e.meta.author,i.version=e.meta.version;var n=e.data,o=t._parse_xml(n),a=t._find_root(o);return t._load_node(i,null,a),i},get_data:function(e){var t=f.format.freemind,i={};i.meta={name:e.name,author:e.author,version:e.version},i.format="freemind";var n=[];return n.push('<map version="1.0.1">'),t._buildmap(e.root,n),n.push("</map>"),i.data=n.join(" "),i},_parse_xml:function(e){var t=null;if(window.DOMParser){var i=new DOMParser;t=i.parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e);return t},_find_root:function(e){for(var t=e.childNodes,i=null,n=null,o=0;o<t.length;o++)if(n=t[o],1==n.nodeType&&"map"==n.tagName){i=n;break}if(i){var a=i.childNodes;i=null;for(o=0;o<a.length;o++)if(n=a[o],1==n.nodeType&&"node"==n.tagName){i=n;break}}return i},_load_node:function(e,t,i){var n=f.format.freemind,o=i.getAttribute("ID"),a=i.getAttribute("TEXT");if(null==a)for(var s=i.childNodes,r=null,d=0;d<s.length;d++)if(r=s[d],1==r.nodeType&&"richcontent"===r.tagName){a=r.textContent;break}var l=n._load_attributes(i),h=!("expanded"in l)||"true"==l.expanded;delete l.expanded;var u=i.getAttribute("POSITION"),c=null;u&&(c="left"==u?f.direction.left:f.direction.right);var _=null;_=t?e.add_node(t,o,a,l,c,h):e.set_root(o,a,l);var v=i.childNodes,p=null;for(d=0;d<v.length;d++)p=v[d],1==p.nodeType&&"node"==p.tagName&&n._load_node(e,_,p)},_load_attributes:function(e){for(var t=e.childNodes,i=null,n={},o=0;o<t.length;o++)i=t[o],1==i.nodeType&&"attribute"===i.tagName&&(n[i.getAttribute("NAME")]=i.getAttribute("VALUE"));return n},_buildmap:function(e,t){var i=f.format.freemind,n=null;e.parent&&e.parent.isroot&&(n=e.direction===f.direction.left?"left":"right"),t.push("<node"),t.push('ID="'+e.id+'"'),n&&t.push('POSITION="'+n+'"'),t.push('TEXT="'+e.topic+'">'),t.push('<attribute NAME="expanded" VALUE="'+e.expanded+'"/>');var o=e.data;if(null!=o)for(var a in o)t.push('<attribute NAME="'+a+'" VALUE="'+o[a]+'"/>');for(var s=e.children,r=0;r<s.length;r++)i._buildmap(s[r],t);t.push("</node>")}}},f.util={is_node:function(e){return!!e&&e instanceof f.node},ajax:{request:function(e,t,i,n,o){f.util.ajax;var a=null,r=[];for(var d in t)r.push(encodeURIComponent(d)+"="+encodeURIComponent(t[d]));r.length>0&&(a=r.join("&"));var l=new XMLHttpRequest;l&&(l.onreadystatechange=function(){if(4==l.readyState)if(200==l.status||0==l.status){if("function"===typeof n){var e=f.util.json.string2json(l.responseText);n(null!=e?e:l.responseText)}}else"function"===typeof o?o(l):s.error("xhr request failed.",l)},i=i||"GET",l.open(i,e,!0),l.setRequestHeader("If-Modified-Since","0"),"POST"==i?(l.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),l.send(a)):l.send())},get:function(e,t){return f.util.ajax.request(e,{},"GET",t)},post:function(e,t,i){return f.util.ajax.request(e,t,"POST",i)}},dom:{add_event:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)}},file:{read:function(e,t){var i=new FileReader;i.onload=function(){"function"===typeof t&&t(this.result,e.name)},i.readAsText(e)},save:function(e,i,n){var o;if("function"===typeof t.Blob)o=new Blob([e],{type:i});else{var a=t.BlobBuilder||t.MozBlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder,s=new a;s.append(e),o=s.getBlob(i)}if(navigator.msSaveBlob)navigator.msSaveBlob(o,n);else{var d=t.URL||t.webkitURL,h=d.createObjectURL(o),u=l("a");if("download"in u){u.style.visibility="hidden",u.href=h,u.download=n,r.body.appendChild(u);var c=r.createEvent("MouseEvents");c.initEvent("click",!0,!0),u.dispatchEvent(c),r.body.removeChild(u)}else location.href=h}}},json:{json2string:function(e){return JSON.stringify(e)},string2json:function(e){return JSON.parse(e)},merge:function(e,t){for(var i in t)i in e?"object"!==typeof e[i]||"[object object]"!=Object.prototype.toString.call(e[i]).toLowerCase()||e[i].length?e[i]=t[i]:f.util.json.merge(e[i],t[i]):e[i]=t[i];return e}},uuid:{newid:function(){return((new Date).getTime().toString(16)+Math.random().toString(16).substring(2)).substring(2,18)}},text:{is_empty:function(e){return!e||0==e.replace(/\s*/,"").length}}},f.prototype={init:function(){if(!this.initialized){this.initialized=!0;var e=this.options,t={mode:e.mode,hspace:e.layout.hspace,vspace:e.layout.vspace,pspace:e.layout.pspace},i={container:e.container,support_html:e.support_html,engine:e.view.engine,hmargin:e.view.hmargin,vmargin:e.view.vmargin,line_width:e.view.line_width,line_color:e.view.line_color,draggable:e.view.draggable,hide_scrollbars_when_draggable:e.view.hide_scrollbars_when_draggable,node_overflow:e.view.node_overflow};this.data=new f.data_provider(this),this.layout=new f.layout_provider(this,t),this.view=new f.view_provider(this,i),this.shortcut=new f.shortcut_provider(this,e.shortcut),this.data.init(),this.layout.init(),this.view.init(),this.shortcut.init(),this._event_bind(),f.init_plugins(this)}},enable_edit:function(){this.options.editable=!0},disable_edit:function(){this.options.editable=!1},enable_event_handle:function(e){this.options.default_event_handle["enable_"+e+"_handle"]=!0},disable_event_handle:function(e){this.options.default_event_handle["enable_"+e+"_handle"]=!1},get_editable:function(){return this.options.editable},set_theme:function(e){var t=this.options.theme;this.options.theme=e||null,t!=this.options.theme&&(this.view.reset_theme(),this.view.reset_custom_style())},_event_bind:function(){this.view.add_event(this,"mousedown",this.mousedown_handle),this.view.add_event(this,"click",this.click_handle),this.view.add_event(this,"dblclick",this.dblclick_handle),this.view.add_event(this,"mousewheel",this.mousewheel_handle)},mousedown_handle:function(e){if(this.options.default_event_handle["enable_mousedown_handle"]){var t=e.target||event.srcElement,i=this.view.get_binded_nodeid(t);i?"jmnode"==t.tagName.toLowerCase()&&this.select_node(i):this.select_clear()}},click_handle:function(e){if(this.options.default_event_handle["enable_click_handle"]){var t=e.target||event.srcElement,i=this.view.is_expander(t);if(i){var n=this.view.get_binded_nodeid(t);n&&this.toggle_node(n)}}},dblclick_handle:function(e){if(this.options.default_event_handle["enable_dblclick_handle"]&&this.get_editable()){var t=e.target||event.srcElement,i=this.view.get_binded_nodeid(t);i&&this.begin_edit(i)}},mousewheel_handle:function(e){this.options.default_event_handle["enable_mousewheel_handle"]&&window.event.ctrlKey&&(e.preventDefault(),e.deltaY<0?this.view.zoomIn():this.view.zoomOut())},begin_edit:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.begin_edit(t):(s.error("the node[id="+e+"] can not be found."),!1)}this.get_editable()?this.view.edit_node_begin(e):s.error("fail, this mind map is not editable.")},end_edit:function(){this.view.edit_node_end()},toggle_node:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.toggle_node(t):void s.error("the node[id="+e+"] can not be found.")}e.isroot||(this.view.save_location(e),this.layout.toggle_node(e),this.view.relayout(),this.view.restore_location(e))},expand_node:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.expand_node(t):void s.error("the node[id="+e+"] can not be found.")}e.isroot||(this.view.save_location(e),this.layout.expand_node(e),this.view.relayout(),this.view.restore_location(e))},collapse_node:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.collapse_node(t):void s.error("the node[id="+e+"] can not be found.")}e.isroot||(this.view.save_location(e),this.layout.collapse_node(e),this.view.relayout(),this.view.restore_location(e))},expand_all:function(){this.layout.expand_all(),this.view.relayout()},collapse_all:function(){this.layout.collapse_all(),this.view.relayout()},expand_to_depth:function(e){this.layout.expand_to_depth(e),this.view.relayout()},_reset:function(){this.view.reset(),this.layout.reset(),this.data.reset()},_show:function(e){var t=e||f.format.node_array.example;this.mind=this.data.load(t),this.mind?(s.debug("data.load ok"),this.view.load(),s.debug("view.load ok"),this.layout.layout(),s.debug("layout.layout ok"),this.view.show(!0),s.debug("view.show ok"),this.invoke_event_handle(f.event_type.show,{data:[e]})):s.error("data.load error")},show:function(e){this._reset(),this._show(e)},get_meta:function(){return{name:this.mind.name,author:this.mind.author,version:this.mind.version}},get_data:function(e){var t=e||"node_tree";return this.data.get_data(t)},get_root:function(){return this.mind.root},get_node:function(e){return f.util.is_node(e)?e:this.mind.get_node(e)},add_node:function(e,t,i,n,o){if(this.get_editable()){var a=this.get_node(e),r=f.direction.of(o);void 0===r&&(r=this.layout.calculate_next_child_direction(a));var d=this.mind.add_node(a,t,i,n,r);return d&&(this.view.add_node(d),this.layout.layout(),this.view.show(!1),this.view.reset_node_custom_style(d),this.expand_node(a),this.invoke_event_handle(f.event_type.edit,{evt:"add_node",data:[a.id,t,i,n,r],node:t})),d}return s.error("fail, this mind map is not editable"),null},insert_node_before:function(e,t,i,n,o){if(this.get_editable()){var a=this.get_node(e),r=f.direction.of(o);void 0===r&&(r=this.layout.calculate_next_child_direction(a.parent));var d=this.mind.insert_node_before(a,t,i,n,r);return d&&(this.view.add_node(d),this.layout.layout(),this.view.show(!1),this.invoke_event_handle(f.event_type.edit,{evt:"insert_node_before",data:[a.id,t,i,n,r],node:t})),d}return s.error("fail, this mind map is not editable"),null},insert_node_after:function(e,t,i,n,o){if(this.get_editable()){var a=this.get_node(e),r=f.direction.of(o);void 0===r&&(r=this.layout.calculate_next_child_direction(a.parent));var d=this.mind.insert_node_after(a,t,i,n,r);return d&&(this.view.add_node(d),this.layout.layout(),this.view.show(!1),this.invoke_event_handle(f.event_type.edit,{evt:"insert_node_after",data:[a.id,t,i,n,r],node:t})),d}return s.error("fail, this mind map is not editable"),null},remove_node:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.remove_node(t):(s.error("the node[id="+e+"] can not be found."),!1)}if(this.get_editable()){if(e.isroot)return s.error("fail, can not remove root node"),!1;var i=e.id,n=e.parent.id,o=this.get_node(n);return this.view.save_location(o),this.view.remove_node(e),this.mind.remove_node(e),this.layout.layout(),this.view.show(!1),this.view.restore_location(o),this.invoke_event_handle(f.event_type.edit,{evt:"remove_node",data:[i],node:n}),!0}return s.error("fail, this mind map is not editable"),!1},update_node:function(e,t){if(this.get_editable())if(f.util.text.is_empty(t))s.warn("fail, topic can not be empty");else{var i=this.get_node(e);if(i){if(i.topic===t)return s.info("nothing changed"),void this.view.update_node(i);i.topic=t,this.view.update_node(i),this.layout.layout(),this.view.show(!1),this.invoke_event_handle(f.event_type.edit,{evt:"update_node",data:[e,t],node:e})}}else s.error("fail, this mind map is not editable")},move_node:function(e,t,i,n){if(this.get_editable()){var o=this.get_node(e),a=this.mind.move_node(o,t,i,n);a&&(this.view.update_node(a),this.layout.layout(),this.view.show(!1),this.invoke_event_handle(f.event_type.edit,{evt:"move_node",data:[e,t,i,n],node:e}))}else s.error("fail, this mind map is not editable")},select_node:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.select_node(t):void s.error("the node[id="+e+"] can not be found.")}this.layout.is_visible(e)&&(this.mind.selected=e,this.view.select_node(e),this.invoke_event_handle(f.event_type.select,{evt:"select_node",data:[],node:e.id}))},get_selected_node:function(){return this.mind?this.mind.selected:null},select_clear:function(){this.mind&&(this.mind.selected=null,this.view.select_clear())},is_node_visible:function(e){return this.layout.is_visible(e)},find_node_before:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.find_node_before(t):void s.error("the node[id="+e+"] can not be found.")}if(e.isroot)return null;var i=null;if(e.parent.isroot)for(var n=e.parent.children,o=null,a=null,r=0;r<n.length;r++)a=n[r],e.direction===a.direction&&(e.id===a.id&&(i=o),o=a);else i=this.mind.get_node_before(e);return i},find_node_after:function(e){if(!f.util.is_node(e)){var t=this.get_node(e);return t?this.find_node_after(t):void s.error("the node[id="+e+"] can not be found.")}if(e.isroot)return null;var i=null;if(e.parent.isroot){for(var n=e.parent.children,o=!1,a=null,r=0;r<n.length;r++)if(a=n[r],e.direction===a.direction){if(o){i=a;break}e.id===a.id&&(o=!0)}}else i=this.mind.get_node_after(e);return i},set_node_color:function(e,t,i){if(!this.get_editable())return s.error("fail, this mind map is not editable"),null;var n=this.mind.get_node(e);n&&(t&&(n.data["background-color"]=t),i&&(n.data["foreground-color"]=i),this.view.reset_node_custom_style(n))},set_node_font_style:function(e,t,i,n){if(!this.get_editable())return s.error("fail, this mind map is not editable"),null;var o=this.mind.get_node(e);o&&(t&&(o.data["font-size"]=t),i&&(o.data["font-weight"]=i),n&&(o.data["font-style"]=n),this.view.reset_node_custom_style(o),this.view.update_node(o),this.layout.layout(),this.view.show(!1))},set_node_background_image:function(e,t,i,n,o){if(!this.get_editable())return s.error("fail, this mind map is not editable"),null;var a=this.mind.get_node(e);a&&(t&&(a.data["background-image"]=t),i&&(a.data["width"]=i),n&&(a.data["height"]=n),o&&(a.data["background-rotation"]=o),this.view.reset_node_custom_style(a),this.view.update_node(a),this.layout.layout(),this.view.show(!1))},set_node_background_rotation:function(e,t){if(!this.get_editable())return s.error("fail, this mind map is not editable"),null;var i=this.mind.get_node(e);if(i){if(!i.data["background-image"])return s.error("fail, only can change rotation angle of node with background image"),null;i.data["background-rotation"]=t,this.view.reset_node_custom_style(i),this.view.update_node(i),this.layout.layout(),this.view.show(!1)}},resize:function(){this.view.resize()},add_event_listener:function(e){"function"===typeof e&&this.event_handles.push(e)},clear_event_listener:function(){this.event_handles=[]},invoke_event_handle:function(e,i){var n=this;t.setTimeout((function(){n._invoke_event_handle(e,i)}),0)},_invoke_event_handle:function(e,t){for(var i=this.event_handles.length,n=0;n<i;n++)this.event_handles[n](e,t)}},f.data_provider=function(e){this.jm=e},f.data_provider.prototype={init:function(){s.debug("data.init")},reset:function(){s.debug("data.reset")},load:function(e){var t=null,i=null;return t="object"===typeof e?e.format?e.format:"node_tree":"freemind","node_array"==t?i=f.format.node_array.get_mind(e):"node_tree"==t?i=f.format.node_tree.get_mind(e):"freemind"==t?i=f.format.freemind.get_mind(e):s.warn("unsupported format"),i},get_data:function(e){var t=null;return"node_array"==e?t=f.format.node_array.get_data(this.jm.mind):"node_tree"==e?t=f.format.node_tree.get_data(this.jm.mind):"freemind"==e?t=f.format.freemind.get_data(this.jm.mind):s.error("unsupported "+e+" format"),t}},f.layout_provider=function(e,t){this.opts=t,this.jm=e,this.isside="side"==this.opts.mode,this.bounds=null,this.cache_valid=!1},f.layout_provider.prototype={init:function(){s.debug("layout.init")},reset:function(){s.debug("layout.reset"),this.bounds={n:0,s:0,w:0,e:0}},calculate_next_child_direction:function(e){if(this.isside)return f.direction.right;for(var t=e.children||[],i=t.length,n=0,o=0;o<i;o++)t[o].direction===f.direction.left?n--:n++;return i>1&&n>0?f.direction.left:f.direction.right},layout:function(){s.debug("layout.layout"),this.layout_direction(),this.layout_offset()},layout_direction:function(){this._layout_direction_root()},_layout_direction_root:function(){var e=this.jm.mind.root,t=null;"layout"in e._data?t=e._data.layout:(t={},e._data.layout=t);var i=e.children,n=i.length;if(t.direction=f.direction.center,t.side_index=0,this.isside){var o=n;while(o--)this._layout_direction_side(i[o],f.direction.right,o)}else{o=n;var a=null;while(o--)a=i[o],a.direction==f.direction.left?this._layout_direction_side(a,f.direction.left,o):this._layout_direction_side(a,f.direction.right,o)}},_layout_direction_side:function(e,t,i){var n=null;"layout"in e._data?n=e._data.layout:(n={},e._data.layout=n);var o=e.children,a=o.length;n.direction=t,n.side_index=i;var s=a;while(s--)this._layout_direction_side(o[s],t,s)},layout_offset:function(){var e=this.jm.mind.root,t=e._data.layout;t.offset_x=0,t.offset_y=0,t.outer_height=0;var i=e.children,n=i.length,o=[],a=[],s=null;while(n--)s=i[n],s._data.layout.direction==f.direction.right?a.unshift(s):o.unshift(s);t.left_nodes=o,t.right_nodes=a,t.outer_height_left=this._layout_offset_subnodes(o),t.outer_height_right=this._layout_offset_subnodes(a),this.bounds.e=e._data.view.width/2,this.bounds.w=0-this.bounds.e,this.bounds.n=0,this.bounds.s=Math.max(t.outer_height_left,t.outer_height_right)},_layout_offset_subnodes:function(e){var t=0,i=e.length,n=i,o=null,a=0,s=null,r=0,d=null;while(n--)o=e[n],s=o._data.layout,null==d&&(d=o.parent._data),a=this._layout_offset_subnodes(o.children),o.expanded||(a=0,this.set_visible(o.children,!1)),a=Math.max(o._data.view.height,a),s.outer_height=a,s.offset_y=r-a/2,s.offset_x=this.opts.hspace*s.direction+d.view.width*(d.layout.direction+s.direction)/2,o.parent.isroot||(s.offset_x+=this.opts.pspace*s.direction),r=r-a-this.opts.vspace,t+=a;i>1&&(t+=this.opts.vspace*(i-1)),n=i;var l=t/2;while(n--)o=e[n],o._data.layout.offset_y+=l;return t},_layout_offset_subnodes_height:function(e){var t=0,i=e.length,n=i,o=null,a=0,s=null,r=0,d=null;while(n--)o=e[n],s=o._data.layout,null==d&&(d=o.parent._data),a=this._layout_offset_subnodes_height(o.children),o.expanded||(a=0),a=Math.max(o._data.view.height,a),s.outer_height=a,s.offset_y=r-a/2,r=r-a-this.opts.vspace,t+=a;i>1&&(t+=this.opts.vspace*(i-1)),n=i;var l=t/2;while(n--)o=e[n],o._data.layout.offset_y+=l;return t},get_node_offset:function(e){var t=e._data.layout,i=null;if("_offset_"in t&&this.cache_valid?i=t._offset_:(i={x:-1,y:-1},t._offset_=i),-1==i.x||-1==i.y){var n=t.offset_x,o=t.offset_y;if(!e.isroot){var a=this.get_node_offset(e.parent);n+=a.x,o+=a.y}i.x=n,i.y=o}return i},get_node_point:function(e){var t=e._data.view,i=this.get_node_offset(e),n={};return n.x=i.x+t.width*(e._data.layout.direction-1)/2,n.y=i.y-t.height/2,n},get_node_point_in:function(e){var t=this.get_node_offset(e);return t},get_node_point_out:function(e){var t=e._data.layout,i=null;if("_pout_"in t&&this.cache_valid?i=t._pout_:(i={x:-1,y:-1},t._pout_=i),-1==i.x||-1==i.y)if(e.isroot)i.x=0,i.y=0;else{var n=e._data.view,o=this.get_node_offset(e);i.x=o.x+(n.width+this.opts.pspace)*e._data.layout.direction,i.y=o.y}return i},get_expander_point:function(e){var t=this.get_node_point_out(e),i={};return e._data.layout.direction==f.direction.right?i.x=t.x-this.opts.pspace:i.x=t.x,i.y=t.y-Math.ceil(this.opts.pspace/2),i},get_min_size:function(){var e=this.jm.mind.nodes,t=null,i=null;for(var n in e)t=e[n],i=this.get_node_point_out(t),i.x>this.bounds.e&&(this.bounds.e=i.x),i.x<this.bounds.w&&(this.bounds.w=i.x);return{w:this.bounds.e-this.bounds.w,h:this.bounds.s-this.bounds.n}},toggle_node:function(e){e.isroot||(e.expanded?this.collapse_node(e):this.expand_node(e))},expand_node:function(e){e.expanded=!0,this.part_layout(e),this.set_visible(e.children,!0),this.jm.invoke_event_handle(f.event_type.show,{evt:"expand_node",data:[],node:e.id})},collapse_node:function(e){e.expanded=!1,this.part_layout(e),this.set_visible(e.children,!1),this.jm.invoke_event_handle(f.event_type.show,{evt:"collapse_node",data:[],node:e.id})},expand_all:function(){var e,t=this.jm.mind.nodes,i=0;for(var n in t)e=t[n],e.expanded||(e.expanded=!0,i++);if(i>0){var o=this.jm.mind.root;this.part_layout(o),this.set_visible(o.children,!0)}},collapse_all:function(){var e,t=this.jm.mind.nodes,i=0;for(var n in t)e=t[n],e.expanded&&!e.isroot&&(e.expanded=!1,i++);if(i>0){var o=this.jm.mind.root;this.part_layout(o),this.set_visible(o.children,!0)}},expand_to_depth:function(e,t,i){if(!(e<1)){var n=t||this.jm.mind.root.children,o=i||1,a=n.length,s=null;while(a--)s=n[a],o<e&&(s.expanded||this.expand_node(s),this.expand_to_depth(e,s.children,o+1)),o==e&&s.expanded&&this.collapse_node(s)}},part_layout:function(e){var t=this.jm.mind.root;if(t){var i=t._data.layout;e.isroot?(i.outer_height_right=this._layout_offset_subnodes_height(i.right_nodes),i.outer_height_left=this._layout_offset_subnodes_height(i.left_nodes)):e._data.layout.direction==f.direction.right?i.outer_height_right=this._layout_offset_subnodes_height(i.right_nodes):i.outer_height_left=this._layout_offset_subnodes_height(i.left_nodes),this.bounds.s=Math.max(i.outer_height_left,i.outer_height_right),this.cache_valid=!1}else s.warn("can not found root node")},set_visible:function(e,t){var i=e.length,n=null;while(i--)n=e[i],n._data.layout,n.expanded?this.set_visible(n.children,t):this.set_visible(n.children,!1),n.isroot||(n._data.layout.visible=t)},is_expand:function(e){return e.expanded},is_visible:function(e){var t=e._data.layout;return!("visible"in t&&!t.visible)}},f.graph_canvas=function(e){this.opts=e.opts,this.e_canvas=l("canvas"),this.e_canvas.className="jsmind",this.canvas_ctx=this.e_canvas.getContext("2d"),this.size={w:0,h:0}},f.graph_canvas.prototype={element:function(){return this.e_canvas},set_size:function(e,t){this.size.w=e,this.size.h=t,this.e_canvas.width=e,this.e_canvas.height=t},clear:function(){this.canvas_ctx.clearRect(0,0,this.size.w,this.size.h)},draw_line:function(e,t,i){var n=this.canvas_ctx;n.strokeStyle=this.opts.line_color,n.lineWidth=this.opts.line_width,n.lineCap="round",this._bezier_to(n,t.x+i.x,t.y+i.y,e.x+i.x,e.y+i.y)},copy_to:function(e,t){e.drawImage(this.e_canvas,0,0),t&&t()},_bezier_to:function(e,t,i,n,o){e.beginPath(),e.moveTo(t,i),e.bezierCurveTo(t+2*(n-t)/3,i,t,o,n,o),e.stroke()},_line_to:function(e,t,i,n,o){e.beginPath(),e.moveTo(t,i),e.lineTo(n,o),e.stroke()}},f.graph_svg=function(e){this.view=e,this.opts=e.opts,this.e_svg=f.graph_svg.c("svg"),this.e_svg.setAttribute("class","jsmind"),this.size={w:0,h:0},this.lines=[]},f.graph_svg.c=function(e){return r.createElementNS("http://www.w3.org/2000/svg",e)},f.graph_svg.prototype={element:function(){return this.e_svg},set_size:function(e,t){this.size.w=e,this.size.h=t,this.e_svg.setAttribute("width",e),this.e_svg.setAttribute("height",t)},clear:function(){var e=this.lines.length;while(e--)this.e_svg.removeChild(this.lines[e]);this.lines.length=0},draw_line:function(e,t,i){var n=f.graph_svg.c("path");n.setAttribute("stroke",this.opts.line_color),n.setAttribute("stroke-width",this.opts.line_width),n.setAttribute("fill","transparent"),this.lines.push(n),this.e_svg.appendChild(n),this._bezier_to(n,t.x+i.x,t.y+i.y,e.x+i.x,e.y+i.y)},copy_to:function(e,t){var i=new Image;i.onload=function(){e.drawImage(i,0,0),t&&t()},i.src="data:image/svg+xml;base64,"+btoa((new XMLSerializer).serializeToString(this.e_svg))},_bezier_to:function(e,t,i,n,o){e.setAttribute("d","M"+t+" "+i+" C "+(t+2*(n-t)/3)+" "+i+", "+t+" "+o+", "+n+" "+o)},_line_to:function(e,t,i,n,o){e.setAttribute("d","M "+t+" "+i+" L "+n+" "+o)}},f.view_provider=function(e,t){this.opts=t,this.jm=e,this.layout=e.layout,this.container=null,this.e_panel=null,this.e_nodes=null,this.size={w:0,h:0},this.selected_node=null,this.editing_node=null,this.graph=null},f.view_provider.prototype={init:function(){if(s.debug("view.init"),this.container=c(this.opts.container)?this.opts.container:d(this.opts.container),this.container){this.e_panel=l("div"),this.e_nodes=l("jmnodes"),this.e_editor=l("input"),this.graph="svg"===this.opts.engine.toLowerCase()?new f.graph_svg(this):new f.graph_canvas(this),this.e_panel.className="jsmind-inner jmnode-overflow-"+this.opts.node_overflow,this.e_panel.tabIndex=1,this.e_panel.appendChild(this.graph.element()),this.e_panel.appendChild(this.e_nodes),this.e_editor.className="jsmind-editor",this.e_editor.type="text",this.actualZoom=1,this.zoomStep=.1,this.minZoom=.5,this.maxZoom=2;var e=this;f.util.dom.add_event(this.e_editor,"keydown",(function(t){var i=t||event;13==i.keyCode&&(e.edit_node_end(),i.stopPropagation())})),f.util.dom.add_event(this.e_editor,"blur",(function(t){e.edit_node_end()})),this.container.appendChild(this.e_panel),this.dragging_enabled=!0,this.draggable_canvas()}else s.error("the options.view.container was not be found in dom")},add_event:function(e,t,i){f.util.dom.add_event(this.e_nodes,t,(function(t){var n=t||event;i.call(e,n)}))},get_binded_nodeid:function(e){if(null==e)return null;var t=e.tagName.toLowerCase();return"jmnodes"==t||"body"==t||"html"==t?null:"jmnode"==t||"jmexpander"==t?e.getAttribute("nodeid"):this.get_binded_nodeid(e.parentElement)},is_expander:function(e){return"jmexpander"==e.tagName.toLowerCase()},reset:function(){s.debug("view.reset"),this.selected_node=null,this.clear_lines(),this.clear_nodes(),this.reset_theme()},reset_theme:function(){var e=this.jm.options.theme;this.e_nodes.className=e?"theme-"+e:""},reset_custom_style:function(){var e=this.jm.mind.nodes;for(var t in e)this.reset_node_custom_style(e[t])},load:function(){s.debug("view.load"),this.init_nodes()},expand_size:function(){var e=this.layout.get_min_size(),t=e.w+2*this.opts.hmargin,i=e.h+2*this.opts.vmargin,n=this.e_panel.clientWidth,o=this.e_panel.clientHeight;n<t&&(n=t),o<i&&(o=i),this.size.w=n,this.size.h=o},init_nodes_size:function(e){var t=e._data.view;t.width=t.element.clientWidth,t.height=t.element.clientHeight},init_nodes:function(){var e=this.jm.mind.nodes,t=r.createDocumentFragment();for(var i in e)this.create_node_element(e[i],t);for(var i in this.e_nodes.appendChild(t),e)this.init_nodes_size(e[i])},add_node:function(e){this.create_node_element(e,this.e_nodes),this.init_nodes_size(e)},create_node_element:function(e,t){var i=null;"view"in e._data?i=e._data.view:(i={},e._data.view=i);var n=l("jmnode");if(e.isroot)n.className="root";else{var o=l("jmexpander");h(o,"-"),o.setAttribute("nodeid",e.id),o.style.visibility="hidden",t.appendChild(o),i.expander=o}e.topic&&(this.opts.support_html?u(n,e.topic):h(n,e.topic)),n.setAttribute("nodeid",e.id),n.style.visibility="hidden",this._reset_node_custom_style(n,e.data),t.appendChild(n),i.element=n},remove_node:function(e){null!=this.selected_node&&this.selected_node.id==e.id&&(this.selected_node=null),null!=this.editing_node&&this.editing_node.id==e.id&&(e._data.view.element.removeChild(this.e_editor),this.editing_node=null);var t=e.children,i=t.length;while(i--)this.remove_node(t[i]);if(e._data.view){var n=e._data.view.element,o=e._data.view.expander;this.e_nodes.removeChild(n),this.e_nodes.removeChild(o),e._data.view.element=null,e._data.view.expander=null}},update_node:function(e){var t=e._data.view,i=t.element;if(e.topic&&(this.opts.support_html?u(i,e.topic):h(i,e.topic)),this.layout.is_visible(e))t.width=i.clientWidth,t.height=i.clientHeight;else{let e=i.getAttribute("style");i.style="visibility: visible; left:0; top:0;",t.width=i.clientWidth,t.height=i.clientHeight,i.style=e}},select_node:function(e){this.selected_node&&(this.selected_node._data.view.element.className=this.selected_node._data.view.element.className.replace(/\s*selected\b/i,""),this.reset_node_custom_style(this.selected_node)),e&&(this.selected_node=e,e._data.view.element.className+=" selected",this.clear_node_custom_style(e))},select_clear:function(){this.select_node(null)},get_editing_node:function(){return this.editing_node},is_editing:function(){return!!this.editing_node},edit_node_begin:function(e){if(e.topic){null!=this.editing_node&&this.edit_node_end(),this.editing_node=e;var t=e._data.view,i=t.element,n=e.topic,o=getComputedStyle(i);this.e_editor.value=n,this.e_editor.style.width=i.clientWidth-parseInt(o.getPropertyValue("padding-left"))-parseInt(o.getPropertyValue("padding-right"))+"px",i.innerHTML="",i.appendChild(this.e_editor),i.style.zIndex=5,this.e_editor.focus(),this.e_editor.select()}else s.warn("don't edit image nodes")},edit_node_end:function(){if(null!=this.editing_node){var e=this.editing_node;this.editing_node=null;var t=e._data.view,i=t.element,n=this.e_editor.value;i.style.zIndex="auto",i.removeChild(this.e_editor),f.util.text.is_empty(n)||e.topic===n?this.opts.support_html?u(i,e.topic):h(i,e.topic):this.jm.update_node(e.id,n)}this.e_panel.focus()},get_view_offset:function(){var e=this.layout.bounds,t=(this.size.w-e.e-e.w)/2,i=this.size.h/2;return{x:t,y:i}},resize:function(){this.graph.set_size(1,1),this.e_nodes.style.width="1px",this.e_nodes.style.height="1px",this.expand_size(),this._show()},_show:function(){this.graph.set_size(this.size.w,this.size.h),this.e_nodes.style.width=this.size.w+"px",this.e_nodes.style.height=this.size.h+"px",this.show_nodes(),this.show_lines(),this.jm.invoke_event_handle(f.event_type.resize,{data:[]})},zoomIn:function(){return this.setZoom(this.actualZoom+this.zoomStep)},zoomOut:function(){return this.setZoom(this.actualZoom-this.zoomStep)},setZoom:function(e){if(e<this.minZoom||e>this.maxZoom)return!1;this.actualZoom=e;for(var t=0;t<this.e_panel.children.length;t++)this.e_panel.children[t].style.zoom=e;return this.show(!0),!0},_center_root:function(){var e=this.e_panel.clientWidth,t=this.e_panel.clientHeight;if(this.size.w>e){var i=this.get_view_offset();this.e_panel.scrollLeft=i.x*this.actualZoom-e/2}this.size.h>t&&(this.e_panel.scrollTop=(this.size.h*this.actualZoom-t)/2)},show:function(e){s.debug("view.show"),this.expand_size(),this._show(),e&&this._center_root()},relayout:function(){this.expand_size(),this._show()},save_location:function(e){var t=e._data.view;t._saved_location={x:parseInt(t.element.style.left)-this.e_panel.scrollLeft,y:parseInt(t.element.style.top)-this.e_panel.scrollTop}},restore_location:function(e){var t=e._data.view;this.e_panel.scrollLeft=parseInt(t.element.style.left)-t._saved_location.x,this.e_panel.scrollTop=parseInt(t.element.style.top)-t._saved_location.y},clear_nodes:function(){var e=this.jm.mind;if(null!=e){var t=e.nodes,i=null;for(var n in t)i=t[n],i._data.view.element=null,i._data.view.expander=null;this.e_nodes.innerHTML=""}},show_nodes:function(){var e=this.jm.mind.nodes,t=null,i=null,n=null,o=null,a=null,s="-",r=null,d=this.get_view_offset();for(var l in e)t=e[l],r=t._data.view,i=r.element,n=r.expander,this.layout.is_visible(t)?(this.reset_node_custom_style(t),o=this.layout.get_node_point(t),r.abs_x=d.x+o.x,r.abs_y=d.y+o.y,i.style.left=d.x+o.x+"px",i.style.top=d.y+o.y+"px",i.style.display="",i.style.visibility="visible",!t.isroot&&t.children.length>0&&(s=t.expanded?"-":"+",a=this.layout.get_expander_point(t),n.style.left=d.x+a.x+"px",n.style.top=d.y+a.y+"px",n.style.display="",n.style.visibility="visible",h(n,s)),t.isroot||0!=t.children.length||(n.style.display="none",n.style.visibility="hidden")):(i.style.display="none",n.style.display="none")},reset_node_custom_style:function(e){this._reset_node_custom_style(e._data.view.element,e.data)},_reset_node_custom_style:function(e,t){if("background-color"in t&&(e.style.backgroundColor=t["background-color"]),"foreground-color"in t&&(e.style.color=t["foreground-color"]),"width"in t&&(e.style.width=t["width"]+"px"),"height"in t&&(e.style.height=t["height"]+"px"),"font-size"in t&&(e.style.fontSize=t["font-size"]+"px"),"font-weight"in t&&(e.style.fontWeight=t["font-weight"]),"font-style"in t&&(e.style.fontStyle=t["font-style"]),"background-image"in t){var i=t["background-image"];if(i.startsWith("data")&&t["width"]&&t["height"]){var n=new Image;n.onload=function(){var t=l("canvas");t.width=e.clientWidth,t.height=e.clientHeight;var i=this;if(t.getContext){var n=t.getContext("2d");n.drawImage(i,2,2,e.clientWidth,e.clientHeight);var o=t.toDataURL();e.style.backgroundImage="url("+o+")"}},n.src=i}else e.style.backgroundImage="url("+i+")";e.style.backgroundSize="99%","background-rotation"in t&&(e.style.transform="rotate("+t["background-rotation"]+"deg)")}},clear_node_custom_style:function(e){var t=e._data.view.element;t.style.backgroundColor="",t.style.color=""},clear_lines:function(){this.graph.clear()},show_lines:function(){this.clear_lines();var e=this.jm.mind.nodes,t=null,i=null,n=null,o=this.get_view_offset();for(var a in e)t=e[a],t.isroot||"visible"in t._data.layout&&!t._data.layout.visible||(i=this.layout.get_node_point_in(t),n=this.layout.get_node_point_out(t.parent),this.graph.draw_line(n,i,o))},draggable_canvas:function(){if(this.opts.draggable){let e,t,i=!1;this.opts.hide_scrollbars_when_draggable&&(this.e_panel.style="overflow: hidden"),f.util.dom.add_event(this.container,"mousedown",(n=>{i=!0,e=n.clientX,t=n.clientY})),f.util.dom.add_event(this.container,"mouseup",(()=>{i=!1})),f.util.dom.add_event(this.container,"mousemove",(n=>{this.dragging_enabled&&i&&(this.e_panel.scrollBy(e-n.clientX,t-n.clientY),e=n.clientX,t=n.clientY)}))}},get_draggable_canvas:function(){return this.opts.draggable},enable_draggable_canvas:function(){this.dragging_enabled=!0},disable_draggable_canvas:function(){this.dragging_enabled=!1}},f.shortcut_provider=function(e,t){this.jm=e,this.opts=t,this.mapping=t.mapping,this.handles=t.handles,this._newid=null,this._mapping={}},f.shortcut_provider.prototype={init:function(){for(var e in f.util.dom.add_event(this.jm.view.e_panel,"keydown",this.handler.bind(this)),this.handles["addchild"]=this.handle_addchild,this.handles["addbrother"]=this.handle_addbrother,this.handles["editnode"]=this.handle_editnode,this.handles["delnode"]=this.handle_delnode,this.handles["toggle"]=this.handle_toggle,this.handles["up"]=this.handle_up,this.handles["down"]=this.handle_down,this.handles["left"]=this.handle_left,this.handles["right"]=this.handle_right,this.mapping)if(this.mapping[e]&&e in this.handles){var t=this.mapping[e];Array.isArray(t)||(t=[t]);for(let i of t)this._mapping[i]=this.handles[e]}"function"===typeof this.opts.id_generator?this._newid=this.opts.id_generator:this._newid=f.util.uuid.newid},enable_shortcut:function(){this.opts.enable=!0},disable_shortcut:function(){this.opts.enable=!1},handler:function(e){if(9==e.which&&e.preventDefault(),!this.jm.view.is_editing()){var t=e||event;if(!this.opts.enable)return!0;var i=t.keyCode+(t.metaKey<<13)+(t.ctrlKey<<12)+(t.altKey<<11)+(t.shiftKey<<10);i in this._mapping&&this._mapping[i].call(this,this.jm,e)}},handle_addchild:function(e,t){var i=e.get_selected_node();if(i){var n=this._newid(),o=e.add_node(i,n,"New Node");o&&(e.select_node(n),e.begin_edit(n))}},handle_addbrother:function(e,t){var i=e.get_selected_node();if(i&&!i.isroot){var n=this._newid(),o=e.insert_node_after(i,n,"New Node");o&&(e.select_node(n),e.begin_edit(n))}},handle_editnode:function(e,t){var i=e.get_selected_node();i&&e.begin_edit(i)},handle_delnode:function(e,t){var i=e.get_selected_node();i&&!i.isroot&&(e.select_node(i.parent),e.remove_node(i))},handle_toggle:function(e,t){var i=t||event,n=e.get_selected_node();n&&(e.toggle_node(n.id),i.stopPropagation(),i.preventDefault())},handle_up:function(e,t){var i=t||event,n=e.get_selected_node();if(n){var o=e.find_node_before(n);if(!o){var a=e.find_node_before(n.parent);a&&a.children.length>0&&(o=a.children[a.children.length-1])}o&&e.select_node(o),i.stopPropagation(),i.preventDefault()}},handle_down:function(e,t){var i=t||event,n=e.get_selected_node();if(n){var o=e.find_node_after(n);if(!o){var a=e.find_node_after(n.parent);a&&a.children.length>0&&(o=a.children[0])}o&&e.select_node(o),i.stopPropagation(),i.preventDefault()}},handle_left:function(e,t){this._handle_direction(e,t,f.direction.left)},handle_right:function(e,t){this._handle_direction(e,t,f.direction.right)},_handle_direction:function(e,t,i){var n=t||event,o=e.get_selected_node(),a=null;if(o){if(o.isroot){for(var s=o.children,r=[],d=0;d<s.length;d++)s[d].direction===i&&r.push(d);a=s[r[Math.floor((r.length-1)/2)]]}else if(o.direction===i){r=o.children;var l=r.length;l>0&&(a=r[Math.floor((l-1)/2)])}else a=o.parent;a&&e.select_node(a),n.stopPropagation(),n.preventDefault()}}},f.plugin=function(e,t){this.name=e,this.init=t},f.plugins=[],f.register_plugin=function(e){e instanceof f.plugin&&f.plugins.push(e)},f.init_plugins=function(e){t.setTimeout((function(){f._init_plugins(e)}),0)},f._init_plugins=function(e){for(var t=f.plugins.length,i=null,n=0;n<t;n++)i=f.plugins[n].init,"function"===typeof i&&i(e)},f.show=function(e,t){var i=new f(e);return i.show(t),i},e.exports=f}else s.log(i+" has been already exist.")}("undefined"!==typeof window?window:i.g)},1497:function(){
/**
 * @license BSD
 * @copyright 2014-2023 hizzgdev@163.com
 * 
 * Project Home:
 *   https://github.com/hizzgdev/jsmind/
 */
(function(e){"use strict";var t="jsMind",i=e[t];if(i&&"undefined"==typeof i.screenshot){var n=e.document,o=function(e){return n.createElement(e)},a=function(e,t){return e.getPropertyValue(t)},s=function(e){var t=a(e,"visibility"),i=a(e,"display");return"hidden"!==t&&"none"!==i},r={rect:function(e,t,i,n,o,a){n<2*a&&(a=n/2),o<2*a&&(a=o/2),e.moveTo(t+a,i),e.arcTo(t+n,i,t+n,i+o,a),e.arcTo(t+n,i+o,t,i+o,a),e.arcTo(t,i+o,t,i,a),e.arcTo(t,i,t+n,i,a)},text_multiline:function(e,t,i,n,o,a,s){var r="",d=t.length,l=t.split(""),h=null;e.textAlign="left",e.textBaseline="top";for(var u=0;u<d;u++)h=r+l[u],e.measureText(h).width>o&&u>0?(e.fillText(r,i,n),r=l[u],n+=s):r=h;e.fillText(r,i,n)},text_ellipsis:function(e,t,i,n,o,a){var s=n+a/2;t=r.fittingString(e,t,o);e.textAlign="left",e.textBaseline="middle",e.fillText(t,i,s,o)},fittingString:function(e,t,i){var n=e.measureText(t).width,o="…",a=e.measureText(o).width;if(n<=i||n<=a)return t;var s=t.length;while(n>=i-a&&s-- >0)t=t.substring(0,s),n=e.measureText(t).width;return t+o},image:function(e,t,i,n,o,a,s,d,l){var h=new Image;h.onload=function(){e.save(),e.translate(i,n),e.save(),e.beginPath(),r.rect(e,0,0,o,a,s),e.closePath(),e.clip(),e.translate(o/2,a/2),e.rotate(d*Math.PI/180),e.drawImage(h,-o/2,-a/2),e.restore(),e.restore(),l&&l()},h.src=t}};i.screenshot=function(e){this.jm=e,this.canvas_elem=null,this.canvas_ctx=null,this._inited=!1},i.screenshot.prototype={init:function(){if(!this._inited){console.log("init");var e=o("canvas"),t=e.getContext("2d");this.canvas_elem=e,this.canvas_ctx=t,this.jm.view.e_panel.appendChild(e),this._inited=!0,this.resize()}},shoot:function(e){this.init(),this._draw(function(){e&&e(),this.clean()}.bind(this)),this._watermark()},shootDownload:function(){this.shoot(function(){this._download()}.bind(this))},shootAsDataURL:function(e){this.shoot(function(){e&&e(this.canvas_elem.toDataURL())}.bind(this))},resize:function(){this._inited&&(this.canvas_elem.width=this.jm.view.size.w,this.canvas_elem.height=this.jm.view.size.h)},clean:function(){var e=this.canvas_elem;this.canvas_ctx.clearRect(0,0,e.width,e.height)},_draw:function(e){var t=this.canvas_ctx;t.textAlign="left",t.textBaseline="top",this._draw_lines(function(){this._draw_nodes(e)}.bind(this))},_watermark:function(){var t=this.canvas_elem,i=this.canvas_ctx;i.textAlign="right",i.textBaseline="bottom",i.fillStyle="#000",i.font="11px Verdana,Arial,Helvetica,sans-serif",i.fillText("github.com/hizzgdev/jsmind",t.width-5.5,t.height-2.5),i.textAlign="left",i.fillText(e.location,5.5,t.height-2.5)},_draw_lines:function(e){this.jm.view.graph.copy_to(this.canvas_ctx,e)},_draw_nodes:function(t){var i,n=this.jm.mind.nodes;for(var o in n)i=n[o],this._draw_node(i);function a(){console.log("check_node_ready"+new Date);var o=!0;for(var s in n)i=n[s],o&=i.ready;o?e.setTimeout(t,200):e.setTimeout(a,200)}a()},_draw_node:function(e){var t=this.canvas_ctx,i=e._data.view,n=i.element,o=getComputedStyle(n);if(s(o)){var d=a(o,"background-color"),l=parseInt(a(o,"border-top-left-radius")),h=a(o,"color"),u=parseInt(a(o,"padding-left")),c=parseInt(a(o,"padding-right")),_=parseInt(a(o,"padding-top")),f=parseInt(a(o,"padding-bottom")),v=a(o,"text-overflow"),p=a(o,"font-style")+" "+a(o,"font-variant")+" "+a(o,"font-weight")+" "+a(o,"font-size")+"/"+a(o,"line-height")+" "+a(o,"font-family"),g={x:i.abs_x,y:i.abs_y,w:i.width+1,h:i.height+1},m={x:g.x+u,y:g.y+_,w:g.w-u-c,h:g.h-_-f};if(t.font=p,t.fillStyle=d,t.beginPath(),r.rect(t,g.x,g.y,g.w,g.h,l),t.closePath(),t.fill(),t.fillStyle=h,"background-image"in e.data){var w=a(o,"background-image").slice(5,-2);e.ready=!1;var y=0;"background-rotation"in e.data&&(y=e.data["background-rotation"]),r.image(t,w,g.x,g.y,g.w,g.h,l,y,(function(){e.ready=!0}))}if(e.topic)if("ellipsis"===v)r.text_ellipsis(t,e.topic,m.x,m.y,m.w,m.h);else{var b=parseInt(a(o,"line-height"));r.text_multiline(t,e.topic,m.x,m.y,m.w,m.h,b)}i.expander&&this._draw_expander(i.expander),"background-image"in e.data||(e.ready=!0)}else e.ready=!0},_draw_expander:function(e){var t=this.canvas_ctx,i=getComputedStyle(e);if(s(i)){var n=a(i,"left"),o=a(i,"top"),r=(a(i,"font"),parseInt(n)),d=parseInt(o),l="+"===e.innerHTML;t.lineWidth=1,t.beginPath(),t.arc(r+7,d+7,5,0,2*Math.PI,!0),t.moveTo(r+10,d+7),t.lineTo(r+4,d+7),l&&(t.moveTo(r+7,d+4),t.lineTo(r+7,d+10)),t.closePath(),t.stroke()}},_download:function(){var e=this.canvas_elem,t=this.jm.mind.name+".png";if(navigator.msSaveBlob&&e.msToBlob){var i=e.msToBlob();navigator.msSaveBlob(i,t)}else{var a=this.canvas_elem.toDataURL(),s=o("a");if("download"in s){s.style.visibility="hidden",s.href=a,s.download=t,n.body.appendChild(s);var r=n.createEvent("MouseEvents");r.initEvent("click",!0,!0),s.dispatchEvent(r),n.body.removeChild(s)}else location.href=a}},jm_event_handle:function(e,t){e===i.event_type.resize&&this.resize()}};var d=new i.plugin("screenshot",(function(e){var t=new i.screenshot(e);e.screenshot=t,e.shoot=function(){t.shoot()},e.add_event_listener((function(e,i){t.jm_event_handle.call(t,e,i)}))}));i.register_plugin(d)}})(window)},3545:function(e,t,i){i(7658),e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,i=[],n=0;n<e.rangeCount;n++)i.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null;break}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||i.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},5973:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return H}});var n=i(3396),o=i(9242),a=i(7139),s=i(4870);const r={2:["#eee4db","#776e66"],4:["#ede0c9","#776e66"],8:["#f2b179","#fff"],16:["#f59563","#fff"],32:["#f67c5f","#fff"],64:["#f65e3b","#fff"],128:["#edcf72","#fff"],256:["#ed4c61","#fff"],512:["#9c0","#fff"],1024:["#33b5e5","#fff"],2048:["#edc22e","#fff"],0:["#cdc0b5","#fff"]};var d;i(7658);let l,h;(function(e){e["LEFT"]="left",e["UP"]="up",e["RIGHT"]="right",e["DOWN"]="down"})(d||(d={}));const u=10,c=(e,t)=>{const{keyCode:i}=e,n=[d.LEFT,d.UP,d.RIGHT,d.DOWN],o=n[i-37];o&&t[o]()},_=e=>{l=e.targetTouches[0].clientX,h=e.targetTouches[0].clientY},f=(e,t)=>{const{clientX:i,clientY:n}=e.changedTouches[0],o=Math.abs(i-l),a=Math.abs(n-h);let s;o>a&&o>u&&(s=i>l?d.RIGHT:d.LEFT),a>o&&a>u&&(s=n>h?d.DOWN:d.UP),s&&t[s]()},v=e=>{"undefined"!==typeof document&&document.addEventListener&&(console.log("RegisterEvent....."),document.addEventListener("keydown",(t=>c(t,e))),document.addEventListener("touchstart",(e=>_(e))),document.addEventListener("touchend",(t=>f(t,e))),document.documentElement.addEventListener("touchmove",(e=>e.preventDefault()),{passive:!1}))},p=e=>{"undefined"!==typeof document&&document.removeEventListener&&(console.log("UnRegisterEvent....."),document.removeEventListener("keydown",(t=>c(t,e))),document.removeEventListener("touchstart",(e=>_(e))),document.removeEventListener("touchend",(t=>f(t,e))),document.documentElement.removeEventListener("touchmove",(e=>e.preventDefault())))};var g=i(7178);const m=e=>{const t=JSON.parse(JSON.stringify(e.data)),i=t.map((t=>{const i=x(t,e);return i.fill(e.size)}));e.data.toString()!==i.toString()?(e.data=i,E(e)):e.watchEffect=!0},w=e=>{const t=JSON.parse(JSON.stringify(e.data)),i=t.map((t=>{const i=x(t.reverse(),e);return i.fill(e.size).reverse()}));e.data.toString()!==i.toString()?(e.data=i,E(e)):e.watchEffect=!0},y=e=>{const t=JSON.parse(JSON.stringify(e.data)),i=t.rowToCol().map((t=>{const i=x(t,e);return i.fill(e.size)}));e.data.toString()!==i.rowToCol().toString()?(e.data=i.rowToCol(),E(e)):e.watchEffect=!0},b=e=>{const t=JSON.parse(JSON.stringify(e.data)),i=t.rowToCol().map((t=>{const i=x(t.reverse(),e);return i.fill(e.size).reverse()}));e.data.toString()!==i.rowToCol().toString()?(e.data=i.rowToCol(),E(e)):e.watchEffect=!0},x=(e,t)=>{const i=e.filter((e=>0!==e));if(0===i.length)return[];{const e=i.groupByAdjoinSameData();let n=!1,o=e.reduce(((e,i)=>{if(2!==i.length)e.push(...i);else{const[o,a]=i;o===a?(n=!0,t.score=t.score+o+a,e.push(o+a)):e.push(...i)}return e}),[]);return n&&(o=x(o,t)),o}},E=e=>{const t=JSON.parse(JSON.stringify(e.data)),i=JSON.parse(JSON.stringify(e.size)),n=t.flat(),o=n.filter((e=>0===e)),a=Math.random()>=.5?2:4,s=Math.floor(Math.random()*o.length),r=n.findIndexOf(0,s+1);t[Math.floor(r/i)][r%i]=a,e.data=t};let k=!1,j=(0,s.qj)({size:4,data:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],watchEffect:!1,score:0});const S=e=>({left:()=>m(e),up:()=>y(e),down:()=>b(e),right:()=>w(e)}),z=e=>{j=e,C(e),k||((0,n.YP)((()=>j.data),(()=>{if(j.watchEffect){const e=JSON.parse(JSON.stringify(j.data)),t=(JSON.parse(JSON.stringify(j.size)),e.flat()),i=t.filter((e=>0===e));0===i.length&&N("lose",j)}})),v(S(e)),k=!0)},T=()=>{const e=[2,0,8,4,0,16,0,2,4,8],t=Math.floor(10*Math.random());return t%5===0?0:e[t]},C=e=>{const{size:t}=e,i=[];for(let n=0;n<t;n++){const e=[];for(let i=0;i<t;i++)e.push(T());i.push(e)}e.data=i},N=(e,t)=>{"lose"===e&&(g.z8.error("游戏结束"),k&&(p(S(t)),k=!1)),"win"===e&&g.z8.error("游戏通关")},I={class:"game-container"},A={class:"game-header"},L={class:"game-body"},M={class:"game-footer"};var D=(0,n.aZ)({__name:"index",setup(e){(0,o.sj)((e=>({"77fe3118":i.size})));const t=(0,s.qj)([4,5,6]),i=(0,s.qj)({size:4,data:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],watchEffect:!1,score:0}),d=()=>{z(i)};(0,n.bv)((()=>{d()}));let l=(0,s.iH)(!1),h=(0,s.iH)(4);const u=()=>l.value=!l.value,c=()=>{h.value=4,u()},_=()=>{i.score=0,i.size=h.value,c(),d()};return(e,d)=>{const f=(0,n.up)("el-col"),v=(0,n.up)("el-option"),p=(0,n.up)("el-select"),g=(0,n.up)("el-row"),m=(0,n.up)("el-button"),w=(0,n.up)("el-dialog");return(0,n.wg)(),(0,n.iD)("div",I,[(0,n._)("div",A,[(0,n._)("span",null,"游戏难度: "+(0,a.zw)(`lavel ${i.size}`),1),(0,n._)("span",null,"总分: "+(0,a.zw)(i.score),1)]),(0,n._)("div",L,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.data,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t,class:"game-body_row"},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t,class:"game-body_col"},[(0,n._)("div",{class:"game-body_item",style:(0,a.j5)({backgroundColor:(0,s.SU)(r)[e][0],color:(0,s.SU)(r)[e][1]})},(0,a.zw)(0===e?"":e),5)])))),128))])))),128))]),(0,n._)("div",M,[(0,n._)("div",{class:"game-button",onClick:d[0]||(d[0]=(0,o.iM)((()=>u()),["stop"]))},"重新开始")]),(0,n.Wm)(w,{title:"提示",modelValue:(0,s.SU)(l),"onUpdate:modelValue":d[2]||(d[2]=e=>(0,s.dq)(l)?l.value=e:l=e),width:"50%"},{footer:(0,n.w5)((()=>[(0,n.Wm)(m,{onClick:c},{default:(0,n.w5)((()=>[(0,n.Uk)(" 取 消 ")])),_:1}),(0,n.Wm)(m,{type:"primary",onClick:_},{default:(0,n.w5)((()=>[(0,n.Uk)("确 定")])),_:1})])),default:(0,n.w5)((()=>[(0,n.Wm)(g,{gutter:8},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{span:8},{default:(0,n.w5)((()=>[(0,n.Uk)("游戏难度：")])),_:1}),(0,n.Wm)(f,{span:16},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{modelValue:(0,s.SU)(h),"onUpdate:modelValue":d[1]||(d[1]=e=>(0,s.dq)(h)?h.value=e:h=e)},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t,(e=>((0,n.wg)(),(0,n.j4)(v,{key:e,label:`lavel ${e}`,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}}}),R=i(89);const O=(0,R.Z)(D,[["__scopeId","data-v-0697481c"]]);var H=O},5500:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return x}});i(7658);var n=i(3396),o=i(7139),a=i.p+"img/logo.a1b13c0c.jpg",s=i(4870);const r=e=>((0,n.dD)("data-v-5a413148"),e=e(),(0,n.Cn)(),e),d={class:"main-body"},l={class:"main-container"},h={class:"main-container_header"},u=r((()=>(0,n._)("div",{class:"icon"},[(0,n._)("img",{src:a,alt:"个人引导页",title:"个人引导页",class:"logo"})],-1))),c=r((()=>(0,n._)("div",{class:"content"},[(0,n._)("div",{class:"inner"},[(0,n._)("h1",null,"个人引导页"),(0,n._)("p",null,"她只是途经我留下了星火 而我却任凭它焚烧了我整个荒原")])],-1))),_=(0,n.uE)('<li data-v-5a413148><a target="_blank" href="https://gitee.com/jin-shaohui" data-v-5a413148>Gitee✨</a></li><li data-v-5a413148><a target="_blank" href="https://github.com/shaohui-jin" data-v-5a413148>Github✨</a></li><li data-v-5a413148><a target="_blank" href="https://shaohui-jin.github.io/my-blog/" data-v-5a413148>博客✨</a></li><li data-v-5a413148><a target="_blank" href="https://shaohui-jin.github.io/my-netease-cloud/" data-v-5a413148>网易云✨</a></li><li data-v-5a413148><a target="_blank" href="https://shaohui-jin.github.io/my-css-library/" data-v-5a413148>CSS库✨</a></li><li data-v-5a413148><a target="_blank" href="https://shaohui-jin.github.io/my-tsx-cli/" data-v-5a413148>Tsx模版✨</a></li>',6),f={class:"main-container_footer"},v={class:"copyright"},p={class:"copyright"},g=r((()=>(0,n._)("p",{class:"copyright"},"All Rights Reserved",-1))),m=r((()=>(0,n._)("p",{class:"copyright"},"繁华中自律，落魄中自愈 谋生的路上不抛弃良知，谋爱的路上不丢失尊严",-1)));var w=(0,n.aZ)({__name:"index",setup(e){const t=(0,s.iH)(document.location.hostname);return(e,i)=>((0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("div",l,[(0,n._)("header",h,[u,c,(0,n._)("nav",null,[(0,n._)("ul",null,[_,(0,n._)("li",null,[(0,n._)("a",{target:"_blank",style:{cursor:"pointer"},onClick:i[0]||(i[0]=t=>e.$router.push({path:"/mind"}))},"思维导图✨")]),(0,n._)("li",null,[(0,n._)("a",{target:"_blank",style:{cursor:"pointer"},onClick:i[1]||(i[1]=t=>e.$router.push({path:"/game"}))},"2048✨")])])])]),(0,n._)("footer",f,[(0,n._)("p",v,"您的IP： "+(0,o.zw)(t.value),1),(0,n._)("p",p,"Copyright © 2021-"+(0,o.zw)((new Date).getFullYear())+" 石怜安_SLA",1),g,m])])]))}}),y=i(89);const b=(0,y.Z)(w,[["__scopeId","data-v-5a413148"]]);var x=b},7887:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var n=i(3396),o=i(4870),a=i(9242),s=i(5766),r=(0,n.aZ)({__name:"Home",setup(e){(0,n.RC)((()=>i.e(170).then(i.bind(i,4170))));const t=(0,n.RC)((()=>i.e(372).then(i.bind(i,4372)))),r=(0,n.RC)((()=>i.e(591).then(i.bind(i,591))));return(e,i)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)((0,o.SU)(r)),(0,n.wy)((0,n.Wm)((0,o.SU)(t),null,null,512),[[a.F8,!(0,o.SU)(s.EG)]])],64))}}),d=i(89);const l=(0,d.Z)(r,[["__scopeId","data-v-40420db8"]]);var h=l}}]);
//# sourceMappingURL=about.f08a6e93.js.map