{"version":3,"file":"js/about.e6e0ecb0.js","mappings":"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","sources":["webpack://sla-mind/./src/interface/Mind/index.ts","webpack://sla-mind/./src/utils/init-Jsmind.ts","webpack://sla-mind/./src/views/Mind/utils/index.ts","webpack://sla-mind/./node_modules/copy-to-clipboard/index.js","webpack://sla-mind/./node_modules/jsmind/js/jsmind.draggable-node.js","webpack://sla-mind/./node_modules/jsmind/js/jsmind.js","webpack://sla-mind/./node_modules/jsmind/js/jsmind.screenshot.js","webpack://sla-mind/./node_modules/toggle-selection/index.js","webpack://sla-mind/./src/views/Mind/Home.vue?da61","webpack://sla-mind/./src/views/Mind/Home.vue"],"sourcesContent":["export * from './common';\n\n/**\n *  THEME \n * @param PRIMARY primary\n * @param WARNING warning\n * @param DANGER danger\n * @param SUCCESS success\n * @param INFO info\n * @param GREENSEA greensea\n * @param NEPHRITE nephrite\n * @param BELIZEHOLE belizehole\n * @param WISTERIA wisteria\n * @param ASPHALT asphalt\n * @param ORANGE orange\n * @param PUMPKIN pumpkin\n * @param POMEGRANATE pomegranate\n * @param CLOUDS clouds\n * @param ASBESTOS asbestos\n */\nexport enum THEME {\n  PRIMARY = 'primary',\n  WARNING = 'warning',\n  DANGER = 'danger',\n  SUCCESS = 'success',\n  INFO = 'info',\n  GREENSEA = 'greensea',\n  NEPHRITE = 'nephrite',\n  BELIZEHOLE = 'belizehole',\n  WISTERIA = 'wisteria',\n  ASPHALT = 'asphalt',\n  ORANGE = 'orange',\n  PUMPKIN = 'pumpkin',\n  POMEGRANATE = 'pomegranate',\n  CLOUDS = 'clouds',\n  ASBESTOS = 'asbestos',\n}\n\nexport const ThemeOption = [\n  { label: 'PRIMARY', value: THEME.PRIMARY },\n  { label: 'WARNING', value: THEME.WARNING },\n  { label: 'DANGER', value: THEME.DANGER },\n  { label: 'SUCCESS', value: THEME.SUCCESS },\n  { label: 'INFO', value: THEME.INFO },\n  { label: 'GREENSEA', value: THEME.GREENSEA },\n  { label: 'NEPHRITE', value: THEME.NEPHRITE },\n  { label: 'BELIZEHOLE', value: THEME.BELIZEHOLE },\n  { label: 'WISTERIA', value: THEME.WISTERIA },\n  { label: 'ASPHALT', value: THEME.ASPHALT },\n  { label: 'ORANGE', value: THEME.ORANGE },\n  { label: 'PUMPKIN', value: THEME.PUMPKIN },\n  { label: 'POMEGRANATE', value: THEME.POMEGRANATE },\n  { label: 'CLOUDS', value: THEME.CLOUDS },\n  { label: 'ASBESTOS', value: THEME.ASBESTOS },\n];\n\n/**\n *  MODE \n * @param FULL full  []\n * @param SIDE side \n */\nexport enum MODE {\n  FULL = 'full',\n  SIDE = 'side',\n}\n\n/**\n *  LOGLEVEL \n * @param DEBUG debug\n * @param INFO info\n * @param WARN warn\n * @param ERROR error\n * @param DISABLE disable\n */\nexport enum LOGLEVEL {\n  DEBUG = 'debug',\n  INFO = 'info',\n  WARN = 'warn',\n  ERROR = 'error',\n  DISABLE = 'disable',\n}\n\nexport const LogLevelOption = [\n  { label: 'DEBUG', value: LOGLEVEL.DEBUG },\n  { label: 'INFO', value: LOGLEVEL.INFO },\n  { label: 'WARN', value: LOGLEVEL.WARN },\n  { label: 'ERROR', value: LOGLEVEL.ERROR },\n  { label: 'DISABLE', value: LOGLEVEL.DISABLE },\n];\n/**\n * \n * @param name {string} \n * @param author {string} \n * @param version {string} \n */\nexport interface Meta {\n  name: string;\n  author: string;\n  version: string;\n}\n\n/**\n * @param container {string} ID\n * @param editable {boolean | false} \n * @param theme {@link THEME} \n * @param mode {@link MODE} \n * @param support_html {boolean | true} HTML\n * @param log_level {@link LOGLEVEL} \n */\nexport interface Options {\n  container: string;\n  editable: boolean | false;\n  theme: THEME;\n  mode: MODE;\n  support_html: boolean | true;\n  log_level: LOGLEVEL;\n  view: View;\n  layout: object;\n  shortcut: object;\n}\n\n/**\n *  ENGINE \n * @param CANVAS  canvas\n * @param SVG  svg\n */\nexport enum ENGINE {\n  CANVAS = 'canvas',\n  SVG = 'svg',\n}\n\nexport const EngineOption = [\n  { label: 'CANVAS', value: ENGINE.CANVAS },\n  { label: 'SVG', value: ENGINE.SVG },\n];\n\n/**\n *  NODEOVERFLOW \n * @param HIDDEN  hidden\n * @param WRAP  wrap\n */\nexport enum NODE_OVERFLOW {\n  HIDDEN = 'hidden',\n  WRAP = 'wrap',\n}\n\nexport const NodeOverflowOption = [\n  { label: 'HIDDEN', value: NODE_OVERFLOW.HIDDEN },\n  { label: 'WRAP', value: NODE_OVERFLOW.WRAP },\n];\n\n/**\n * @param engine {@link ENGINE} \n * @param hmargin {number} \n * @param vmargin {number} \n * @param line_width {number} \n * @param line_color {string} html\n * @param draggable {boolean | true} \n * @param hide_scrollbars_when_draggable {boolean | true}  draggable = true \n * @param node_overflow {@link NODE_OVERFLOW} \n */\nexport interface View {\n  engine: ENGINE;\n  hmargin: number;\n  vmargin: number;\n  line_width: number;\n  line_color: string;\n  draggable: boolean | true;\n  hide_scrollbars_when_draggable: boolean | true;\n  node_overflow: NODE_OVERFLOW;\n}\n","import jsMind from 'jsmind/js/jsmind.js';\n//cdn.jsdelivr.net/npm/jsmind/js/jsmind.screenshot.js\n\nimport 'jsmind/style/jsmind.css';\n\nObject.defineProperty(window, 'jsMind', {\n  value: jsMind,\n  configurable: false,\n  writable: false,\n});\n","import { reactive, ref, getCurrentInstance } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport { LOGLEVEL, Meta, MODE, Options, THEME, ENGINE, NODE_OVERFLOW } from '@/interface/Mind';\nimport copy from 'copy-to-clipboard';\nimport '@/utils/init-Jsmind';\nimport 'jsmind/js/jsmind.draggable-node.js'; //  window.jsMind\nimport 'jsmind/js/jsmind.screenshot.js'; //  window.jsMind\n\nexport const meta: Meta = reactive<Meta>({\n  name: 'jsMind-demo',\n  author: 'demo@163.com',\n  version: '0.0.1',\n});\nexport const format = ref('node_tree');\nexport const defaultData = reactive({\n  id: 'root',\n  topic: 'jsMind',\n  children: [\n    {\n      id: 'easy',\n      topic: 'Easy',\n      direction: 'left',\n      children: [\n        { id: 'easy1', topic: 'Easy to show' },\n        { id: 'easy2', topic: 'Easy to edit' },\n        { id: 'easy3', topic: 'Easy to store' },\n        { id: 'easy4', topic: 'Easy to embed' },\n      ],\n    },\n    {\n      id: 'open',\n      topic: 'Open Source',\n      direction: 'right',\n      children: [\n        {\n          id: 'open1',\n          topic: 'on GitHub',\n          'background-color': '#eee',\n          'foreground-color': 'blue',\n          'leading-line-color': '#3333ff',\n        },\n        {\n          id: 'open2',\n          topic: 'BSD License',\n          'leading-line-color': '#ff33ff',\n        },\n      ],\n    },\n    {\n      id: 'powerful',\n      topic: 'Powerful',\n      direction: 'right',\n      children: [\n        { id: 'powerful1', topic: 'Base on Javascript' },\n        { id: 'powerful2', topic: 'Base on HTML5' },\n        { id: 'powerful3', topic: 'Depends on you' },\n      ],\n    },\n    {\n      id: 'other',\n      topic: 'test node',\n      direction: 'left',\n      children: [\n        { id: 'other1', topic: \"I'm from local variable\" },\n        { id: 'other2', topic: 'I can do everything' },\n      ],\n    },\n  ],\n});\nexport const emptyData = reactive({\n  id: 'root',\n  topic: 'jsMind',\n});\nexport const options: Options = reactive<Options>({\n  container: 'container',\n  editable: true,\n  theme: THEME.BELIZEHOLE,\n  mode: MODE.FULL,\n  support_html: true,\n  log_level: LOGLEVEL.INFO,\n  view: {\n    engine: ENGINE.SVG,\n    hmargin: 100,\n    vmargin: 50,\n    line_width: 2,\n    line_color: '#555',\n    draggable: true,\n    hide_scrollbars_when_draggable: true,\n    node_overflow: NODE_OVERFLOW.HIDDEN,\n  },\n  layout: {\n    hspace: 30, // \n    vspace: 20, // \n    pspace: 13, // /\n  },\n  shortcut: {\n    enable: true, // \n    handles: {}, // \n    mapping: {\n      // \n      addchild: [45, 4096 + 13], // <Insert>, <Ctrl> + <Enter>\n      addbrother: 13, // <Enter>\n      editnode: 113, // <F2>\n      delnode: 46, // <Delete>\n      toggle: 32, // <Space>\n      left: 37, // <Left>\n      up: 38, // <Up>\n      right: 39, // <Right>\n      down: 40, // <Down>\n    },\n  },\n});\nexport let _jm: any = null;\nexport const data_type = ref<'default' | 'empty'>('empty');\nexport const has_init = ref<boolean>(false);\nexport const has_setting = ref<boolean>(false);\n\n/**\n *  has_init \n * @param bool\n */\nexport const handleInit = (bool: boolean) => {\n  if (bool) {\n    initContainer();\n  } else {\n    destroyContainer();\n  }\n};\n\n/**\n * \n */\nconst initContainer = () => {\n  const app: HTMLElement = document.getElementById('app') || new HTMLElement();\n  const div = document.createElement('div');\n  div.id = `${options.container}`;\n  div.className = 'container';\n  div.style.width = '100vw';\n  div.style.height = '100vh';\n  div.style.backgroundColor = `var(--bg-color)`;\n  app.appendChild(div);\n  has_init.value = true;\n};\n\n/**\n * \n */\nconst destroyContainer = () => {\n  const app: HTMLElement = document.getElementById('app') || new HTMLElement();\n  app.removeChild(document.getElementsByClassName('container')[0] as HTMLElement);\n  has_init.value = false;\n};\n\n/**\n * \n */\nexport const copyData = () => {\n  const mind = {\n    meta,\n    data: data_type.value === 'empty' ? emptyData : defaultData,\n    format: format.value,\n  };\n  copy(JSON.stringify(mind));\n  ElMessage.success('');\n};\n\n/**\n * \n */\nexport const open_view = (type: 'default' | 'empty' = 'empty') => {\n  data_type.value = type;\n  handleInit(true);\n  const mind = {\n    meta,\n    data: type === 'empty' ? emptyData : defaultData,\n    format: format.value,\n  };\n  _jm = new window.jsMind(options);\n  _jm.show(mind);\n};\n\n/**\n * \n * @param theme_name\n */\nexport const set_theme = (theme_name: THEME) => {\n  _jm.set_theme(theme_name);\n};\n\n/**\n *  \n * @param bool\n */\nexport const handle_editable = (bool: boolean) => {\n  if (bool) {\n    _jm.enable_edit();\n    ElMessage.success('');\n  } else {\n    _jm.disable_edit();\n    ElMessage.warning('');\n  }\n};\n\n/**\n *  HTML\n * @param bool\n */\nexport const handle_support_html = (bool: boolean) => {\n  // todo \n  if (bool) {\n    ElMessage.success('HTML');\n  } else {\n    ElMessage.warning('HTML');\n  }\n};\n\n/**\n *  \n * @param log_level\n */\nexport const set_log_level = (log_level: LOGLEVEL) => {\n  // todo \n  ElMessage.success(`${log_level}`);\n};\n\n/**\n * \n */\nexport const screen_shot = () => {\n  _jm.screenshot.shootDownload();\n};\n\nexport const reload = () => {\n  // _jm._reset();\n  // const mind = { meta, data, format: format.value };\n  // _jm.show(mind);\n  // todo \n  // _jm.init();\n};\n// // this method change size of container, perpare for adjusting jsmind\n// function change_container() {\n//   const c = document.getElementById('jsmind_container');\n//   c.style.width = '800px';\n//   c.style.height = '500px';\n// }\n//\nexport const resize_jsmind = () => {\n  _jm.resize();\n};\n\n// function open_json() {\n//   const mind = {\n//     meta: {\n//       name: 'jsMind remote',\n//       author: 'hizzgdev@163.com',\n//       version: '0.2',\n//     },\n//     format: 'node_tree',\n//     data: {\n//       id: 'root',\n//       topic: 'jsMind',\n//       children: [\n//         {\n//           id: 'easy',\n//           topic: 'Easy',\n//           direction: 'left',\n//           children: [\n//             { id: 'easy1', topic: 'Easy to show' },\n//             { id: 'easy2', topic: 'Easy to edit' },\n//             { id: 'easy3', topic: 'Easy to store' },\n//             { id: 'easy4', topic: 'Easy to embed' },\n//             {\n//               id: 'other3',\n//               'background-image': 'ant.png',\n//               width: '100',\n//               height: '100',\n//             },\n//           ],\n//         },\n//         {\n//           id: 'open',\n//           topic: 'Open Source',\n//           direction: 'right',\n//           children: [\n//             {\n//               id: 'open1',\n//               topic: 'on GitHub',\n//               'background-color': '#eee',\n//               'foreground-color': 'blue',\n//               'leading-line-color': '#3333ff',\n//             },\n//             {\n//               id: 'open2',\n//               topic: 'BSD License',\n//               'leading-line-color': '#ff33ff',\n//             },\n//           ],\n//         },\n//         {\n//           id: 'powerful',\n//           topic: 'Powerful',\n//           direction: 'right',\n//           children: [\n//             { id: 'powerful1', topic: 'Base on Javascript' },\n//             { id: 'powerful2', topic: 'Base on HTML5' },\n//             { id: 'powerful3', topic: 'Depends on you' },\n//           ],\n//         },\n//         {\n//           id: 'other',\n//           topic: 'test node',\n//           direction: 'left',\n//           children: [\n//             { id: 'other1', topic: \"I'm from local variable\" },\n//             { id: 'other2', topic: 'I can do everything' },\n//           ],\n//         },\n//       ],\n//     },\n//   };\n//   _jm.show(mind);\n// }\n//\n// function open_ajax() {\n//   const mind_url = 'data_example.json';\n//   window.jsMind.util.ajax.get(mind_url, function (mind) {\n//     _jm.show(mind);\n//   });\n// }\n//\n// function screen_shot() {\n//   _jm.screenshot.shootDownload();\n// }\n//\n// function show_data() {\n//   const mind_data = _jm.get_data();\n//   const mind_string = window.jsMind.util.json.json2string(mind_data);\n//   prompt_info(mind_string);\n// }\n//\n// function save_file() {\n//   const mind_data = _jm.get_data();\n//   const mind_name = mind_data.meta.name;\n//   const mind_str = window.jsMind.util.json.json2string(mind_data);\n//   window.jsMind.util.file.save(mind_str, 'text/jsmind', mind_name + '.jm');\n// }\n//\n// function open_file() {\n//   const file_input = document.getElementById('file_input');\n//   const files = file_input.files;\n//   if (files.length > 0) {\n//     const file_data = files[0];\n//     window.jsMind.util.file.read(file_data, function (jsmind_data, jsmind_name) {\n//       const mind = window.jsMind.util.json.string2json(jsmind_data);\n//       if (mind) {\n//         _jm.show(mind);\n//       } else {\n//         prompt_info('can not open this file as mindmap');\n//       }\n//     });\n//   } else {\n//     prompt_info('please choose a file first');\n//   }\n// }\n//\n// function select_node() {\n//   const nodeid = 'other';\n//   _jm.select_node(nodeid);\n// }\n//\n// function show_selected() {\n//   const selected_node = _jm.get_selected_node();\n//   if (selected_node) {\n//     prompt_info(selected_node.topic);\n//   } else {\n//     prompt_info('nothing');\n//   }\n// }\n//\n// function get_selected_nodeid() {\n//   const selected_node = _jm.get_selected_node();\n//   if (selected_node) {\n//     return selected_node.id;\n//   } else {\n//     return null;\n//   }\n// }\n//\n// function add_node() {\n//   const selected_node = _jm.get_selected_node(); // as parent of new node\n//   if (!selected_node) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   const nodeid = window.jsMind.util.uuid.newid();\n//   const topic = '* Node_' + nodeid.substr(nodeid.length - 6) + ' *';\n//   const node = _jm.add_node(selected_node, nodeid, topic);\n// }\n//\n// const imageChooser = document.getElementById('image-chooser');\n//\n// imageChooser.addEventListener(\n//   'change',\n//   function (event) {\n//     // Read file here.\n//     const reader = new FileReader();\n//     reader.onloadend = function () {\n//       const selected_node = _jm.get_selected_node();\n//       const nodeid = window.jsMind.util.uuid.newid();\n//       const topic = undefined;\n//       const data = {\n//         'background-image': reader.result,\n//         width: '100',\n//         height: '100',\n//       };\n//       const node = _jm.add_node(selected_node, nodeid, topic, data);\n//       //var node = _jm.add_image_node(selected_node, nodeid, reader.result, 100, 100);\n//       //add_image_node:function(parent_node, nodeid, image, width, height, data, idx, direction, expanded){\n//     };\n//\n//     const file = imageChooser.files[0];\n//     if (file) {\n//       reader.readAsDataURL(file);\n//     }\n//   },\n//   false\n// );\n//\n// function add_image_node() {\n//   const selected_node = _jm.get_selected_node(); // as parent of new node\n//   if (!selected_node) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   imageChooser.focus();\n//   imageChooser.click();\n// }\n//\n// function modify_node() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   // modify the topic\n//   _jm.update_node(selected_id, '--- modified ---');\n// }\n//\n// function move_to_first() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.move_node(selected_id, '_first_');\n// }\n//\n// function move_to_last() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.move_node(selected_id, '_last_');\n// }\n//\n// function move_node() {\n//   // move a node before another\n//   _jm.move_node('other', 'open');\n// }\n//\n// function remove_node() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.remove_node(selected_id);\n// }\n//\n// function change_text_font() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.set_node_font_style(selected_id, 28);\n// }\n//\n// function change_text_color() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.set_node_color(selected_id, null, '#000');\n// }\n//\n// function change_background_color() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.set_node_color(selected_id, '#eee', null);\n// }\n//\n// function change_background_image() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.set_node_background_image(selected_id, 'ant.png', 100, 100);\n// }\n//\n\n//\n// const zoomInButton = document.getElementById('zoom-in-button');\n// const zoomOutButton = document.getElementById('zoom-out-button');\n//\n// function zoomIn() {\n//   if (_jm.view.zoomIn()) {\n//     zoomOutButton.disabled = false;\n//   } else {\n//     zoomInButton.disabled = true;\n//   }\n// }\n//\n// function zoomOut() {\n//   if (_jm.view.zoomOut()) {\n//     zoomInButton.disabled = false;\n//   } else {\n//     zoomOutButton.disabled = true;\n//   }\n// }\n//\n\n//\n\n//\n// function expand() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.expand_node(selected_id);\n// }\n//\n// function collapse() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.collapse_node(selected_id);\n// }\n//\n// function toggle() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.toggle_node(selected_id);\n// }\n//\n// function expand_all() {\n//   _jm.expand_all();\n// }\n//\n// function expand_to_level2() {\n//   _jm.expand_to_depth(2);\n// }\n//\n// function expand_to_level3() {\n//   _jm.expand_to_depth(3);\n// }\n//\n// function collapse_all() {\n//   _jm.collapse_all();\n// }\n//\n// function get_nodearray_data() {\n//   const mind_data = _jm.get_data('node_array');\n//   const mind_string = window.jsMind.util.json.json2string(mind_data);\n//   prompt_info(mind_string);\n// }\n//\n// function save_nodearray_file() {\n//   const mind_data = _jm.get_data('node_array');\n//   const mind_name = mind_data.meta.name;\n//   const mind_str = window.jsMind.util.json.json2string(mind_data);\n//   window.jsMind.util.file.save(mind_str, 'text/jsmind', mind_name + '.jm');\n// }\n//\n// function open_nodearray() {\n//   const file_input = document.getElementById('file_input_nodearray');\n//   const files = file_input.files;\n//   if (files.length > 0) {\n//     const file_data = files[0];\n//     window.jsMind.util.file.read(file_data, function (jsmind_data, jsmind_name) {\n//       const mind = window.jsMind.util.json.string2json(jsmind_data);\n//       if (mind) {\n//         _jm.show(mind);\n//       } else {\n//         prompt_info('can not open this file as mindmap');\n//       }\n//     });\n//   } else {\n//     prompt_info('please choose a file first');\n//   }\n// }\n//\n// function get_freemind_data() {\n//   const mind_data = _jm.get_data('freemind');\n//   const mind_string = window.jsMind.util.json.json2string(mind_data);\n//   alert(mind_string);\n// }\n//\n// function save_freemind_file() {\n//   const mind_data = _jm.get_data('freemind');\n//   const mind_name = mind_data.meta.name || 'freemind';\n//   const mind_str = mind_data.data;\n//   window.jsMind.util.file.save(mind_str, 'text/xml', mind_name + '.mm');\n// }\n//\n// function open_freemind() {\n//   const file_input = document.getElementById('file_input_freemind');\n//   const files = file_input.files;\n//   if (files.length > 0) {\n//     const file_data = files[0];\n//     window.jsMind.util.file.read(file_data, function (freemind_data, freemind_name) {\n//       if (freemind_data) {\n//         let mind_name = freemind_name;\n//         if (/.*\\.mm$/.test(mind_name)) {\n//           mind_name = freemind_name.substring(0, freemind_name.length - 3);\n//         }\n//         const mind = {\n//           meta: {\n//             name: mind_name,\n//             author: 'hizzgdev@163.com',\n//             version: '1.0.1',\n//           },\n//           format: 'freemind',\n//           data: freemind_data,\n//         };\n//         _jm.show(mind);\n//       } else {\n//         prompt_info('can not open this file as mindmap');\n//       }\n//     });\n//   } else {\n//     prompt_info('please choose a file first');\n//   }\n// }\n//\n// function get_text_data() {\n//   const mind_data = _jm.get_data('text');\n//   const mind_string = window.jsMind.util.json.json2string(mind_data);\n//   prompt_info(mind_string);\n// }\n//\n// function save_text_file() {\n//   const mind_data = _jm.get_data('text');\n//   const mind_name = mind_data.meta.name;\n//   const mind_str = window.jsMind.util.json.json2string(mind_data);\n//   window.jsMind.util.file.save(mind_str, 'text/jsmind', mind_name + '.jm');\n// }\n//\n// function open_text() {\n//   const file_input = document.getElementById('file_input_text');\n//   const files = file_input.files;\n//   if (files.length > 0) {\n//     const file_data = files[0];\n//     window.jsMind.util.file.read(file_data, function (jsmind_data, jsmind_name) {\n//       const mind = window.jsMind.util.json.string2json(jsmind_data);\n//       if (mind) {\n//         _jm.show(mind);\n//       } else {\n//         prompt_info('can not open this file as mindmap');\n//       }\n//     });\n//   } else {\n//     prompt_info('please choose a file first');\n//   }\n// }\n//\n// function prompt_info(msg) {\n//   alert(msg);\n// }\n//\n// open_empty();\n","\"use strict\";\n\nvar deselectCurrent = require(\"toggle-selection\");\n\nvar clipboardToIE11Formatting = {\n  \"text/plain\": \"Text\",\n  \"text/html\": \"Url\",\n  \"default\": \"Text\"\n}\n\nvar defaultMessage = \"Copy to clipboard: #{key}, Enter\";\n\nfunction format(message) {\n  var copyKey = (/mac os x/i.test(navigator.userAgent) ? \"\" : \"Ctrl\") + \"+C\";\n  return message.replace(/#{\\s*key\\s*}/g, copyKey);\n}\n\nfunction copy(text, options) {\n  var debug,\n    message,\n    reselectPrevious,\n    range,\n    selection,\n    mark,\n    success = false;\n  if (!options) {\n    options = {};\n  }\n  debug = options.debug || false;\n  try {\n    reselectPrevious = deselectCurrent();\n\n    range = document.createRange();\n    selection = document.getSelection();\n\n    mark = document.createElement(\"span\");\n    mark.textContent = text;\n    // avoid screen readers from reading out loud the text\n    mark.ariaHidden = \"true\"\n    // reset user styles for span element\n    mark.style.all = \"unset\";\n    // prevents scrolling to the end of the page\n    mark.style.position = \"fixed\";\n    mark.style.top = 0;\n    mark.style.clip = \"rect(0, 0, 0, 0)\";\n    // used to preserve spaces and line breaks\n    mark.style.whiteSpace = \"pre\";\n    // do not inherit user-select (it may be `none`)\n    mark.style.webkitUserSelect = \"text\";\n    mark.style.MozUserSelect = \"text\";\n    mark.style.msUserSelect = \"text\";\n    mark.style.userSelect = \"text\";\n    mark.addEventListener(\"copy\", function(e) {\n      e.stopPropagation();\n      if (options.format) {\n        e.preventDefault();\n        if (typeof e.clipboardData === \"undefined\") { // IE 11\n          debug && console.warn(\"unable to use e.clipboardData\");\n          debug && console.warn(\"trying IE specific stuff\");\n          window.clipboardData.clearData();\n          var format = clipboardToIE11Formatting[options.format] || clipboardToIE11Formatting[\"default\"]\n          window.clipboardData.setData(format, text);\n        } else { // all other browsers\n          e.clipboardData.clearData();\n          e.clipboardData.setData(options.format, text);\n        }\n      }\n      if (options.onCopy) {\n        e.preventDefault();\n        options.onCopy(e.clipboardData);\n      }\n    });\n\n    document.body.appendChild(mark);\n\n    range.selectNodeContents(mark);\n    selection.addRange(range);\n\n    var successful = document.execCommand(\"copy\");\n    if (!successful) {\n      throw new Error(\"copy command was unsuccessful\");\n    }\n    success = true;\n  } catch (err) {\n    debug && console.error(\"unable to copy using execCommand: \", err);\n    debug && console.warn(\"trying IE specific stuff\");\n    try {\n      window.clipboardData.setData(options.format || \"text\", text);\n      options.onCopy && options.onCopy(window.clipboardData);\n      success = true;\n    } catch (err) {\n      debug && console.error(\"unable to copy using clipboardData: \", err);\n      debug && console.error(\"falling back to prompt\");\n      message = format(\"message\" in options ? options.message : defaultMessage);\n      window.prompt(message, text);\n    }\n  } finally {\n    if (selection) {\n      if (typeof selection.removeRange == \"function\") {\n        selection.removeRange(range);\n      } else {\n        selection.removeAllRanges();\n      }\n    }\n\n    if (mark) {\n      document.body.removeChild(mark);\n    }\n    reselectPrevious();\n  }\n\n  return success;\n}\n\nmodule.exports = copy;\n","/**\n * @license BSD\n * @copyright 2014-2023 hizzgdev@163.com\n * \n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\n(function ($w) {\n    'use strict';\n    var $d = $w.document;\n    var __name__ = 'jsMind';\n    var jsMind = $w[__name__];\n    if (!jsMind) { return; }\n    if (typeof jsMind.draggable != 'undefined') { return; }\n\n    var jdom = jsMind.util.dom;\n    var clear_selection = 'getSelection' in $w ? function () {\n        $w.getSelection().removeAllRanges();\n    } : function () {\n        $d.selection.empty();\n    };\n\n    var options = {\n        line_width: 5,\n        lookup_delay: 500,\n        lookup_interval: 80\n    };\n\n    jsMind.draggable = function (jm) {\n        this.jm = jm;\n        this.e_canvas = null;\n        this.canvas_ctx = null;\n        this.shadow = null;\n        this.shadow_w = 0;\n        this.shadow_h = 0;\n        this.active_node = null;\n        this.target_node = null;\n        this.target_direct = null;\n        this.client_w = 0;\n        this.client_h = 0;\n        this.offset_x = 0;\n        this.offset_y = 0;\n        this.hlookup_delay = 0;\n        this.hlookup_timer = 0;\n        this.capture = false;\n        this.moved = false;\n    };\n\n    jsMind.draggable.prototype = {\n        init: function () {\n            this._create_canvas();\n            this._create_shadow();\n            this._event_bind();\n        },\n\n        resize: function () {\n            this.jm.view.e_nodes.appendChild(this.shadow);\n            this.e_canvas.width = this.jm.view.size.w;\n            this.e_canvas.height = this.jm.view.size.h;\n        },\n\n        _create_canvas: function () {\n            var c = $d.createElement('canvas');\n            this.jm.view.e_panel.appendChild(c);\n            var ctx = c.getContext('2d');\n            this.e_canvas = c;\n            this.canvas_ctx = ctx;\n        },\n\n        _create_shadow: function () {\n            var s = $d.createElement('jmnode');\n            s.style.visibility = 'hidden';\n            s.style.zIndex = '3';\n            s.style.cursor = 'move';\n            s.style.opacity = '0.7';\n            this.shadow = s;\n        },\n\n        reset_shadow: function (el) {\n            var s = this.shadow.style;\n            this.shadow.innerHTML = el.innerHTML;\n            s.left = el.style.left;\n            s.top = el.style.top;\n            s.width = el.style.width;\n            s.height = el.style.height;\n            s.backgroundImage = el.style.backgroundImage;\n            s.backgroundSize = el.style.backgroundSize;\n            s.transform = el.style.transform;\n            this.shadow_w = this.shadow.clientWidth;\n            this.shadow_h = this.shadow.clientHeight;\n\n        },\n\n        show_shadow: function () {\n            if (!this.moved) {\n                this.shadow.style.visibility = 'visible';\n            }\n        },\n\n        hide_shadow: function () {\n            this.shadow.style.visibility = 'hidden';\n        },\n\n        _magnet_shadow: function (node) {\n            if (!!node) {\n                this.canvas_ctx.lineWidth = options.line_width;\n                this.canvas_ctx.strokeStyle = 'rgba(0,0,0,0.3)';\n                this.canvas_ctx.lineCap = 'round';\n                this._clear_lines();\n                this._canvas_lineto(node.sp.x, node.sp.y, node.np.x, node.np.y);\n            }\n        },\n\n        _clear_lines: function () {\n            this.canvas_ctx.clearRect(0, 0, this.jm.view.size.w, this.jm.view.size.h);\n        },\n\n        _canvas_lineto: function (x1, y1, x2, y2) {\n            this.canvas_ctx.beginPath();\n            this.canvas_ctx.moveTo(x1, y1);\n            this.canvas_ctx.lineTo(x2, y2);\n            this.canvas_ctx.stroke();\n        },\n\n        _lookup_close_node: function () {\n            var root = this.jm.get_root();\n            var root_location = root.get_location();\n            var root_size = root.get_size();\n            var root_x = root_location.x + root_size.w / 2;\n\n            var sw = this.shadow_w;\n            var sh = this.shadow_h;\n            var sx = this.shadow.offsetLeft;\n            var sy = this.shadow.offsetTop;\n\n            var ns, nl;\n\n            var direct = (sx + sw / 2) >= root_x ?\n                jsMind.direction.right : jsMind.direction.left;\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var layout = this.jm.layout;\n            var min_distance = Number.MAX_VALUE;\n            var distance = 0;\n            var closest_node = null;\n            var closest_p = null;\n            var shadow_p = null;\n            for (var nodeid in nodes) {\n                var np, sp;\n                node = nodes[nodeid];\n                if (node.isroot || node.direction == direct) {\n                    if (node.id == this.active_node.id) {\n                        continue;\n                    }\n                    if (!layout.is_visible(node)) {\n                        continue;\n                    }\n                    ns = node.get_size();\n                    nl = node.get_location();\n                    if (direct == jsMind.direction.right) {\n                        if (sx - nl.x - ns.w <= 0) { continue; }\n                        distance = Math.abs(sx - nl.x - ns.w) + Math.abs(sy + sh / 2 - nl.y - ns.h / 2);\n                        np = { x: nl.x + ns.w - options.line_width, y: nl.y + ns.h / 2 };\n                        sp = { x: sx + options.line_width, y: sy + sh / 2 };\n                    } else {\n                        if (nl.x - sx - sw <= 0) { continue; }\n                        distance = Math.abs(sx + sw - nl.x) + Math.abs(sy + sh / 2 - nl.y - ns.h / 2);\n                        np = { x: nl.x + options.line_width, y: nl.y + ns.h / 2 };\n                        sp = { x: sx + sw - options.line_width, y: sy + sh / 2 };\n                    }\n                    if (distance < min_distance) {\n                        closest_node = node;\n                        closest_p = np;\n                        shadow_p = sp;\n                        min_distance = distance;\n                    }\n                }\n            }\n            var result_node = null;\n            if (!!closest_node) {\n                result_node = {\n                    node: closest_node,\n                    direction: direct,\n                    sp: shadow_p,\n                    np: closest_p\n                };\n            }\n            return result_node;\n        },\n\n        lookup_close_node: function () {\n            var node_data = this._lookup_close_node();\n            if (!!node_data) {\n                this._magnet_shadow(node_data);\n                this.target_node = node_data.node;\n                this.target_direct = node_data.direction;\n            }\n        },\n\n        _event_bind: function () {\n            var jd = this;\n            var container = this.jm.view.container;\n            jdom.add_event(container, 'mousedown', function (e) {\n                var evt = e || event;\n                jd.dragstart.call(jd, evt);\n            });\n            jdom.add_event(container, 'mousemove', function (e) {\n                var evt = e || event;\n                jd.drag.call(jd, evt);\n            });\n            jdom.add_event(container, 'mouseup', function (e) {\n                var evt = e || event;\n                jd.dragend.call(jd, evt);\n            });\n            jdom.add_event(container, 'touchstart', function (e) {\n                var evt = e || event;\n                jd.dragstart.call(jd, evt);\n            });\n            jdom.add_event(container, 'touchmove', function (e) {\n                var evt = e || event;\n                jd.drag.call(jd, evt);\n            });\n            jdom.add_event(container, 'touchend', function (e) {\n                var evt = e || event;\n                jd.dragend.call(jd, evt);\n            });\n        },\n\n        dragstart: function (e) {\n            if (!this.jm.get_editable()) { return; }\n            if (this.capture) { return; }\n            this.active_node = null;\n\n            var jview = this.jm.view;\n            var el = e.target || event.srcElement;\n            if (el.tagName.toLowerCase() != 'jmnode') { return; }\n            if (jview.get_draggable_canvas()) { jview.disable_draggable_canvas() }\n            var nodeid = jview.get_binded_nodeid(el);\n            if (!!nodeid) {\n                var node = this.jm.get_node(nodeid);\n                if (!node.isroot) {\n                    this.reset_shadow(el);\n                    this.active_node = node;\n                    this.offset_x = (e.clientX || e.touches[0].clientX) / jview.actualZoom - el.offsetLeft;\n                    this.offset_y = (e.clientY || e.touches[0].clientY) / jview.actualZoom - el.offsetTop;\n                    this.client_hw = Math.floor(el.clientWidth / 2);\n                    this.client_hh = Math.floor(el.clientHeight / 2);\n                    if (this.hlookup_delay != 0) {\n                        $w.clearTimeout(this.hlookup_delay);\n                    }\n                    if (this.hlookup_timer != 0) {\n                        $w.clearInterval(this.hlookup_timer);\n                    }\n                    var jd = this;\n                    this.hlookup_delay = $w.setTimeout(function () {\n                        jd.hlookup_delay = 0;\n                        jd.hlookup_timer = $w.setInterval(function () {\n                            jd.lookup_close_node.call(jd);\n                        }, options.lookup_interval);\n                    }, options.lookup_delay);\n                    this.capture = true;\n                }\n            }\n        },\n\n        drag: function (e) {\n            if (!this.jm.get_editable()) { return; }\n            if (this.capture) {\n                e.preventDefault();\n                this.show_shadow();\n                this.moved = true;\n                clear_selection();\n                var jview = this.jm.view;\n                var px = (e.clientX || e.touches[0].clientX) / jview.actualZoom - this.offset_x;\n                var py = (e.clientY || e.touches[0].clientY) / jview.actualZoom - this.offset_y;\n                this.shadow.style.left = px + 'px';\n                this.shadow.style.top = py + 'px';\n                clear_selection();\n            }\n        },\n\n        dragend: function (e) {\n            if (!this.jm.get_editable()) { return; }\n            if (this.jm.view.get_draggable_canvas()) { this.jm.view.enable_draggable_canvas() }\n            if (this.capture) {\n                if (this.hlookup_delay != 0) {\n                    $w.clearTimeout(this.hlookup_delay);\n                    this.hlookup_delay = 0;\n                    this._clear_lines();\n                }\n                if (this.hlookup_timer != 0) {\n                    $w.clearInterval(this.hlookup_timer);\n                    this.hlookup_timer = 0;\n                    this._clear_lines();\n                }\n                if (this.moved) {\n                    var src_node = this.active_node;\n                    var target_node = this.target_node;\n                    var target_direct = this.target_direct;\n                    this.move_node(src_node, target_node, target_direct);\n                }\n                this.hide_shadow();\n            }\n            this.moved = false;\n            this.capture = false;\n        },\n\n        move_node: function (src_node, target_node, target_direct) {\n            var shadow_h = this.shadow.offsetTop;\n            if (!!target_node && !!src_node && !jsMind.node.inherited(src_node, target_node)) {\n                // lookup before_node\n                var sibling_nodes = target_node.children;\n                var sc = sibling_nodes.length;\n                var node = null;\n                var delta_y = Number.MAX_VALUE;\n                var node_before = null;\n                var beforeid = '_last_';\n                while (sc--) {\n                    node = sibling_nodes[sc];\n                    if (node.direction == target_direct && node.id != src_node.id) {\n                        var dy = node.get_location().y - shadow_h;\n                        if (dy > 0 && dy < delta_y) {\n                            delta_y = dy;\n                            node_before = node;\n                            beforeid = '_first_';\n                        }\n                    }\n                }\n                if (!!node_before) { beforeid = node_before.id; }\n                this.jm.move_node(src_node.id, beforeid, target_node.id, target_direct);\n            }\n            this.active_node = null;\n            this.target_node = null;\n            this.target_direct = null;\n        },\n\n        jm_event_handle: function (type, data) {\n            if (type === jsMind.event_type.resize) {\n                this.resize();\n            }\n        }\n    };\n\n    var draggable_plugin = new jsMind.plugin('draggable', function (jm) {\n        var jd = new jsMind.draggable(jm);\n        jd.init();\n        jm.add_event_listener(function (type, data) {\n            jd.jm_event_handle.call(jd, type, data);\n        });\n    });\n\n    jsMind.register_plugin(draggable_plugin);\n\n})(window);\n","/**\n * @license BSD\n * @copyright 2014-2023 hizzgdev@163.com\n *\n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\n; (function ($w) {\n    'use strict';\n    // set 'jsMind' as the library name.\n    // __name__ should be a const value, Never try to change it easily.\n    var __name__ = 'jsMind';\n    // library version\n    var __version__ = '0.5.2';\n    // author\n    var __author__ = 'hizzgdev@163.com';\n\n    // an noop function define\n    var _noop = function () { };\n    var logger = (typeof console === 'undefined') ? {\n        log: _noop, debug: _noop, error: _noop, warn: _noop, info: _noop\n    } : console;\n\n    // check global variables\n    if (typeof module === 'undefined' || !module.exports) {\n        if (typeof $w[__name__] != 'undefined') {\n            logger.log(__name__ + ' has been already exist.');\n            return;\n        }\n    }\n\n    // shortcut of methods in dom\n    var $d = $w.document;\n    var $g = function (id) { return $d.getElementById(id); };\n    var $c = function (tag) { return $d.createElement(tag); };\n    var $t = function (n, t) { if (n.hasChildNodes()) { n.firstChild.nodeValue = t; } else { n.appendChild($d.createTextNode(t)); } };\n\n    var $h = function (n, t) {\n        if (t instanceof HTMLElement) {\n            n.innerHTML = '';\n            n.appendChild(t);\n        } else {\n            n.innerHTML = t;\n        }\n    };\n    // detect isElement\n    var $i = function (el) { return !!el && (typeof el === 'object') && (el.nodeType === 1) && (typeof el.style === 'object') && (typeof el.ownerDocument === 'object'); };\n    if (typeof String.prototype.startsWith != 'function') { String.prototype.startsWith = function (p) { return this.slice(0, p.length) === p; }; }\n\n    var DEFAULT_OPTIONS = {\n        container: '',   // id of the container\n        editable: false, // you can change it in your options\n        theme: null,\n        mode: 'full',    // full or side\n        support_html: true,\n\n        view: {\n            engine: 'canvas',\n            hmargin: 100,\n            vmargin: 50,\n            line_width: 2,\n            line_color: '#555',\n            draggable: false, // drag the mind map with your mouse, when it's larger that the container\n            hide_scrollbars_when_draggable: false, // hide container scrollbars, when mind map is larger than container and draggable option is true.\n            node_overflow: 'hidden' // hidden or wrap\n        },\n        layout: {\n            hspace: 30,\n            vspace: 20,\n            pspace: 13\n        },\n        default_event_handle: {\n            enable_mousedown_handle: true,\n            enable_click_handle: true,\n            enable_dblclick_handle: true,\n            enable_mousewheel_handle: true\n        },\n        shortcut: {\n            enable: true,\n            handles: {\n            },\n            mapping: {\n                addchild: [45, 4096+13], // Insert, Ctrl+Enter\n                addbrother: 13, // Enter\n                editnode: 113,// F2\n                delnode: 46, // Delete\n                toggle: 32, // Space\n                left: 37, // Left\n                up: 38, // Up\n                right: 39, // Right\n                down: 40, // Down\n            }\n        },\n    };\n\n    // core object\n    var jm = function (options) {\n        jm.current = this;\n\n        this.version = __version__;\n        var opts = {};\n        jm.util.json.merge(opts, DEFAULT_OPTIONS);\n        jm.util.json.merge(opts, options);\n\n        if (!opts.container) {\n            logger.error('the options.container should not be null or empty.');\n            return;\n        }\n        this.options = opts;\n        this.initialized = false;\n        this.mind = null;\n        this.event_handles = [];\n        this.init();\n    };\n\n    // ============= static object =============================================\n    jm.direction = {\n        left: -1, center: 0, right: 1, of: function (dir) {\n            if (!dir || dir === -1 || dir === 0 || dir === 1) {\n                return dir;\n            }\n            if (dir === '-1' || dir === '0' || dir === '1') {\n                return parseInt(dir);\n            }\n            if (dir.toLowerCase() === 'left') {\n                return this.left;\n            }\n            if (dir.toLowerCase() === 'right') {\n                return this.right;\n            }\n            if (dir.toLowerCase() === 'center') {\n                return this.center;\n            }\n        }\n    };\n    jm.event_type = { show: 1, resize: 2, edit: 3, select: 4 };\n    jm.key = { meta: 1 << 13, ctrl: 1 << 12, alt: 1 << 11, shift: 1 << 10 };\n\n    jm.node = function (sId, iIndex, sTopic, oData, bIsRoot, oParent, eDirection, bExpanded) {\n        if (!sId) { logger.error('invalid node id'); return; }\n        if (typeof iIndex != 'number') { logger.error('invalid node index'); return; }\n        if (typeof bExpanded === 'undefined') { bExpanded = true; }\n        this.id = sId;\n        this.index = iIndex;\n        this.topic = sTopic;\n        this.data = oData || {};\n        this.isroot = bIsRoot;\n        this.parent = oParent;\n        this.direction = eDirection;\n        this.expanded = !!bExpanded;\n        this.children = [];\n        this._data = {};\n    };\n\n    jm.node.compare = function (node1, node2) {\n        // '-1' is alwary the last\n        var r = 0;\n        var i1 = node1.index;\n        var i2 = node2.index;\n        if (i1 >= 0 && i2 >= 0) {\n            r = i1 - i2;\n        } else if (i1 == -1 && i2 == -1) {\n            r = 0;\n        } else if (i1 == -1) {\n            r = 1;\n        } else if (i2 == -1) {\n            r = -1;\n        } else {\n            r = 0;\n        }\n        //logger.debug(i1+' <> '+i2+'  =  '+r);\n        return r;\n    };\n\n    jm.node.inherited = function (pnode, node) {\n        if (!!pnode && !!node) {\n            if (pnode.id === node.id) {\n                return true;\n            }\n            if (pnode.isroot) {\n                return true;\n            }\n            var pid = pnode.id;\n            var p = node;\n            while (!p.isroot) {\n                p = p.parent;\n                if (p.id === pid) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    jm.node.is_node = function (n) {\n        return !!n && n instanceof jm.node;\n    };\n\n    jm.node.prototype = {\n        get_location: function () {\n            var vd = this._data.view;\n            return {\n                x: vd.abs_x,\n                y: vd.abs_y\n            };\n        },\n        get_size: function () {\n            var vd = this._data.view;\n            return {\n                w: vd.width,\n                h: vd.height\n            }\n        }\n    };\n\n\n    jm.mind = function () {\n        this.name = null;\n        this.author = null;\n        this.version = null;\n        this.root = null;\n        this.selected = null;\n        this.nodes = {};\n    };\n\n    jm.mind.prototype = {\n        get_node: function (nodeid) {\n            if (nodeid in this.nodes) {\n                return this.nodes[nodeid];\n            } else {\n                logger.warn('the node[id=' + nodeid + '] can not be found');\n                return null;\n            }\n        },\n\n        set_root: function (nodeid, topic, data) {\n            if (this.root == null) {\n                this.root = new jm.node(nodeid, 0, topic, data, true);\n                this._put_node(this.root);\n                return this.root;\n            } else {\n                logger.error('root node is already exist');\n                return null;\n            }\n        },\n\n        add_node: function (parent_node, nodeid, topic, data, direction, expanded, idx) {\n            if (!jm.util.is_node(parent_node)) {\n                logger.error('the parent_node ' + parent_node + ' is not a node.');\n                return null;\n            }\n            var node_index = idx || -1;\n            var node = new jm.node(nodeid, node_index, topic, data, false, parent_node, parent_node.direction, expanded);\n            if (parent_node.isroot) {\n                node.direction = direction || jm.direction.right;\n            }\n            if (this._put_node(node)) {\n                parent_node.children.push(node);\n                this._reindex(parent_node);\n            } else {\n                logger.error('fail, the nodeid \\'' + node.id + '\\' has been already exist.');\n                node = null;\n            }\n            return node;\n        },\n\n        insert_node_before: function (node_before, nodeid, topic, data, direction) {\n            if (!jm.util.is_node(node_before)) {\n                logger.error('the node_before ' + node_before + ' is not a node.');\n                return null;\n            }\n            var node_index = node_before.index - 0.5;\n            return this.add_node(node_before.parent, nodeid, topic, data, direction, true, node_index);\n        },\n\n        get_node_before: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_before(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var idx = node.index - 2;\n            if (idx >= 0) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        insert_node_after: function (node_after, nodeid, topic, data, direction) {\n            if (!jm.util.is_node(node_after)) {\n                logger.error('the node_after ' + node_after + ' is not a node.');\n                return null;\n            }\n            var node_index = node_after.index + 0.5;\n            return this.add_node(node_after.parent, nodeid, topic, data, direction, true, node_index);\n        },\n\n        get_node_after: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_after(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var idx = node.index;\n            var brothers = node.parent.children;\n            if (brothers.length > idx) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        move_node: function (node, before_id, parent_id, direction) {\n            if (!jm.util.is_node(node)) {\n                logger.error('the parameter node ' + node + ' is not a node.');\n                return null;\n            }\n            if (!parent_id) {\n                parent_id = node.parent.id;\n            }\n            return this._move_node(node, before_id, parent_id, direction);\n        },\n\n        _flow_node_direction: function (node, direction) {\n            if (typeof direction === 'undefined') {\n                direction = node.direction;\n            } else {\n                node.direction = direction;\n            }\n            var len = node.children.length;\n            while (len--) {\n                this._flow_node_direction(node.children[len], direction);\n            }\n        },\n\n        _move_node_internal: function (node, beforeid) {\n            if (!!node && !!beforeid) {\n                if (beforeid == '_last_') {\n                    node.index = -1;\n                    this._reindex(node.parent);\n                } else if (beforeid == '_first_') {\n                    node.index = 0;\n                    this._reindex(node.parent);\n                } else {\n                    var node_before = (!!beforeid) ? this.get_node(beforeid) : null;\n                    if (node_before != null && node_before.parent != null && node_before.parent.id == node.parent.id) {\n                        node.index = node_before.index - 0.5;\n                        this._reindex(node.parent);\n                    }\n                }\n            }\n            return node;\n        },\n\n        _move_node: function (node, beforeid, parentid, direction) {\n            if (!!node && !!parentid) {\n                var parent_node = this.get_node(parentid)\n                if (jm.node.inherited(node, parent_node)) {\n                    logger.error('can not move a node to its children');\n                    return null;\n                }\n                if (node.parent.id != parentid) {\n                    // remove from parent's children\n                    var sibling = node.parent.children;\n                    var si = sibling.length;\n                    while (si--) {\n                        if (sibling[si].id == node.id) {\n                            sibling.splice(si, 1);\n                            break;\n                        }\n                    }\n                    node.parent = parent_node;\n                    parent_node.children.push(node);\n                }\n\n                if (node.parent.isroot) {\n                    if (direction == jm.direction.left) {\n                        node.direction = direction;\n                    } else {\n                        node.direction = jm.direction.right;\n                    }\n                } else {\n                    node.direction = node.parent.direction;\n                }\n                this._move_node_internal(node, beforeid);\n                this._flow_node_direction(node);\n            }\n            return node;\n        },\n\n        remove_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                logger.error('the parameter node ' + node + ' is not a node.');\n                return false;\n            }\n            if (node.isroot) {\n                logger.error('fail, can not remove root node');\n                return false;\n            }\n            if (this.selected != null && this.selected.id == node.id) {\n                this.selected = null;\n            }\n            // clean all subordinate nodes\n            var children = node.children;\n            var ci = children.length;\n            while (ci--) {\n                this.remove_node(children[ci]);\n            }\n            // clean all children\n            children.length = 0;\n            // remove from parent's children\n            var sibling = node.parent.children;\n            var si = sibling.length;\n            while (si--) {\n                if (sibling[si].id == node.id) {\n                    sibling.splice(si, 1);\n                    break;\n                }\n            }\n            // remove from global nodes\n            delete this.nodes[node.id];\n            // clean all properties\n            for (var k in node) {\n                delete node[k];\n            }\n            // remove it's self\n            node = null;\n            //delete node;\n            return true;\n        },\n\n        _put_node: function (node) {\n            if (node.id in this.nodes) {\n                logger.warn('the nodeid \\'' + node.id + '\\' has been already exist.');\n                return false;\n            } else {\n                this.nodes[node.id] = node;\n                return true;\n            }\n        },\n\n        _reindex: function (node) {\n            if (node instanceof jm.node) {\n                node.children.sort(jm.node.compare);\n                for (var i = 0; i < node.children.length; i++) {\n                    node.children[i].index = i + 1;\n                }\n            }\n        },\n    };\n\n    jm.format = {\n        node_tree: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_tree\",\n                \"data\": { \"id\": \"root\", \"topic\": \"jsMind Example\" }\n            },\n            get_mind: function (source) {\n                var df = jm.format.node_tree;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n            get_data: function (mind) {\n                var df = jm.format.node_tree;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_tree';\n                json.data = df._buildnode(mind.root);\n                return json;\n            },\n\n            _parse: function (mind, node_root) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_root);\n                mind.set_root(node_root.id, node_root.topic, data);\n                if ('children' in node_root) {\n                    var children = node_root.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, mind.root, children[i]);\n                    }\n                }\n            },\n\n            _extract_data: function (node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'children' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _extract_subnode: function (mind, node_parent, node_json) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_json);\n                var d = null;\n                if (node_parent.isroot) {\n                    d = node_json.direction == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                var node = mind.add_node(node_parent, node_json.id, node_json.topic, data, d, node_json.expanded);\n                if (!!node_json['children']) {\n                    var children = node_json.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, node, children[i]);\n                    }\n                }\n            },\n\n            _buildnode: function (node) {\n                var df = jm.format.node_tree;\n                if (!(node instanceof jm.node)) { return; }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                var children = node.children;\n                if (children.length > 0) {\n                    o.children = [];\n                    for (var i = 0; i < children.length; i++) {\n                        o.children.push(df._buildnode(children[i]));\n                    }\n                }\n                return o;\n            }\n        },\n\n        node_array: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_array\",\n                \"data\": [\n                    { \"id\": \"root\", \"topic\": \"jsMind Example\", \"isroot\": true }\n                ]\n            },\n\n            get_mind: function (source) {\n                var df = jm.format.node_array;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n\n            get_data: function (mind) {\n                var df = jm.format.node_array;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_array';\n                json.data = [];\n                df._array(mind, json.data);\n                return json;\n            },\n\n            _parse: function (mind, node_array) {\n                var df = jm.format.node_array;\n                var narray = node_array.slice(0);\n                // reverse array for improving looping performance\n                narray.reverse();\n                var root_node = df._extract_root(mind, narray);\n                if (!!root_node) {\n                    df._extract_subnode(mind, root_node, narray);\n                } else {\n                    logger.error('root node can not be found');\n                }\n            },\n\n            _extract_root: function (mind, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                while (i--) {\n                    if ('isroot' in node_array[i] && node_array[i].isroot) {\n                        var root_json = node_array[i];\n                        var data = df._extract_data(root_json);\n                        var node = mind.set_root(root_json.id, root_json.topic, data);\n                        node_array.splice(i, 1);\n                        return node;\n                    }\n                }\n                return null;\n            },\n\n            _extract_subnode: function (mind, parent_node, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                var node_json = null;\n                var data = null;\n                var extract_count = 0;\n                while (i--) {\n                    node_json = node_array[i];\n                    if (node_json.parentid == parent_node.id) {\n                        data = df._extract_data(node_json);\n                        var d = null;\n                        var node_direction = node_json.direction;\n                        if (!!node_direction) {\n                            d = node_direction == 'left' ? jm.direction.left : jm.direction.right;\n                        }\n                        var node = mind.add_node(parent_node, node_json.id, node_json.topic, data, d, node_json.expanded);\n                        node_array.splice(i, 1);\n                        extract_count++;\n                        var sub_extract_count = df._extract_subnode(mind, node, node_array);\n                        if (sub_extract_count > 0) {\n                            // reset loop index after extract subordinate node\n                            i = node_array.length;\n                            extract_count += sub_extract_count;\n                        }\n                    }\n                }\n                return extract_count;\n            },\n\n            _extract_data: function (node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'parentid' || k == 'isroot' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _array: function (mind, node_array) {\n                var df = jm.format.node_array;\n                df._array_node(mind.root, node_array);\n            },\n\n            _array_node: function (node, node_array) {\n                var df = jm.format.node_array;\n                if (!(node instanceof jm.node)) { return; }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent) {\n                    o.parentid = node.parent.id;\n                }\n                if (node.isroot) {\n                    o.isroot = true;\n                }\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                node_array.push(o);\n                var ci = node.children.length;\n                for (var i = 0; i < ci; i++) {\n                    df._array_node(node.children[i], node_array);\n                }\n            },\n        },\n\n        freemind: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"freemind\",\n                \"data\": \"<map version=\\\"1.0.1\\\"><node ID=\\\"root\\\" TEXT=\\\"freemind Example\\\"/></map>\"\n            },\n            get_mind: function (source) {\n                var df = jm.format.freemind;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                var xml = source.data;\n                var xml_doc = df._parse_xml(xml);\n                var xml_root = df._find_root(xml_doc);\n                df._load_node(mind, null, xml_root);\n                return mind;\n            },\n\n            get_data: function (mind) {\n                var df = jm.format.freemind;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'freemind';\n                var xmllines = [];\n                xmllines.push('<map version=\\\"1.0.1\\\">');\n                df._buildmap(mind.root, xmllines);\n                xmllines.push('</map>');\n                json.data = xmllines.join(' ');\n                return json;\n            },\n\n            _parse_xml: function (xml) {\n                var xml_doc = null;\n                if (window.DOMParser) {\n                    var parser = new DOMParser();\n                    xml_doc = parser.parseFromString(xml, 'text/xml');\n                } else { // Internet Explorer\n                    xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n                    xml_doc.async = false;\n                    xml_doc.loadXML(xml);\n                }\n                return xml_doc;\n            },\n\n            _find_root: function (xml_doc) {\n                var nodes = xml_doc.childNodes;\n                var node = null;\n                var root = null;\n                var n = null;\n                for (var i = 0; i < nodes.length; i++) {\n                    n = nodes[i];\n                    if (n.nodeType == 1 && n.tagName == 'map') {\n                        node = n;\n                        break;\n                    }\n                }\n                if (!!node) {\n                    var ns = node.childNodes;\n                    node = null;\n                    for (var i = 0; i < ns.length; i++) {\n                        n = ns[i];\n                        if (n.nodeType == 1 && n.tagName == 'node') {\n                            node = n;\n                            break;\n                        }\n                    }\n                }\n                return node;\n            },\n\n            _load_node: function (mind, parent_node, xml_node) {\n                var df = jm.format.freemind;\n                var node_id = xml_node.getAttribute('ID');\n                var node_topic = xml_node.getAttribute('TEXT');\n                // look for richcontent\n                if (node_topic == null) {\n                    var topic_children = xml_node.childNodes;\n                    var topic_child = null;\n                    for (var i = 0; i < topic_children.length; i++) {\n                        topic_child = topic_children[i];\n                        //logger.debug(topic_child.tagName);\n                        if (topic_child.nodeType == 1 && topic_child.tagName === 'richcontent') {\n                            node_topic = topic_child.textContent;\n                            break;\n                        }\n                    }\n                }\n                var node_data = df._load_attributes(xml_node);\n                var node_expanded = ('expanded' in node_data) ? (node_data.expanded == 'true') : true;\n                delete node_data.expanded;\n\n                var node_position = xml_node.getAttribute('POSITION');\n                var node_direction = null;\n                if (!!node_position) {\n                    node_direction = node_position == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                //logger.debug(node_position +':'+ node_direction);\n                var node = null;\n                if (!!parent_node) {\n                    node = mind.add_node(parent_node, node_id, node_topic, node_data, node_direction, node_expanded);\n                } else {\n                    node = mind.set_root(node_id, node_topic, node_data);\n                }\n                var children = xml_node.childNodes;\n                var child = null;\n                for (var i = 0; i < children.length; i++) {\n                    child = children[i];\n                    if (child.nodeType == 1 && child.tagName == 'node') {\n                        df._load_node(mind, node, child);\n                    }\n                }\n            },\n\n            _load_attributes: function (xml_node) {\n                var children = xml_node.childNodes;\n                var attr = null;\n                var attr_data = {};\n                for (var i = 0; i < children.length; i++) {\n                    attr = children[i];\n                    if (attr.nodeType == 1 && attr.tagName === 'attribute') {\n                        attr_data[attr.getAttribute('NAME')] = attr.getAttribute('VALUE');\n                    }\n                }\n                return attr_data;\n            },\n\n            _buildmap: function (node, xmllines) {\n                var df = jm.format.freemind;\n                var pos = null;\n                if (!!node.parent && node.parent.isroot) {\n                    pos = node.direction === jm.direction.left ? 'left' : 'right';\n                }\n                xmllines.push('<node');\n                xmllines.push('ID=\\\"' + node.id + '\\\"');\n                if (!!pos) {\n                    xmllines.push('POSITION=\\\"' + pos + '\\\"');\n                }\n                xmllines.push('TEXT=\\\"' + node.topic + '\\\">');\n\n                // store expanded status as an attribute\n                xmllines.push('<attribute NAME=\\\"expanded\\\" VALUE=\\\"' + node.expanded + '\\\"/>');\n\n                // for attributes\n                var node_data = node.data;\n                if (node_data != null) {\n                    for (var k in node_data) {\n                        xmllines.push('<attribute NAME=\\\"' + k + '\\\" VALUE=\\\"' + node_data[k] + '\\\"/>');\n                    }\n                }\n\n                // for children\n                var children = node.children;\n                for (var i = 0; i < children.length; i++) {\n                    df._buildmap(children[i], xmllines);\n                }\n\n                xmllines.push('</node>');\n            },\n        },\n    };\n\n    // ============= utility object =============================================\n\n    jm.util = {\n        is_node: function (node) {\n            return !!node && node instanceof jm.node;\n        },\n        ajax: {\n            request: function (url, param, method, callback, fail_callback) {\n                var a = jm.util.ajax;\n                var p = null;\n                var tmp_param = [];\n                for (var k in param) {\n                    tmp_param.push(encodeURIComponent(k) + '=' + encodeURIComponent(param[k]));\n                }\n                if (tmp_param.length > 0) {\n                    p = tmp_param.join('&');\n                }\n                var xhr = new XMLHttpRequest();\n                if (!xhr) { return; }\n                xhr.onreadystatechange = function () {\n                    if (xhr.readyState == 4) {\n                        if (xhr.status == 200 || xhr.status == 0) {\n                            if (typeof callback === 'function') {\n                                var data = jm.util.json.string2json(xhr.responseText);\n                                if (data != null) {\n                                    callback(data);\n                                } else {\n                                    callback(xhr.responseText);\n                                }\n                            }\n                        } else {\n                            if (typeof fail_callback === 'function') {\n                                fail_callback(xhr);\n                            } else {\n                                logger.error('xhr request failed.', xhr);\n                            }\n                        }\n                    }\n                }\n                method = method || 'GET';\n                xhr.open(method, url, true);\n                xhr.setRequestHeader('If-Modified-Since', '0');\n                if (method == 'POST') {\n                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8');\n                    xhr.send(p);\n                } else {\n                    xhr.send();\n                }\n            },\n            get: function (url, callback) {\n                return jm.util.ajax.request(url, {}, 'GET', callback);\n            },\n            post: function (url, param, callback) {\n                return jm.util.ajax.request(url, param, 'POST', callback);\n            }\n        },\n\n        dom: {\n            //target,eventType,handler\n            add_event: function (t, e, h) {\n                if (!!t.addEventListener) {\n                    t.addEventListener(e, h, false);\n                } else {\n                    t.attachEvent('on' + e, h);\n                }\n            }\n        },\n\n        file: {\n            read: function (file_data, fn_callback) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    if (typeof fn_callback === 'function') {\n                        fn_callback(this.result, file_data.name);\n                    }\n                };\n                reader.readAsText(file_data);\n            },\n\n            save: function (file_data, type, name) {\n                var blob;\n                if (typeof $w.Blob === 'function') {\n                    blob = new Blob([file_data], { type: type });\n                } else {\n                    var BlobBuilder = $w.BlobBuilder || $w.MozBlobBuilder || $w.WebKitBlobBuilder || $w.MSBlobBuilder;\n                    var bb = new BlobBuilder();\n                    bb.append(file_data);\n                    blob = bb.getBlob(type);\n                }\n                if (navigator.msSaveBlob) {\n                    navigator.msSaveBlob(blob, name);\n                } else {\n                    var URL = $w.URL || $w.webkitURL;\n                    var bloburl = URL.createObjectURL(blob);\n                    var anchor = $c('a');\n                    if ('download' in anchor) {\n                        anchor.style.visibility = 'hidden';\n                        anchor.href = bloburl;\n                        anchor.download = name;\n                        $d.body.appendChild(anchor);\n                        var evt = $d.createEvent('MouseEvents');\n                        evt.initEvent('click', true, true);\n                        anchor.dispatchEvent(evt);\n                        $d.body.removeChild(anchor);\n                    } else {\n                        location.href = bloburl;\n                    }\n                }\n            }\n        },\n\n        json: {\n            json2string: function (json) {\n                return JSON.stringify(json);\n            },\n            string2json: function (json_str) {\n                return JSON.parse(json_str);\n            },\n            merge: function (b, a) {\n                for (var o in a) {\n                    if (o in b) {\n                        if (typeof b[o] === 'object' &&\n                            Object.prototype.toString.call(b[o]).toLowerCase() == '[object object]' &&\n                            !b[o].length) {\n                            jm.util.json.merge(b[o], a[o]);\n                        } else {\n                            b[o] = a[o];\n                        }\n                    } else {\n                        b[o] = a[o];\n                    }\n                }\n                return b;\n            }\n        },\n\n        uuid: {\n            newid: function () {\n                return (new Date().getTime().toString(16) + Math.random().toString(16).substring(2)).substring(2, 18);\n            }\n        },\n\n        text: {\n            is_empty: function (s) {\n                if (!s) { return true; }\n                return s.replace(/\\s*/, '').length == 0;\n            }\n        }\n    };\n\n    jm.prototype = {\n        init: function () {\n            if (this.initialized) { return; }\n            this.initialized = true;\n\n            var opts = this.options;\n\n            var opts_layout = {\n                mode: opts.mode,\n                hspace: opts.layout.hspace,\n                vspace: opts.layout.vspace,\n                pspace: opts.layout.pspace\n            }\n            var opts_view = {\n                container: opts.container,\n                support_html: opts.support_html,\n                engine: opts.view.engine,\n                hmargin: opts.view.hmargin,\n                vmargin: opts.view.vmargin,\n                line_width: opts.view.line_width,\n                line_color: opts.view.line_color,\n                draggable: opts.view.draggable,\n                hide_scrollbars_when_draggable: opts.view.hide_scrollbars_when_draggable,\n                node_overflow: opts.view.node_overflow\n            };\n            // create instance of function provider\n            this.data = new jm.data_provider(this);\n            this.layout = new jm.layout_provider(this, opts_layout);\n            this.view = new jm.view_provider(this, opts_view);\n            this.shortcut = new jm.shortcut_provider(this, opts.shortcut);\n\n            this.data.init();\n            this.layout.init();\n            this.view.init();\n            this.shortcut.init();\n\n            this._event_bind();\n\n            jm.init_plugins(this);\n        },\n\n        enable_edit: function () {\n            this.options.editable = true;\n        },\n\n        disable_edit: function () {\n            this.options.editable = false;\n        },\n\n        // call enable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        enable_event_handle: function (event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = true;\n        },\n\n        // call disable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        disable_event_handle: function (event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = false;\n        },\n\n        get_editable: function () {\n            return this.options.editable;\n        },\n\n        set_theme: function (theme) {\n            var theme_old = this.options.theme;\n            this.options.theme = (!!theme) ? theme : null;\n            if (theme_old != this.options.theme) {\n                this.view.reset_theme();\n                this.view.reset_custom_style();\n            }\n        },\n        _event_bind: function () {\n            this.view.add_event(this, 'mousedown', this.mousedown_handle);\n            this.view.add_event(this, 'click', this.click_handle);\n            this.view.add_event(this, 'dblclick', this.dblclick_handle);\n            this.view.add_event(this, \"mousewheel\", this.mousewheel_handle)\n        },\n\n        mousedown_handle: function (e) {\n            if (!this.options.default_event_handle['enable_mousedown_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var nodeid = this.view.get_binded_nodeid(element);\n            if (!!nodeid) {\n                if (element.tagName.toLowerCase() == 'jmnode') {\n                    this.select_node(nodeid);\n                }\n            } else {\n                this.select_clear();\n            }\n        },\n\n        click_handle: function (e) {\n            if (!this.options.default_event_handle['enable_click_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var isexpander = this.view.is_expander(element);\n            if (isexpander) {\n                var nodeid = this.view.get_binded_nodeid(element);\n                if (!!nodeid) {\n                    this.toggle_node(nodeid);\n                }\n            }\n        },\n\n        dblclick_handle: function (e) {\n            if (!this.options.default_event_handle['enable_dblclick_handle']) {\n                return;\n            }\n            if (this.get_editable()) {\n                var element = e.target || event.srcElement;\n                var nodeid = this.view.get_binded_nodeid(element);\n                if (!!nodeid) {\n                    this.begin_edit(nodeid);\n                }\n            }\n        },\n\n        // Use [Ctrl] + Mousewheel, to zoom in/out.\n        mousewheel_handle: function (event) {\n            // Test if mousewheel option is enabled and Ctrl key is pressed.\n            if (!this.options.default_event_handle[\"enable_mousewheel_handle\"] || !window.event.ctrlKey) {\n                return\n            }\n            // Avoid default page scrolling behavior.\n            event.preventDefault()\n\n            if (event.deltaY < 0) {\n                this.view.zoomIn()\n            } else {\n                this.view.zoomOut()\n            }\n        },\n\n        begin_edit: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.begin_edit(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                this.view.edit_node_begin(node);\n            } else {\n                logger.error('fail, this mind map is not editable.');\n                return;\n            }\n        },\n\n        end_edit: function () {\n            this.view.edit_node_end();\n        },\n\n        toggle_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.toggle_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.toggle_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.expand_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.expand_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        collapse_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.collapse_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.collapse_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_all: function () {\n            this.layout.expand_all();\n            this.view.relayout();\n        },\n\n        collapse_all: function () {\n            this.layout.collapse_all();\n            this.view.relayout();\n        },\n\n        expand_to_depth: function (depth) {\n            this.layout.expand_to_depth(depth);\n            this.view.relayout();\n        },\n\n        _reset: function () {\n            this.view.reset();\n            this.layout.reset();\n            this.data.reset();\n        },\n\n        _show: function (mind) {\n            var m = mind || jm.format.node_array.example;\n\n            this.mind = this.data.load(m);\n            if (!this.mind) {\n                logger.error('data.load error');\n                return;\n            } else {\n                logger.debug('data.load ok');\n            }\n\n            this.view.load();\n            logger.debug('view.load ok');\n\n            this.layout.layout();\n            logger.debug('layout.layout ok');\n\n            this.view.show(true);\n            logger.debug('view.show ok');\n\n            this.invoke_event_handle(jm.event_type.show, { data: [mind] });\n        },\n\n        show: function (mind) {\n            this._reset();\n            this._show(mind);\n        },\n\n        get_meta: function () {\n            return {\n                name: this.mind.name,\n                author: this.mind.author,\n                version: this.mind.version\n            };\n        },\n\n        get_data: function (data_format) {\n            var df = data_format || 'node_tree';\n            return this.data.get_data(df);\n        },\n\n        get_root: function () {\n            return this.mind.root;\n        },\n\n        get_node: function (node) {\n            if (jm.util.is_node(node)) {\n                return node;\n            }\n            return this.mind.get_node(node);\n        },\n\n        add_node: function (parent_node, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_parent_node = this.get_node(parent_node);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_parent_node);\n                }\n                var node = this.mind.add_node(the_parent_node, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.view.reset_node_custom_style(node);\n                    this.expand_node(the_parent_node);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'add_node', data: [the_parent_node.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_before: function (node_before, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_node_before = this.get_node(node_before);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_node_before.parent);\n                }\n                var node = this.mind.insert_node_before(the_node_before, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_before', data: [the_node_before.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_after: function (node_after, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_node_after = this.get_node(node_after);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_node_after.parent);\n                }\n                var node = this.mind.insert_node_after(the_node_after, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_after', data: [the_node_after.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        remove_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.remove_node(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                if (node.isroot) {\n                    logger.error('fail, can not remove root node');\n                    return false;\n                }\n                var nodeid = node.id;\n                var parentid = node.parent.id;\n                var parent_node = this.get_node(parentid);\n                this.view.save_location(parent_node);\n                this.view.remove_node(node);\n                this.mind.remove_node(node);\n                this.layout.layout();\n                this.view.show(false);\n                this.view.restore_location(parent_node);\n                this.invoke_event_handle(jm.event_type.edit, { evt: 'remove_node', data: [nodeid], node: parentid });\n                return true;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return false;\n            }\n        },\n\n        update_node: function (nodeid, topic) {\n            if (this.get_editable()) {\n                if (jm.util.text.is_empty(topic)) {\n                    logger.warn('fail, topic can not be empty');\n                    return;\n                }\n                var node = this.get_node(nodeid);\n                if (!!node) {\n                    if (node.topic === topic) {\n                        logger.info('nothing changed');\n                        this.view.update_node(node);\n                        return;\n                    }\n                    node.topic = topic;\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'update_node', data: [nodeid, topic], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        move_node: function (nodeid, beforeid, parentid, direction) {\n            if (this.get_editable()) {\n                var node = this.get_node(nodeid);\n                var updated_node = this.mind.move_node(node, beforeid, parentid, direction);\n                if (!!updated_node) {\n                    this.view.update_node(updated_node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'move_node', data: [nodeid, beforeid, parentid, direction], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        select_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.select_node(the_node);\n                }\n            }\n            if (!this.layout.is_visible(node)) {\n                return;\n            }\n            this.mind.selected = node;\n            this.view.select_node(node);\n            this.invoke_event_handle(jm.event_type.select, { evt: 'select_node', data: [], node: node.id });\n        },\n\n        get_selected_node: function () {\n            if (!!this.mind) {\n                return this.mind.selected;\n            } else {\n                return null;\n            }\n        },\n\n        select_clear: function () {\n            if (!!this.mind) {\n                this.mind.selected = null;\n                this.view.select_clear();\n            }\n        },\n\n        is_node_visible: function (node) {\n            return this.layout.is_visible(node);\n        },\n\n        find_node_before: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_before(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var prev = null;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (node.id === ni.id) {\n                            n = prev;\n                        }\n                        prev = ni;\n                    }\n                }\n            } else {\n                n = this.mind.get_node_before(node);\n            }\n            return n;\n        },\n\n        find_node_after: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_after(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var getthis = false;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (getthis) {\n                            n = ni;\n                            break;\n                        }\n                        if (node.id === ni.id) {\n                            getthis = true;\n                        }\n                    }\n                }\n            } else {\n                n = this.mind.get_node_after(node);\n            }\n            return n;\n        },\n\n        set_node_color: function (nodeid, bgcolor, fgcolor) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!bgcolor) {\n                        node.data['background-color'] = bgcolor;\n                    }\n                    if (!!fgcolor) {\n                        node.data['foreground-color'] = fgcolor;\n                    }\n                    this.view.reset_node_custom_style(node);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_font_style: function (nodeid, size, weight, style) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!size) {\n                        node.data['font-size'] = size;\n                    }\n                    if (!!weight) {\n                        node.data['font-weight'] = weight;\n                    }\n                    if (!!style) {\n                        node.data['font-style'] = style;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_image: function (nodeid, image, width, height, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!image) {\n                        node.data['background-image'] = image;\n                    }\n                    if (!!width) {\n                        node.data['width'] = width;\n                    }\n                    if (!!height) {\n                        node.data['height'] = height;\n                    }\n                    if (!!rotation) {\n                        node.data['background-rotation'] = rotation;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_rotation: function (nodeid, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!node.data['background-image']) {\n                        logger.error('fail, only can change rotation angle of node with background image');\n                        return null;\n                    }\n                    node.data['background-rotation'] = rotation;\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        resize: function () {\n            this.view.resize();\n        },\n\n        // callback(type ,data)\n        add_event_listener: function (callback) {\n            if (typeof callback === 'function') {\n                this.event_handles.push(callback);\n            }\n        },\n\n        clear_event_listener: function () {\n            this.event_handles = [];\n        },\n\n        invoke_event_handle: function (type, data) {\n            var j = this;\n            $w.setTimeout(function () {\n                j._invoke_event_handle(type, data);\n            }, 0);\n        },\n\n        _invoke_event_handle: function (type, data) {\n            var l = this.event_handles.length;\n            for (var i = 0; i < l; i++) {\n                this.event_handles[i](type, data);\n            }\n        },\n\n    };\n\n    // ============= data provider =============================================\n\n    jm.data_provider = function (jm) {\n        this.jm = jm;\n    };\n\n    jm.data_provider.prototype = {\n        init: function () {\n            logger.debug('data.init');\n        },\n\n        reset: function () {\n            logger.debug('data.reset');\n        },\n\n        load: function (mind_data) {\n            var df = null;\n            var mind = null;\n            if (typeof mind_data === 'object') {\n                if (!!mind_data.format) {\n                    df = mind_data.format;\n                } else {\n                    df = 'node_tree';\n                }\n            } else {\n                df = 'freemind';\n            }\n\n            if (df == 'node_array') {\n                mind = jm.format.node_array.get_mind(mind_data);\n            } else if (df == 'node_tree') {\n                mind = jm.format.node_tree.get_mind(mind_data);\n            } else if (df == 'freemind') {\n                mind = jm.format.freemind.get_mind(mind_data);\n            } else {\n                logger.warn('unsupported format');\n            }\n            return mind;\n        },\n\n        get_data: function (data_format) {\n            var data = null;\n            if (data_format == 'node_array') {\n                data = jm.format.node_array.get_data(this.jm.mind);\n            } else if (data_format == 'node_tree') {\n                data = jm.format.node_tree.get_data(this.jm.mind);\n            } else if (data_format == 'freemind') {\n                data = jm.format.freemind.get_data(this.jm.mind);\n            } else {\n                logger.error('unsupported ' + data_format + ' format');\n            }\n            return data;\n        },\n    };\n\n    // ============= layout provider ===========================================\n\n    jm.layout_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.isside = (this.opts.mode == 'side');\n        this.bounds = null;\n\n        this.cache_valid = false;\n    };\n\n    jm.layout_provider.prototype = {\n        init: function () {\n            logger.debug('layout.init');\n        },\n\n        reset: function () {\n            logger.debug('layout.reset');\n            this.bounds = { n: 0, s: 0, w: 0, e: 0 };\n        },\n\n        calculate_next_child_direction: function (node) {\n            if (this.isside) {\n                return jm.direction.right;\n            }\n            var children = node.children || [];\n            var children_len = children.length;\n            var r = 0;\n            for (var i = 0; i < children_len; i++) { if (children[i].direction === jm.direction.left) { r--; } else { r++; } }\n            return (children_len > 1 && r > 0) ? jm.direction.left : jm.direction.right;\n        },\n\n        layout: function () {\n            logger.debug('layout.layout');\n            this.layout_direction();\n            this.layout_offset();\n        },\n\n        layout_direction: function () {\n            this._layout_direction_root();\n        },\n\n        _layout_direction_root: function () {\n            var node = this.jm.mind.root;\n            // logger.debug(node);\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n            layout_data.direction = jm.direction.center;\n            layout_data.side_index = 0;\n            if (this.isside) {\n                var i = children_count;\n                while (i--) {\n                    this._layout_direction_side(children[i], jm.direction.right, i);\n                }\n            } else {\n                var i = children_count;\n                var subnode = null;\n                while (i--) {\n                    subnode = children[i];\n                    if (subnode.direction == jm.direction.left) {\n                        this._layout_direction_side(subnode, jm.direction.left, i);\n                    } else {\n                        this._layout_direction_side(subnode, jm.direction.right, i);\n                    }\n                }\n                /*\n                var boundary = Math.ceil(children_count/2);\n                var i = children_count;\n                while(i--){\n                    if(i>=boundary){\n                        this._layout_direction_side(children[i],jm.direction.left, children_count-i-1);\n                    }else{\n                        this._layout_direction_side(children[i],jm.direction.right, i);\n                    }\n                }*/\n\n            }\n        },\n\n        _layout_direction_side: function (node, direction, side_index) {\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n\n            layout_data.direction = direction;\n            layout_data.side_index = side_index;\n            var i = children_count;\n            while (i--) {\n                this._layout_direction_side(children[i], direction, i);\n            }\n        },\n\n        layout_offset: function () {\n            var node = this.jm.mind.root;\n            var layout_data = node._data.layout;\n            layout_data.offset_x = 0;\n            layout_data.offset_y = 0;\n            layout_data.outer_height = 0;\n            var children = node.children;\n            var i = children.length;\n            var left_nodes = [];\n            var right_nodes = [];\n            var subnode = null;\n            while (i--) {\n                subnode = children[i];\n                if (subnode._data.layout.direction == jm.direction.right) {\n                    right_nodes.unshift(subnode);\n                } else {\n                    left_nodes.unshift(subnode);\n                }\n            }\n            layout_data.left_nodes = left_nodes;\n            layout_data.right_nodes = right_nodes;\n            layout_data.outer_height_left = this._layout_offset_subnodes(left_nodes);\n            layout_data.outer_height_right = this._layout_offset_subnodes(right_nodes);\n            this.bounds.e = node._data.view.width / 2;\n            this.bounds.w = 0 - this.bounds.e;\n            //logger.debug(this.bounds.w);\n            this.bounds.n = 0;\n            this.bounds.s = Math.max(layout_data.outer_height_left, layout_data.outer_height_right);\n        },\n\n        // layout both the x and y axis\n        _layout_offset_subnodes: function (nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                    this.set_visible(node.children, false);\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                layout_data.offset_x = this.opts.hspace * layout_data.direction + pd.view.width * (pd.layout.direction + layout_data.direction) / 2;\n                if (!node.parent.isroot) {\n                    layout_data.offset_x += this.opts.pspace * layout_data.direction;\n                }\n\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n            }\n            return total_height;\n        },\n\n        // layout the y axis only, for collapse/expand a node\n        _layout_offset_subnodes_height: function (nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes_height(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n                //logger.debug(node.topic);\n                //logger.debug(node._data.layout.offset_y);\n            }\n            return total_height;\n        },\n\n        get_node_offset: function (node) {\n            var layout_data = node._data.layout;\n            var offset_cache = null;\n            if (('_offset_' in layout_data) && this.cache_valid) {\n                offset_cache = layout_data._offset_;\n            } else {\n                offset_cache = { x: -1, y: -1 };\n                layout_data._offset_ = offset_cache;\n            }\n            if (offset_cache.x == -1 || offset_cache.y == -1) {\n                var x = layout_data.offset_x;\n                var y = layout_data.offset_y;\n                if (!node.isroot) {\n                    var offset_p = this.get_node_offset(node.parent);\n                    x += offset_p.x;\n                    y += offset_p.y;\n                }\n                offset_cache.x = x;\n                offset_cache.y = y;\n            }\n            return offset_cache;\n        },\n\n        get_node_point: function (node) {\n            var view_data = node._data.view;\n            var offset_p = this.get_node_offset(node);\n            //logger.debug(offset_p);\n            var p = {};\n            p.x = offset_p.x + view_data.width * (node._data.layout.direction - 1) / 2;\n            p.y = offset_p.y - view_data.height / 2;\n            //logger.debug(p);\n            return p;\n        },\n\n        get_node_point_in: function (node) {\n            var p = this.get_node_offset(node);\n            return p;\n        },\n\n        get_node_point_out: function (node) {\n            var layout_data = node._data.layout;\n            var pout_cache = null;\n            if (('_pout_' in layout_data) && this.cache_valid) {\n                pout_cache = layout_data._pout_;\n            } else {\n                pout_cache = { x: -1, y: -1 };\n                layout_data._pout_ = pout_cache;\n            }\n            if (pout_cache.x == -1 || pout_cache.y == -1) {\n                if (node.isroot) {\n                    pout_cache.x = 0;\n                    pout_cache.y = 0;\n                } else {\n                    var view_data = node._data.view;\n                    var offset_p = this.get_node_offset(node);\n                    pout_cache.x = offset_p.x + (view_data.width + this.opts.pspace) * node._data.layout.direction;\n                    pout_cache.y = offset_p.y;\n                    //logger.debug('pout');\n                    //logger.debug(pout_cache);\n                }\n            }\n            return pout_cache;\n        },\n\n        get_expander_point: function (node) {\n            var p = this.get_node_point_out(node);\n            var ex_p = {};\n            if (node._data.layout.direction == jm.direction.right) {\n                ex_p.x = p.x - this.opts.pspace;\n            } else {\n                ex_p.x = p.x;\n            }\n            ex_p.y = p.y - Math.ceil(this.opts.pspace / 2);\n            return ex_p;\n        },\n\n        get_min_size: function () {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pout = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                pout = this.get_node_point_out(node);\n                if (pout.x > this.bounds.e) { this.bounds.e = pout.x; }\n                if (pout.x < this.bounds.w) { this.bounds.w = pout.x; }\n            }\n            return {\n                w: this.bounds.e - this.bounds.w,\n                h: this.bounds.s - this.bounds.n\n            }\n        },\n\n        toggle_node: function (node) {\n            if (node.isroot) {\n                return;\n            }\n            if (node.expanded) {\n                this.collapse_node(node);\n            } else {\n                this.expand_node(node);\n            }\n        },\n\n        expand_node: function (node) {\n            node.expanded = true;\n            this.part_layout(node);\n            this.set_visible(node.children, true);\n            this.jm.invoke_event_handle(jm.event_type.show, { evt: 'expand_node', data: [], node: node.id });\n        },\n\n        collapse_node: function (node) {\n            node.expanded = false;\n            this.part_layout(node);\n            this.set_visible(node.children, false);\n            this.jm.invoke_event_handle(jm.event_type.show, { evt: 'collapse_node', data: [], node: node.id });\n        },\n\n        expand_all: function () {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!node.expanded) {\n                    node.expanded = true;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        collapse_all: function () {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (node.expanded && !node.isroot) {\n                    node.expanded = false;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        expand_to_depth: function (target_depth, curr_nodes, curr_depth) {\n            if (target_depth < 1) { return; }\n            var nodes = curr_nodes || this.jm.mind.root.children;\n            var depth = curr_depth || 1;\n            var i = nodes.length;\n            var node = null;\n            while (i--) {\n                node = nodes[i];\n                if (depth < target_depth) {\n                    if (!node.expanded) {\n                        this.expand_node(node);\n                    }\n                    this.expand_to_depth(target_depth, node.children, depth + 1);\n                }\n                if (depth == target_depth) {\n                    if (node.expanded) {\n                        this.collapse_node(node);\n                    }\n                }\n            }\n        },\n\n        part_layout: function (node) {\n            var root = this.jm.mind.root;\n            if (!!root) {\n                var root_layout_data = root._data.layout;\n                if (node.isroot) {\n                    root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                } else {\n                    if (node._data.layout.direction == jm.direction.right) {\n                        root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    } else {\n                        root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                    }\n                }\n                this.bounds.s = Math.max(root_layout_data.outer_height_left, root_layout_data.outer_height_right);\n                this.cache_valid = false;\n            } else {\n                logger.warn('can not found root node');\n            }\n        },\n\n        set_visible: function (nodes, visible) {\n            var i = nodes.length;\n            var node = null;\n            var layout_data = null;\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (node.expanded) {\n                    this.set_visible(node.children, visible);\n                } else {\n                    this.set_visible(node.children, false);\n                }\n                if (!node.isroot) {\n                    node._data.layout.visible = visible;\n                }\n            }\n        },\n\n        is_expand: function (node) {\n            return node.expanded;\n        },\n\n        is_visible: function (node) {\n            var layout_data = node._data.layout;\n            if (('visible' in layout_data) && !layout_data.visible) {\n                return false;\n            } else {\n                return true;\n            }\n        }\n    };\n\n    jm.graph_canvas = function (view) {\n        this.opts = view.opts;\n        this.e_canvas = $c('canvas');\n        this.e_canvas.className = 'jsmind';\n        this.canvas_ctx = this.e_canvas.getContext('2d');\n        this.size = { w: 0, h: 0 };\n    };\n\n    jm.graph_canvas.prototype = {\n        element: function () {\n            return this.e_canvas;\n        },\n\n        set_size: function (w, h) {\n            this.size.w = w;\n            this.size.h = h;\n            this.e_canvas.width = w;\n            this.e_canvas.height = h;\n        },\n\n        clear: function () {\n            this.canvas_ctx.clearRect(0, 0, this.size.w, this.size.h);\n        },\n\n        draw_line: function (pout, pin, offset) {\n            var ctx = this.canvas_ctx;\n            ctx.strokeStyle = this.opts.line_color;\n            ctx.lineWidth = this.opts.line_width;\n            ctx.lineCap = 'round';\n\n            this._bezier_to(ctx,\n                pin.x + offset.x,\n                pin.y + offset.y,\n                pout.x + offset.x,\n                pout.y + offset.y);\n        },\n\n        copy_to: function (dest_canvas_ctx, callback) {\n            dest_canvas_ctx.drawImage(this.e_canvas, 0, 0);\n            !!callback && callback();\n        },\n\n        _bezier_to: function (ctx, x1, y1, x2, y2) {\n            ctx.beginPath();\n            ctx.moveTo(x1, y1);\n            ctx.bezierCurveTo(x1 + (x2 - x1) * 2 / 3, y1, x1, y2, x2, y2);\n            ctx.stroke();\n        },\n\n        _line_to: function (ctx, x1, y1, x2, y2) {\n            ctx.beginPath();\n            ctx.moveTo(x1, y1);\n            ctx.lineTo(x2, y2);\n            ctx.stroke();\n        }\n    };\n\n    jm.graph_svg = function (view) {\n        this.view = view;\n        this.opts = view.opts;\n        this.e_svg = jm.graph_svg.c('svg');\n        this.e_svg.setAttribute('class', 'jsmind');\n        this.size = { w: 0, h: 0 };\n        this.lines = [];\n    };\n\n    jm.graph_svg.c = function (tag) {\n        return $d.createElementNS('http://www.w3.org/2000/svg', tag);\n    };\n\n    jm.graph_svg.prototype = {\n        element: function () {\n            return this.e_svg;\n        },\n\n        set_size: function (w, h) {\n            this.size.w = w;\n            this.size.h = h;\n            this.e_svg.setAttribute('width', w);\n            this.e_svg.setAttribute('height', h);\n        },\n\n        clear: function () {\n            var len = this.lines.length;\n            while (len--) {\n                this.e_svg.removeChild(this.lines[len]);\n            }\n            this.lines.length = 0;\n        },\n\n        draw_line: function (pout, pin, offset) {\n            var line = jm.graph_svg.c('path');\n            line.setAttribute('stroke', this.opts.line_color);\n            line.setAttribute('stroke-width', this.opts.line_width);\n            line.setAttribute('fill', 'transparent');\n            this.lines.push(line);\n            this.e_svg.appendChild(line);\n            this._bezier_to(line, pin.x + offset.x, pin.y + offset.y, pout.x + offset.x, pout.y + offset.y);\n        },\n\n        copy_to: function (dest_canvas_ctx, callback) {\n            var img = new Image();\n            img.onload = function () {\n                dest_canvas_ctx.drawImage(img, 0, 0);\n                !!callback && callback();\n            }\n            img.src = 'data:image/svg+xml;base64,' + btoa(new XMLSerializer().serializeToString(this.e_svg));\n        },\n\n        _bezier_to: function (path, x1, y1, x2, y2) {\n            path.setAttribute('d', 'M' + x1 + ' ' + y1 + ' C ' + (x1 + (x2 - x1) * 2 / 3) + ' ' + y1 + ', ' + x1 + ' ' + y2 + ', ' + x2 + ' ' + y2);\n        },\n\n        _line_to: function (path, x1, y1, x2, y2) {\n            path.setAttribute('d', 'M ' + x1 + ' ' + y1 + ' L ' + x2 + ' ' + y2);\n        }\n    };\n\n    // view provider\n    jm.view_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.layout = jm.layout;\n\n        this.container = null;\n        this.e_panel = null;\n        this.e_nodes = null;\n\n        this.size = { w: 0, h: 0 };\n\n        this.selected_node = null;\n        this.editing_node = null;\n\n        this.graph = null;\n    };\n\n    jm.view_provider.prototype = {\n        init: function () {\n            logger.debug('view.init');\n\n            this.container = $i(this.opts.container) ? this.opts.container : $g(this.opts.container);\n            if (!this.container) {\n                logger.error('the options.view.container was not be found in dom');\n                return;\n            }\n            this.e_panel = $c('div');\n            this.e_nodes = $c('jmnodes');\n            this.e_editor = $c('input');\n\n            this.graph = this.opts.engine.toLowerCase() === 'svg' ? new jm.graph_svg(this) : new jm.graph_canvas(this);\n            this.e_panel.className = 'jsmind-inner jmnode-overflow-' + this.opts.node_overflow;\n            this.e_panel.tabIndex = 1;\n            this.e_panel.appendChild(this.graph.element());\n            this.e_panel.appendChild(this.e_nodes);\n\n            this.e_editor.className = 'jsmind-editor';\n            this.e_editor.type = 'text';\n\n            this.actualZoom = 1;\n            this.zoomStep = 0.1;\n            this.minZoom = 0.5;\n            this.maxZoom = 2;\n\n            var v = this;\n            jm.util.dom.add_event(this.e_editor, 'keydown', function (e) {\n                var evt = e || event;\n                if (evt.keyCode == 13) { v.edit_node_end(); evt.stopPropagation(); }\n            });\n            jm.util.dom.add_event(this.e_editor, 'blur', function (e) {\n                v.edit_node_end();\n            });\n\n            this.container.appendChild(this.e_panel);\n\n            // Used to avoid dragging, while editing node.\n            this.dragging_enabled = true\n\n            this.draggable_canvas()\n        },\n\n        add_event: function (obj, event_name, event_handle) {\n            jm.util.dom.add_event(this.e_nodes, event_name, function (e) {\n                var evt = e || event;\n                event_handle.call(obj, evt);\n            });\n        },\n\n        get_binded_nodeid: function (element) {\n            if (element == null) {\n                return null;\n            }\n            var tagName = element.tagName.toLowerCase();\n            if (tagName == 'jmnodes' || tagName == 'body' || tagName == 'html') {\n                return null;\n            }\n            if (tagName == 'jmnode' || tagName == 'jmexpander') {\n                return element.getAttribute('nodeid');\n            } else {\n                return this.get_binded_nodeid(element.parentElement);\n            }\n        },\n\n        is_expander: function (element) {\n            return (element.tagName.toLowerCase() == 'jmexpander');\n        },\n\n        reset: function () {\n            logger.debug('view.reset');\n            this.selected_node = null;\n            this.clear_lines();\n            this.clear_nodes();\n            this.reset_theme();\n        },\n\n        reset_theme: function () {\n            var theme_name = this.jm.options.theme;\n            if (!!theme_name) {\n                this.e_nodes.className = 'theme-' + theme_name;\n            } else {\n                this.e_nodes.className = '';\n            }\n        },\n\n        reset_custom_style: function () {\n            var nodes = this.jm.mind.nodes;\n            for (var nodeid in nodes) {\n                this.reset_node_custom_style(nodes[nodeid]);\n            }\n        },\n\n        load: function () {\n            logger.debug('view.load');\n            this.init_nodes();\n        },\n\n        expand_size: function () {\n            var min_size = this.layout.get_min_size();\n            var min_width = min_size.w + this.opts.hmargin * 2;\n            var min_height = min_size.h + this.opts.vmargin * 2;\n            var client_w = this.e_panel.clientWidth;\n            var client_h = this.e_panel.clientHeight;\n            if (client_w < min_width) { client_w = min_width; }\n            if (client_h < min_height) { client_h = min_height; }\n            this.size.w = client_w;\n            this.size.h = client_h;\n        },\n\n        init_nodes_size: function (node) {\n            var view_data = node._data.view;\n            view_data.width = view_data.element.clientWidth;\n            view_data.height = view_data.element.clientHeight;\n        },\n\n        init_nodes: function () {\n            var nodes = this.jm.mind.nodes;\n            var doc_frag = $d.createDocumentFragment();\n            for (var nodeid in nodes) {\n                this.create_node_element(nodes[nodeid], doc_frag);\n            }\n            this.e_nodes.appendChild(doc_frag);\n            for (var nodeid in nodes) {\n                this.init_nodes_size(nodes[nodeid]);\n            }\n        },\n\n        add_node: function (node) {\n            this.create_node_element(node, this.e_nodes);\n            this.init_nodes_size(node);\n        },\n\n        create_node_element: function (node, parent_node) {\n            var view_data = null;\n            if ('view' in node._data) {\n                view_data = node._data.view;\n            } else {\n                view_data = {};\n                node._data.view = view_data;\n            }\n\n            var d = $c('jmnode');\n            if (node.isroot) {\n                d.className = 'root';\n            } else {\n                var d_e = $c('jmexpander');\n                $t(d_e, '-');\n                d_e.setAttribute('nodeid', node.id);\n                d_e.style.visibility = 'hidden';\n                parent_node.appendChild(d_e);\n                view_data.expander = d_e;\n            }\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(d, node.topic);\n                } else {\n                    $t(d, node.topic);\n                }\n            }\n            d.setAttribute('nodeid', node.id);\n            d.style.visibility = 'hidden';\n            this._reset_node_custom_style(d, node.data);\n\n            parent_node.appendChild(d);\n            view_data.element = d;\n        },\n\n        remove_node: function (node) {\n            if (this.selected_node != null && this.selected_node.id == node.id) {\n                this.selected_node = null;\n            }\n            if (this.editing_node != null && this.editing_node.id == node.id) {\n                node._data.view.element.removeChild(this.e_editor);\n                this.editing_node = null;\n            }\n            var children = node.children;\n            var i = children.length;\n            while (i--) {\n                this.remove_node(children[i]);\n            }\n            if (node._data.view) {\n                var element = node._data.view.element;\n                var expander = node._data.view.expander;\n                this.e_nodes.removeChild(element);\n                this.e_nodes.removeChild(expander);\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n        },\n\n        update_node: function (node) {\n            var view_data = node._data.view;\n            var element = view_data.element;\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(element, node.topic);\n                } else {\n                    $t(element, node.topic);\n                }\n            }\n            if (this.layout.is_visible(node)) {\n                view_data.width = element.clientWidth;\n                view_data.height = element.clientHeight;\n            } else {\n                let origin_style = element.getAttribute('style');\n                element.style = 'visibility: visible; left:0; top:0;';\n                view_data.width = element.clientWidth;\n                view_data.height = element.clientHeight;\n                element.style = origin_style;\n            }\n        },\n\n        select_node: function (node) {\n            if (!!this.selected_node) {\n                this.selected_node._data.view.element.className =\n                    this.selected_node._data.view.element.className.replace(/\\s*selected\\b/i, '');\n                this.reset_node_custom_style(this.selected_node);\n            }\n            if (!!node) {\n                this.selected_node = node;\n                node._data.view.element.className += ' selected';\n                this.clear_node_custom_style(node);\n            }\n        },\n\n        select_clear: function () {\n            this.select_node(null);\n        },\n\n        get_editing_node: function () {\n            return this.editing_node;\n        },\n\n        is_editing: function () {\n            return (!!this.editing_node);\n        },\n\n        edit_node_begin: function (node) {\n            if (!node.topic) {\n                logger.warn(\"don't edit image nodes\");\n                return;\n            }\n            if (this.editing_node != null) {\n                this.edit_node_end();\n            }\n            this.editing_node = node;\n            var view_data = node._data.view;\n            var element = view_data.element;\n            var topic = node.topic;\n            var ncs = getComputedStyle(element);\n            this.e_editor.value = topic;\n            this.e_editor.style.width = (element.clientWidth - parseInt(ncs.getPropertyValue('padding-left')) - parseInt(ncs.getPropertyValue('padding-right'))) + 'px';\n            element.innerHTML = '';\n            element.appendChild(this.e_editor);\n            element.style.zIndex = 5;\n            this.e_editor.focus();\n            this.e_editor.select();\n        },\n\n        edit_node_end: function () {\n            if (this.editing_node != null) {\n                var node = this.editing_node;\n                this.editing_node = null;\n                var view_data = node._data.view;\n                var element = view_data.element;\n                var topic = this.e_editor.value;\n                element.style.zIndex = 'auto';\n                element.removeChild(this.e_editor);\n                if (jm.util.text.is_empty(topic) || node.topic === topic) {\n                    if (this.opts.support_html) {\n                        $h(element, node.topic);\n                    } else {\n                        $t(element, node.topic);\n                    }\n                } else {\n                    this.jm.update_node(node.id, topic);\n                }\n            }\n            this.e_panel.focus();\n        },\n\n        get_view_offset: function () {\n            var bounds = this.layout.bounds;\n            var _x = (this.size.w - bounds.e - bounds.w) / 2;\n            var _y = this.size.h / 2;\n            return { x: _x, y: _y };\n        },\n\n        resize: function () {\n            this.graph.set_size(1, 1);\n            this.e_nodes.style.width = '1px';\n            this.e_nodes.style.height = '1px';\n\n            this.expand_size();\n            this._show();\n        },\n\n        _show: function () {\n            this.graph.set_size(this.size.w, this.size.h);\n            this.e_nodes.style.width = this.size.w + 'px';\n            this.e_nodes.style.height = this.size.h + 'px';\n            this.show_nodes();\n            this.show_lines();\n            //this.layout.cache_valid = true;\n            this.jm.invoke_event_handle(jm.event_type.resize, { data: [] });\n        },\n\n        zoomIn: function () {\n            return this.setZoom(this.actualZoom + this.zoomStep);\n        },\n\n        zoomOut: function () {\n            return this.setZoom(this.actualZoom - this.zoomStep);\n        },\n\n        setZoom: function (zoom) {\n            if ((zoom < this.minZoom) || (zoom > this.maxZoom)) {\n                return false;\n            }\n            this.actualZoom = zoom;\n            for (var i = 0; i < this.e_panel.children.length; i++) {\n                this.e_panel.children[i].style.zoom = zoom;\n            };\n            this.show(true);\n            return true;\n\n        },\n\n        _center_root: function () {\n            // center root node\n            var outer_w = this.e_panel.clientWidth;\n            var outer_h = this.e_panel.clientHeight;\n            if (this.size.w > outer_w) {\n                var _offset = this.get_view_offset();\n                this.e_panel.scrollLeft = _offset.x * this.actualZoom - outer_w / 2;\n            }\n            if (this.size.h > outer_h) {\n                this.e_panel.scrollTop = (this.size.h * this.actualZoom - outer_h) / 2;\n            }\n        },\n\n        show: function (keep_center) {\n            logger.debug('view.show');\n            this.expand_size();\n            this._show();\n            if (!!keep_center) {\n                this._center_root();\n            }\n        },\n\n        relayout: function () {\n            this.expand_size();\n            this._show();\n        },\n\n        save_location: function (node) {\n            var vd = node._data.view;\n            vd._saved_location = {\n                x: parseInt(vd.element.style.left) - this.e_panel.scrollLeft,\n                y: parseInt(vd.element.style.top) - this.e_panel.scrollTop,\n            };\n        },\n\n        restore_location: function (node) {\n            var vd = node._data.view;\n            this.e_panel.scrollLeft = parseInt(vd.element.style.left) - vd._saved_location.x;\n            this.e_panel.scrollTop = parseInt(vd.element.style.top) - vd._saved_location.y;\n        },\n\n        clear_nodes: function () {\n            var mind = this.jm.mind;\n            if (mind == null) {\n                return;\n            }\n            var nodes = mind.nodes;\n            var node = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n            this.e_nodes.innerHTML = '';\n        },\n\n        show_nodes: function () {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var node_element = null;\n            var expander = null;\n            var p = null;\n            var p_expander = null;\n            var expander_text = '-';\n            var view_data = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                view_data = node._data.view;\n                node_element = view_data.element;\n                expander = view_data.expander;\n                if (!this.layout.is_visible(node)) {\n                    node_element.style.display = 'none';\n                    expander.style.display = 'none';\n                    continue;\n                }\n                this.reset_node_custom_style(node);\n                p = this.layout.get_node_point(node);\n                view_data.abs_x = _offset.x + p.x;\n                view_data.abs_y = _offset.y + p.y;\n                node_element.style.left = (_offset.x + p.x) + 'px';\n                node_element.style.top = (_offset.y + p.y) + 'px';\n                node_element.style.display = '';\n                node_element.style.visibility = 'visible';\n                if (!node.isroot && node.children.length > 0) {\n                    expander_text = node.expanded ? '-' : '+';\n                    p_expander = this.layout.get_expander_point(node);\n                    expander.style.left = (_offset.x + p_expander.x) + 'px';\n                    expander.style.top = (_offset.y + p_expander.y) + 'px';\n                    expander.style.display = '';\n                    expander.style.visibility = 'visible';\n                    $t(expander, expander_text);\n                }\n                // hide expander while all children have been removed\n                if (!node.isroot && node.children.length == 0) {\n                    expander.style.display = 'none';\n                    expander.style.visibility = 'hidden';\n                }\n            }\n        },\n\n        reset_node_custom_style: function (node) {\n            this._reset_node_custom_style(node._data.view.element, node.data);\n        },\n\n        _reset_node_custom_style: function (node_element, node_data) {\n            if ('background-color' in node_data) {\n                node_element.style.backgroundColor = node_data['background-color'];\n            }\n            if ('foreground-color' in node_data) {\n                node_element.style.color = node_data['foreground-color'];\n            }\n            if ('width' in node_data) {\n                node_element.style.width = node_data['width'] + 'px';\n            }\n            if ('height' in node_data) {\n                node_element.style.height = node_data['height'] + 'px';\n            }\n            if ('font-size' in node_data) {\n                node_element.style.fontSize = node_data['font-size'] + 'px';\n            }\n            if ('font-weight' in node_data) {\n                node_element.style.fontWeight = node_data['font-weight'];\n            }\n            if ('font-style' in node_data) {\n                node_element.style.fontStyle = node_data['font-style'];\n            }\n            if ('background-image' in node_data) {\n                var backgroundImage = node_data['background-image'];\n                if (backgroundImage.startsWith('data') && node_data['width'] && node_data['height']) {\n                    var img = new Image();\n\n                    img.onload = function () {\n                        var c = $c('canvas');\n                        c.width = node_element.clientWidth;\n                        c.height = node_element.clientHeight;\n                        var img = this;\n                        if (c.getContext) {\n                            var ctx = c.getContext('2d');\n                            ctx.drawImage(img, 2, 2, node_element.clientWidth, node_element.clientHeight);\n                            var scaledImageData = c.toDataURL();\n                            node_element.style.backgroundImage = 'url(' + scaledImageData + ')';\n                        }\n                    };\n                    img.src = backgroundImage;\n\n                } else {\n                    node_element.style.backgroundImage = 'url(' + backgroundImage + ')';\n                }\n                node_element.style.backgroundSize = '99%';\n\n                if ('background-rotation' in node_data) {\n                    node_element.style.transform = 'rotate(' + node_data['background-rotation'] + 'deg)';\n                }\n            }\n        },\n\n        clear_node_custom_style: function (node) {\n            var node_element = node._data.view.element;\n            node_element.style.backgroundColor = \"\";\n            node_element.style.color = \"\";\n        },\n\n        clear_lines: function () {\n            this.graph.clear();\n        },\n\n        show_lines: function () {\n            this.clear_lines();\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pin = null;\n            var pout = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!!node.isroot) { continue; }\n                if (('visible' in node._data.layout) && !node._data.layout.visible) { continue; }\n                pin = this.layout.get_node_point_in(node);\n                pout = this.layout.get_node_point_out(node.parent);\n                this.graph.draw_line(pout, pin, _offset);\n            }\n        },\n\n        // Drag the whole mind map with your mouse (usefull when it's larger that the container).\n        draggable_canvas: function () {\n            // If draggable option is true.\n            if (this.opts.draggable) {\n                // Dragging disabled by default.\n                let dragging = false\n                let x, y\n                if (this.opts.hide_scrollbars_when_draggable) {\n                    // Avoid scrollbars when mind map is larger than the container (e_panel = id jsmind-inner)\n                    this.e_panel.style = 'overflow: hidden'\n                }\n                // Move the whole mind map with mouse moves, while button is down.\n                jm.util.dom.add_event(this.container, 'mousedown', (eventDown) => {\n                    dragging = true\n                    // Record current mouse position.\n                    x = eventDown.clientX\n                    y = eventDown.clientY\n                })\n                // Stop moving mind map once mouse button is released.\n                jm.util.dom.add_event(this.container, 'mouseup', () => {\n                    dragging = false\n                })\n                // Follow current mouse position and move mind map accordingly.\n                jm.util.dom.add_event(this.container, 'mousemove', (eventMove) => {\n                    if (this.dragging_enabled && dragging) {\n                        this.e_panel.scrollBy(x - eventMove.clientX, y - eventMove.clientY)\n                        // Record new current position.\n                        x = eventMove.clientX\n                        y = eventMove.clientY\n                    }\n                })\n            }\n        },\n\n        get_draggable_canvas: function () {\n            return this.opts.draggable\n        },\n\n        enable_draggable_canvas: function () {\n            this.dragging_enabled = true\n        },\n\n        disable_draggable_canvas: function () {\n            this.dragging_enabled = false\n        },\n\n    };\n\n    // shortcut provider\n    jm.shortcut_provider = function (jm, options) {\n        this.jm = jm;\n        this.opts = options;\n        this.mapping = options.mapping;\n        this.handles = options.handles;\n        this._newid = null;\n        this._mapping = {};\n    };\n\n    jm.shortcut_provider.prototype = {\n        init: function () {\n            jm.util.dom.add_event(this.jm.view.e_panel, 'keydown', this.handler.bind(this));\n\n            this.handles['addchild'] = this.handle_addchild;\n            this.handles['addbrother'] = this.handle_addbrother;\n            this.handles['editnode'] = this.handle_editnode;\n            this.handles['delnode'] = this.handle_delnode;\n            this.handles['toggle'] = this.handle_toggle;\n            this.handles['up'] = this.handle_up;\n            this.handles['down'] = this.handle_down;\n            this.handles['left'] = this.handle_left;\n            this.handles['right'] = this.handle_right;\n\n            for (var handle in this.mapping) {\n                if (!!this.mapping[handle] && (handle in this.handles)) {\n                    var keys = this.mapping[handle];\n                    if(!Array.isArray(keys)){\n                        keys = [keys]\n                    }\n                    for(let key of keys){\n                        this._mapping[key] = this.handles[handle];\n                    }\n                }\n            }\n\n            if (typeof this.opts.id_generator === 'function') {\n                this._newid = this.opts.id_generator;\n            } else {\n                this._newid = jm.util.uuid.newid;\n            }\n        },\n\n        enable_shortcut: function () {\n            this.opts.enable = true;\n        },\n\n        disable_shortcut: function () {\n            this.opts.enable = false;\n        },\n\n        handler: function (e) {\n            if (e.which == 9) { e.preventDefault(); } //prevent tab to change focus in browser\n            if (this.jm.view.is_editing()) { return; }\n            var evt = e || event;\n            if (!this.opts.enable) { return true; }\n            var kc = evt.keyCode + (evt.metaKey << 13) + (evt.ctrlKey << 12) + (evt.altKey << 11) + (evt.shiftKey << 10);\n            if (kc in this._mapping) {\n                this._mapping[kc].call(this, this.jm, e);\n            }\n        },\n\n        handle_addchild: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var nodeid = this._newid();\n                var node = _jm.add_node(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_addbrother: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                var nodeid = this._newid();\n                var node = _jm.insert_node_after(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_editnode: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.begin_edit(selected_node);\n            }\n        },\n        handle_delnode: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                _jm.select_node(selected_node.parent);\n                _jm.remove_node(selected_node);\n            }\n        },\n        handle_toggle: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.toggle_node(selected_node.id);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n        handle_up: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var up_node = _jm.find_node_before(selected_node);\n                if (!up_node) {\n                    var np = _jm.find_node_before(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        up_node = np.children[np.children.length - 1];\n                    }\n                }\n                if (!!up_node) {\n                    _jm.select_node(up_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_down: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var down_node = _jm.find_node_after(selected_node);\n                if (!down_node) {\n                    var np = _jm.find_node_after(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        down_node = np.children[0];\n                    }\n                }\n                if (!!down_node) {\n                    _jm.select_node(down_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_left: function (_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.left);\n        },\n        handle_right: function (_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.right);\n        },\n        _handle_direction: function (_jm, e, d) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            var node = null;\n            if (!!selected_node) {\n                if (selected_node.isroot) {\n                    var c = selected_node.children;\n                    var children = [];\n                    for (var i = 0; i < c.length; i++) {\n                        if (c[i].direction === d) {\n                            children.push(i);\n                        }\n                    }\n                    node = c[children[Math.floor((children.length - 1) / 2)]];\n                }\n                else if (selected_node.direction === d) {\n                    var children = selected_node.children;\n                    var childrencount = children.length;\n                    if (childrencount > 0) {\n                        node = children[Math.floor((childrencount - 1) / 2)];\n                    }\n                } else {\n                    node = selected_node.parent;\n                }\n                if (!!node) {\n                    _jm.select_node(node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n    };\n\n\n    // plugin\n    jm.plugin = function (name, init) {\n        this.name = name;\n        this.init = init;\n    };\n\n    jm.plugins = [];\n\n    jm.register_plugin = function (plugin) {\n        if (plugin instanceof jm.plugin) {\n            jm.plugins.push(plugin);\n        }\n    };\n\n    jm.init_plugins = function (sender) {\n        $w.setTimeout(function () {\n            jm._init_plugins(sender);\n        }, 0);\n    };\n\n    jm._init_plugins = function (sender) {\n        var l = jm.plugins.length;\n        var fn_init = null;\n        for (var i = 0; i < l; i++) {\n            fn_init = jm.plugins[i].init;\n            if (typeof fn_init === 'function') {\n                fn_init(sender);\n            }\n        }\n    };\n\n    // quick way\n    jm.show = function (options, mind) {\n        var _jm = new jm(options);\n        _jm.show(mind);\n        return _jm;\n    };\n\n    // export jsmind\n    if (typeof module !== 'undefined' && typeof exports === 'object') {\n        module.exports = jm;\n    } else if (typeof define === 'function' && (define.amd || define.cmd)) {\n        define(function () { return jm; });\n    } else {\n        $w[__name__] = jm;\n    }\n})(typeof window !== 'undefined' ? window : global);\n","/**\n * @license BSD\n * @copyright 2014-2023 hizzgdev@163.com\n * \n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\n(function ($w) {\n    'use strict';\n\n    var __name__ = 'jsMind';\n    var jsMind = $w[__name__];\n    if (!jsMind) { return; }\n    if (typeof jsMind.screenshot != 'undefined') { return; }\n\n    var $d = $w.document;\n    var $c = function (tag) { return $d.createElement(tag); };\n\n    var css = function (cstyle, property_name) {\n        return cstyle.getPropertyValue(property_name);\n    };\n    var is_visible = function (cstyle) {\n        var visibility = css(cstyle, 'visibility');\n        var display = css(cstyle, 'display');\n        return (visibility !== 'hidden' && display !== 'none');\n    };\n    var jcanvas = {};\n    jcanvas.rect = function (ctx, x, y, w, h, r) {\n        if (w < 2 * r) r = w / 2;\n        if (h < 2 * r) r = h / 2;\n        ctx.moveTo(x + r, y);\n        ctx.arcTo(x + w, y, x + w, y + h, r);\n        ctx.arcTo(x + w, y + h, x, y + h, r);\n        ctx.arcTo(x, y + h, x, y, r);\n        ctx.arcTo(x, y, x + w, y, r);\n    };\n\n    jcanvas.text_multiline = function (ctx, text, x, y, w, h, lineheight) {\n        var line = '';\n        var text_len = text.length;\n        var chars = text.split('');\n        var test_line = null;\n        ctx.textAlign = 'left';\n        ctx.textBaseline = 'top';\n        for (var i = 0; i < text_len; i++) {\n            test_line = line + chars[i];\n            if (ctx.measureText(test_line).width > w && i > 0) {\n                ctx.fillText(line, x, y);\n                line = chars[i];\n                y += lineheight;\n            } else {\n                line = test_line;\n            }\n        }\n        ctx.fillText(line, x, y);\n    };\n\n    jcanvas.text_ellipsis = function (ctx, text, x, y, w, h) {\n        var center_y = y + h / 2;\n        var text = jcanvas.fittingString(ctx, text, w);\n        ctx.textAlign = 'left';\n        ctx.textBaseline = 'middle';\n        ctx.fillText(text, x, center_y, w);\n    };\n\n    jcanvas.fittingString = function (ctx, text, max_width) {\n        var width = ctx.measureText(text).width;\n        var ellipsis = '';\n        var ellipsis_width = ctx.measureText(ellipsis).width;\n        if (width <= max_width || width <= ellipsis_width) {\n            return text;\n        } else {\n            var len = text.length;\n            while (width >= max_width - ellipsis_width && len-- > 0) {\n                text = text.substring(0, len);\n                width = ctx.measureText(text).width;\n            }\n            return text + ellipsis;\n        }\n    };\n\n    jcanvas.image = function (ctx, url, x, y, w, h, r, rotation, callback) {\n        var img = new Image();\n        img.onload = function () {\n            ctx.save();\n            ctx.translate(x, y);\n            ctx.save();\n            ctx.beginPath();\n            jcanvas.rect(ctx, 0, 0, w, h, r);\n            ctx.closePath();\n            ctx.clip();\n            ctx.translate(w / 2, h / 2);\n            ctx.rotate(rotation * Math.PI / 180);\n            ctx.drawImage(img, -w / 2, -h / 2);\n            ctx.restore();\n            ctx.restore();\n            !!callback && callback();\n        }\n        img.src = url;\n    };\n\n    jsMind.screenshot = function (jm) {\n        this.jm = jm;\n        this.canvas_elem = null;\n        this.canvas_ctx = null;\n        this._inited = false;\n    };\n\n    jsMind.screenshot.prototype = {\n        init: function () {\n            if (this._inited) { return; }\n            console.log('init');\n            var c = $c('canvas');\n            var ctx = c.getContext('2d');\n\n            this.canvas_elem = c;\n            this.canvas_ctx = ctx;\n            this.jm.view.e_panel.appendChild(c);\n            this._inited = true;\n            this.resize();\n        },\n\n        shoot: function (callback) {\n            this.init();\n            this._draw(function () {\n                !!callback && callback();\n                this.clean();\n            }.bind(this));\n            this._watermark();\n        },\n\n        shootDownload: function () {\n            this.shoot(function () {\n                this._download();\n            }.bind(this));\n        },\n\n        shootAsDataURL: function (callback) {\n            this.shoot(function () {\n                !!callback && callback(this.canvas_elem.toDataURL());\n            }.bind(this));\n        },\n\n        resize: function () {\n            if (this._inited) {\n                this.canvas_elem.width = this.jm.view.size.w;\n                this.canvas_elem.height = this.jm.view.size.h;\n            }\n        },\n\n        clean: function () {\n            var c = this.canvas_elem;\n            this.canvas_ctx.clearRect(0, 0, c.width, c.height);\n        },\n\n        _draw: function (callback) {\n            var ctx = this.canvas_ctx;\n            ctx.textAlign = 'left';\n            ctx.textBaseline = 'top';\n            this._draw_lines(function () {\n                this._draw_nodes(callback);\n            }.bind(this));\n        },\n\n        _watermark: function () {\n            var c = this.canvas_elem;\n            var ctx = this.canvas_ctx;\n            ctx.textAlign = 'right';\n            ctx.textBaseline = 'bottom';\n            ctx.fillStyle = '#000';\n            ctx.font = '11px Verdana,Arial,Helvetica,sans-serif';\n            ctx.fillText('github.com/hizzgdev/jsmind', c.width - 5.5, c.height - 2.5);\n            ctx.textAlign = 'left';\n            ctx.fillText($w.location, 5.5, c.height - 2.5);\n        },\n\n        _draw_lines: function (callback) {\n            this.jm.view.graph.copy_to(this.canvas_ctx, callback);\n        },\n\n        _draw_nodes: function (callback) {\n            var nodes = this.jm.mind.nodes;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                this._draw_node(node);\n            }\n\n            function check_nodes_ready() {\n                console.log('check_node_ready' + new Date());\n                var allOk = true;\n                for (var nodeid in nodes) {\n                    node = nodes[nodeid];\n                    allOk = allOk & node.ready;\n                }\n\n                if (!allOk) {\n                    $w.setTimeout(check_nodes_ready, 200);\n                } else {\n                    $w.setTimeout(callback, 200);\n                }\n            }\n            check_nodes_ready();\n        },\n\n        _draw_node: function (node) {\n            var ctx = this.canvas_ctx;\n            var view_data = node._data.view;\n            var node_element = view_data.element;\n            var ncs = getComputedStyle(node_element);\n            if (!is_visible(ncs)) {\n                node.ready = true;\n                return;\n            }\n\n            var bgcolor = css(ncs, 'background-color');\n            var round_radius = parseInt(css(ncs, 'border-top-left-radius'));\n            var color = css(ncs, 'color');\n            var padding_left = parseInt(css(ncs, 'padding-left'));\n            var padding_right = parseInt(css(ncs, 'padding-right'));\n            var padding_top = parseInt(css(ncs, 'padding-top'));\n            var padding_bottom = parseInt(css(ncs, 'padding-bottom'));\n            var text_overflow = css(ncs, 'text-overflow');\n            var font = css(ncs, 'font-style') + ' ' +\n                css(ncs, 'font-variant') + ' ' +\n                css(ncs, 'font-weight') + ' ' +\n                css(ncs, 'font-size') + '/' + css(ncs, 'line-height') + ' ' +\n                css(ncs, 'font-family');\n\n            var rb = {\n                x: view_data.abs_x,\n                y: view_data.abs_y,\n                w: view_data.width + 1,\n                h: view_data.height + 1\n            };\n            var tb = {\n                x: rb.x + padding_left,\n                y: rb.y + padding_top,\n                w: rb.w - padding_left - padding_right,\n                h: rb.h - padding_top - padding_bottom\n            };\n\n            ctx.font = font;\n            ctx.fillStyle = bgcolor;\n            ctx.beginPath();\n            jcanvas.rect(ctx, rb.x, rb.y, rb.w, rb.h, round_radius);\n            ctx.closePath();\n            ctx.fill();\n\n            ctx.fillStyle = color;\n            if ('background-image' in node.data) {\n                var backgroundUrl = css(ncs, 'background-image').slice(5, -2);\n                node.ready = false;\n                var rotation = 0;\n                if ('background-rotation' in node.data) {\n                    rotation = node.data['background-rotation'];\n                }\n                jcanvas.image(ctx, backgroundUrl, rb.x, rb.y, rb.w, rb.h, round_radius, rotation,\n                    function () {\n                        node.ready = true;\n                    });\n            }\n            if (!!node.topic) {\n                if (text_overflow === 'ellipsis') {\n                    jcanvas.text_ellipsis(ctx, node.topic, tb.x, tb.y, tb.w, tb.h);\n                } else {\n                    var line_height = parseInt(css(ncs, 'line-height'));\n                    jcanvas.text_multiline(ctx, node.topic, tb.x, tb.y, tb.w, tb.h, line_height);\n                }\n            }\n            if (!!view_data.expander) {\n                this._draw_expander(view_data.expander);\n            }\n            if (!('background-image' in node.data)) {\n                node.ready = true;\n            }\n        },\n\n        _draw_expander: function (expander) {\n            var ctx = this.canvas_ctx;\n            var ncs = getComputedStyle(expander);\n            if (!is_visible(ncs)) { return; }\n\n            var style_left = css(ncs, 'left');\n            var style_top = css(ncs, 'top');\n            var font = css(ncs, 'font');\n            var left = parseInt(style_left);\n            var top = parseInt(style_top);\n            var is_plus = expander.innerHTML === '+';\n\n            ctx.lineWidth = 1;\n\n            ctx.beginPath();\n            ctx.arc(left + 7, top + 7, 5, 0, Math.PI * 2, true);\n            ctx.moveTo(left + 10, top + 7);\n            ctx.lineTo(left + 4, top + 7);\n            if (is_plus) {\n                ctx.moveTo(left + 7, top + 4);\n                ctx.lineTo(left + 7, top + 10);\n            }\n            ctx.closePath();\n            ctx.stroke();\n        },\n\n        _download: function () {\n            var c = this.canvas_elem;\n            var name = this.jm.mind.name + '.png';\n\n            if (navigator.msSaveBlob && (!!c.msToBlob)) {\n                var blob = c.msToBlob();\n                navigator.msSaveBlob(blob, name);\n            } else {\n                var bloburl = this.canvas_elem.toDataURL();\n                var anchor = $c('a');\n                if ('download' in anchor) {\n                    anchor.style.visibility = 'hidden';\n                    anchor.href = bloburl;\n                    anchor.download = name;\n                    $d.body.appendChild(anchor);\n                    var evt = $d.createEvent('MouseEvents');\n                    evt.initEvent('click', true, true);\n                    anchor.dispatchEvent(evt);\n                    $d.body.removeChild(anchor);\n                } else {\n                    location.href = bloburl;\n                }\n            }\n        },\n\n        jm_event_handle: function (type, data) {\n            if (type === jsMind.event_type.resize) {\n                this.resize();\n            }\n        }\n    };\n\n    var screenshot_plugin = new jsMind.plugin('screenshot', function (jm) {\n        var jss = new jsMind.screenshot(jm);\n        jm.screenshot = jss;\n        jm.shoot = function () {\n            jss.shoot();\n        };\n        jm.add_event_listener(function (type, data) {\n            jss.jm_event_handle.call(jss, type, data);\n        });\n    });\n\n    jsMind.register_plugin(screenshot_plugin);\n\n})(window);\n","\nmodule.exports = function () {\n  var selection = document.getSelection();\n  if (!selection.rangeCount) {\n    return function () {};\n  }\n  var active = document.activeElement;\n\n  var ranges = [];\n  for (var i = 0; i < selection.rangeCount; i++) {\n    ranges.push(selection.getRangeAt(i));\n  }\n\n  switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML\n    case 'INPUT':\n    case 'TEXTAREA':\n      active.blur();\n      break;\n\n    default:\n      active = null;\n      break;\n  }\n\n  selection.removeAllRanges();\n  return function () {\n    selection.type === 'Caret' &&\n    selection.removeAllRanges();\n\n    if (!selection.rangeCount) {\n      ranges.forEach(function(range) {\n        selection.addRange(range);\n      });\n    }\n\n    active &&\n    active.focus();\n  };\n};\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createVNode as _createVNode, vShow as _vShow, withDirectives as _withDirectives, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { onMounted, defineAsyncComponent } from 'vue';\nimport { has_setting } from '@/views/Mind/utils';\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Home',\n  setup(__props) {\n\nconst LeftComponent = defineAsyncComponent(() => import('./Code.vue'));\nconst RightComponent = defineAsyncComponent(() => import('./Options.vue'));\nconst ToolBox = defineAsyncComponent(() => import('./component/ToolBox.vue'));\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_unref(ToolBox)),\n    _withDirectives(_createVNode(_unref(RightComponent), null, null, 512), [\n      [_vShow, _unref(has_setting)]\n    ])\n  ], 64))\n}\n}\n\n})","import script from \"./Home.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./Home.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./Home.vue?vue&type=style&index=0&id=2765e497&lang=less&scoped=true\"\n\nimport exportComponent from \"F:\\\\sla-mind\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2765e497\"]])\n\nexport default __exports__"],"names":["THEME","ThemeOption","label","value","PRIMARY","WARNING","DANGER","SUCCESS","INFO","GREENSEA","NEPHRITE","BELIZEHOLE","WISTERIA","ASPHALT","ORANGE","PUMPKIN","POMEGRANATE","CLOUDS","ASBESTOS","MODE","LOGLEVEL","LogLevelOption","DEBUG","WARN","ERROR","DISABLE","ENGINE","EngineOption","CANVAS","SVG","NODE_OVERFLOW","NodeOverflowOption","HIDDEN","WRAP","Object","defineProperty","window","jsMind","configurable","writable","meta","reactive","name","author","version","format","ref","defaultData","id","topic","children","direction","emptyData","options","container","editable","theme","mode","support_html","log_level","view","engine","hmargin","vmargin","line_width","line_color","draggable","hide_scrollbars_when_draggable","node_overflow","layout","hspace","vspace","pspace","shortcut","enable","handles","mapping","addchild","addbrother","editnode","delnode","toggle","left","up","right","down","_jm","data_type","has_init","has_setting","handleInit","bool","initContainer","destroyContainer","app","document","getElementById","HTMLElement","div","createElement","className","style","width","height","backgroundColor","appendChild","removeChild","getElementsByClassName","copyData","mind","data","copy","JSON","stringify","ElMessage","open_view","type","show","set_theme","theme_name","handle_editable","enable_edit","disable_edit","handle_support_html","set_log_level","screen_shot","screenshot","shootDownload","reload","deselectCurrent","require","clipboardToIE11Formatting","defaultMessage","message","copyKey","test","navigator","userAgent","replace","text","debug","reselectPrevious","range","selection","mark","success","createRange","getSelection","textContent","ariaHidden","all","position","top","clip","whiteSpace","webkitUserSelect","MozUserSelect","msUserSelect","userSelect","addEventListener","e","stopPropagation","preventDefault","clipboardData","console","warn","clearData","setData","onCopy","body","selectNodeContents","addRange","successful","execCommand","Error","err","error","prompt","removeRange","removeAllRanges","module","exports","$w","$d","__name__","jdom","util","dom","clear_selection","empty","lookup_delay","lookup_interval","jm","this","e_canvas","canvas_ctx","shadow","shadow_w","shadow_h","active_node","target_node","target_direct","client_w","client_h","offset_x","offset_y","hlookup_delay","hlookup_timer","capture","moved","prototype","init","_create_canvas","_create_shadow","_event_bind","resize","e_nodes","size","w","h","c","e_panel","ctx","getContext","s","visibility","zIndex","cursor","opacity","reset_shadow","el","innerHTML","backgroundImage","backgroundSize","transform","clientWidth","clientHeight","show_shadow","hide_shadow","_magnet_shadow","node","lineWidth","strokeStyle","lineCap","_clear_lines","_canvas_lineto","sp","x","y","np","clearRect","x1","y1","x2","y2","beginPath","moveTo","lineTo","stroke","_lookup_close_node","ns","nl","root","get_root","root_location","get_location","root_size","get_size","root_x","sw","sh","sx","offsetLeft","sy","offsetTop","direct","nodes","min_distance","Number","MAX_VALUE","distance","closest_node","closest_p","shadow_p","nodeid","isroot","is_visible","Math","abs","result_node","lookup_close_node","node_data","jd","add_event","evt","event","dragstart","call","drag","dragend","get_editable","jview","target","srcElement","tagName","toLowerCase","get_draggable_canvas","disable_draggable_canvas","get_binded_nodeid","get_node","clientX","touches","actualZoom","clientY","client_hw","floor","client_hh","clearTimeout","clearInterval","setTimeout","setInterval","px","py","enable_draggable_canvas","src_node","move_node","inherited","sibling_nodes","sc","length","delta_y","node_before","beforeid","dy","jm_event_handle","event_type","draggable_plugin","plugin","add_event_listener","register_plugin","__version__","__author__","_noop","logger","log","info","$g","$c","tag","$t","n","t","hasChildNodes","firstChild","nodeValue","createTextNode","$h","$i","nodeType","ownerDocument","String","startsWith","p","slice","DEFAULT_OPTIONS","default_event_handle","enable_mousedown_handle","enable_click_handle","enable_dblclick_handle","enable_mousewheel_handle","current","opts","json","merge","initialized","event_handles","center","of","dir","parseInt","edit","select","key","ctrl","alt","shift","sId","iIndex","sTopic","oData","bIsRoot","oParent","eDirection","bExpanded","index","parent","expanded","_data","compare","node1","node2","r","i1","i2","pnode","pid","is_node","vd","abs_x","abs_y","selected","set_root","_put_node","add_node","parent_node","idx","node_index","push","_reindex","insert_node_before","get_node_before","the_node","insert_node_after","node_after","get_node_after","brothers","before_id","parent_id","_move_node","_flow_node_direction","len","_move_node_internal","parentid","sibling","si","splice","remove_node","ci","k","sort","i","node_tree","example","get_mind","source","df","_parse","get_data","_buildnode","node_root","_extract_data","_extract_subnode","node_json","node_parent","d","o","node_array","_array","narray","reverse","root_node","_extract_root","root_json","extract_count","node_direction","sub_extract_count","_array_node","freemind","xml","xml_doc","_parse_xml","xml_root","_find_root","_load_node","xmllines","_buildmap","join","DOMParser","parser","parseFromString","ActiveXObject","async","loadXML","childNodes","xml_node","node_id","getAttribute","node_topic","topic_children","topic_child","_load_attributes","node_expanded","node_position","child","attr","attr_data","pos","ajax","request","url","param","method","callback","fail_callback","tmp_param","encodeURIComponent","xhr","XMLHttpRequest","onreadystatechange","readyState","status","string2json","responseText","open","setRequestHeader","send","get","post","attachEvent","file","read","file_data","fn_callback","reader","FileReader","onload","result","readAsText","save","blob","Blob","BlobBuilder","MozBlobBuilder","WebKitBlobBuilder","MSBlobBuilder","bb","append","getBlob","msSaveBlob","URL","webkitURL","bloburl","createObjectURL","anchor","href","download","createEvent","initEvent","dispatchEvent","location","json2string","json_str","parse","b","a","toString","uuid","newid","Date","getTime","random","substring","is_empty","opts_layout","opts_view","data_provider","layout_provider","view_provider","shortcut_provider","init_plugins","enable_event_handle","event_handle","disable_event_handle","theme_old","reset_theme","reset_custom_style","mousedown_handle","click_handle","dblclick_handle","mousewheel_handle","element","select_node","select_clear","isexpander","is_expander","toggle_node","begin_edit","ctrlKey","deltaY","zoomIn","zoomOut","edit_node_begin","end_edit","edit_node_end","save_location","relayout","restore_location","expand_node","collapse_node","expand_all","collapse_all","expand_to_depth","depth","_reset","reset","_show","m","load","invoke_event_handle","get_meta","data_format","the_parent_node","undefined","calculate_next_child_direction","reset_node_custom_style","the_node_before","the_node_after","update_node","updated_node","get_selected_node","is_node_visible","find_node_before","prev","ni","find_node_after","getthis","set_node_color","bgcolor","fgcolor","set_node_font_style","weight","set_node_background_image","image","rotation","set_node_background_rotation","clear_event_listener","j","_invoke_event_handle","l","mind_data","isside","bounds","cache_valid","children_len","layout_direction","layout_offset","_layout_direction_root","layout_data","children_count","side_index","_layout_direction_side","subnode","outer_height","left_nodes","right_nodes","unshift","outer_height_left","_layout_offset_subnodes","outer_height_right","max","total_height","nodes_count","node_outer_height","base_y","pd","set_visible","middle_height","_layout_offset_subnodes_height","get_node_offset","offset_cache","_offset_","offset_p","get_node_point","view_data","get_node_point_in","get_node_point_out","pout_cache","_pout_","get_expander_point","ex_p","ceil","get_min_size","pout","part_layout","target_depth","curr_nodes","curr_depth","root_layout_data","visible","is_expand","graph_canvas","set_size","clear","draw_line","pin","offset","_bezier_to","copy_to","dest_canvas_ctx","drawImage","bezierCurveTo","_line_to","graph_svg","e_svg","setAttribute","lines","createElementNS","line","img","Image","src","btoa","XMLSerializer","serializeToString","path","selected_node","editing_node","graph","e_editor","tabIndex","zoomStep","minZoom","maxZoom","v","keyCode","dragging_enabled","draggable_canvas","obj","event_name","parentElement","clear_lines","clear_nodes","init_nodes","expand_size","min_size","min_width","min_height","init_nodes_size","doc_frag","createDocumentFragment","create_node_element","d_e","expander","_reset_node_custom_style","origin_style","clear_node_custom_style","get_editing_node","is_editing","ncs","getComputedStyle","getPropertyValue","focus","get_view_offset","_x","_y","show_nodes","show_lines","setZoom","zoom","_center_root","outer_w","outer_h","_offset","scrollLeft","scrollTop","keep_center","_saved_location","node_element","p_expander","expander_text","display","color","fontSize","fontWeight","fontStyle","scaledImageData","toDataURL","dragging","eventDown","eventMove","scrollBy","_newid","_mapping","handle","handler","bind","handle_addchild","handle_addbrother","handle_editnode","handle_delnode","handle_toggle","handle_up","handle_down","handle_left","handle_right","keys","Array","isArray","id_generator","enable_shortcut","disable_shortcut","which","kc","metaKey","altKey","shiftKey","up_node","down_node","_handle_direction","childrencount","plugins","sender","_init_plugins","fn_init","global","css","cstyle","property_name","jcanvas","arcTo","lineheight","text_len","chars","split","test_line","textAlign","textBaseline","measureText","fillText","center_y","fittingString","max_width","ellipsis","ellipsis_width","translate","rect","closePath","rotate","PI","restore","canvas_elem","_inited","shoot","_draw","clean","_watermark","_download","shootAsDataURL","_draw_lines","_draw_nodes","fillStyle","font","_draw_node","check_nodes_ready","allOk","ready","round_radius","padding_left","padding_right","padding_top","padding_bottom","text_overflow","rb","tb","fill","backgroundUrl","text_ellipsis","line_height","text_multiline","_draw_expander","style_left","style_top","is_plus","arc","msToBlob","screenshot_plugin","jss","rangeCount","active","activeElement","ranges","getRangeAt","toUpperCase","blur","forEach","_defineComponent","__name","setup","__props","defineAsyncComponent","RightComponent","ToolBox","_ctx","_cache","_openBlock","_createElementBlock","_Fragment","_createVNode","_unref","_withDirectives","_vShow","__exports__"],"sourceRoot":""}